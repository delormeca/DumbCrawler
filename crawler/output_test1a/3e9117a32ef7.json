{
  "url": "https://docs.python.org/3/library/contextvars.html",
  "status_code": 200,
  "depth": 1,
  "referrer": "https://docs.python.org/3/library/",
  "raw_html": "<!DOCTYPE html>\n\n<html lang=\"en\" data-content_root=\"../\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<meta property=\"og:title\" content=\"contextvars — Context Variables\" />\n<meta property=\"og:type\" content=\"website\" />\n<meta property=\"og:url\" content=\"https://docs.python.org/3/library/contextvars.html\" />\n<meta property=\"og:site_name\" content=\"Python documentation\" />\n<meta property=\"og:description\" content=\"This module provides APIs to manage, store, and access context-local state. The ContextVar class is used to declare and work with Context Variables. The copy_context() function and the Context clas...\" />\n<meta property=\"og:image:width\" content=\"1146\" />\n<meta property=\"og:image:height\" content=\"600\" />\n<meta property=\"og:image\" content=\"https://docs.python.org/3.14/_images/social_previews/summary_library_contextvars_0dbe76df.png\" />\n<meta property=\"og:image:alt\" content=\"This module provides APIs to manage, store, and access context-local state. The ContextVar class is used to declare and work with Context Variables. The copy_context() function and the Context clas...\" />\n<meta name=\"description\" content=\"This module provides APIs to manage, store, and access context-local state. The ContextVar class is used to declare and work with Context Variables. The copy_context() function and the Context clas...\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"theme-color\" content=\"#3776ab\">\n\n    <title>contextvars — Context Variables &#8212; Python 3.14.0 documentation</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    \n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments.css?v=b86133f3\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/classic.css?v=234b1a7c\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pydoctheme.css?v=8cd84f99\" />\n    <link id=\"pygments_dark_css\" media=\"(prefers-color-scheme: dark)\" rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments_dark.css?v=5349f25f\" />\n    \n    <script src=\"../_static/documentation_options.js?v=e4f4b189\"></script>\n    <script src=\"../_static/doctools.js?v=9bcbadda\"></script>\n    <script src=\"../_static/sphinx_highlight.js?v=dc90522c\"></script>\n    \n    <script src=\"../_static/sidebar.js\"></script>\n    \n    <link rel=\"search\" type=\"application/opensearchdescription+xml\"\n          title=\"Search within Python 3.14.0 documentation\"\n          href=\"../_static/opensearch.xml\"/>\n    <link rel=\"author\" title=\"About these documents\" href=\"../about.html\" />\n    <link rel=\"index\" title=\"Index\" href=\"../genindex.html\" />\n    <link rel=\"search\" title=\"Search\" href=\"../search.html\" />\n    <link rel=\"copyright\" title=\"Copyright\" href=\"../copyright.html\" />\n    <link rel=\"next\" title=\"_thread — Low-level threading API\" href=\"_thread.html\" />\n    <link rel=\"prev\" title=\"queue — A synchronized queue class\" href=\"queue.html\" />\n    \n      \n      <script defer file-types=\"bz2,epub,zip\" data-domain=\"docs.python.org\" src=\"https://analytics.python.org/js/script.file-downloads.outbound-links.js\"></script>\n      \n      <link rel=\"canonical\" href=\"https://docs.python.org/3/library/contextvars.html\">\n      \n    \n\n    \n    <style>\n      @media only screen {\n        table.full-width-table {\n            width: 100%;\n        }\n      }\n    </style>\n<link rel=\"stylesheet\" href=\"../_static/pydoctheme_dark.css\" media=\"(prefers-color-scheme: dark)\" id=\"pydoctheme_dark_css\">\n    <link rel=\"shortcut icon\" type=\"image/png\" href=\"../_static/py.svg\">\n            <script type=\"text/javascript\" src=\"../_static/copybutton.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/menu.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/search-focus.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/themetoggle.js\"></script> \n            <script type=\"text/javascript\" src=\"../_static/rtd_switcher.js\"></script>\n            <meta name=\"readthedocs-addons-api-version\" content=\"1\">\n\n  </head>\n<body>\n<div class=\"mobile-nav\">\n    <input type=\"checkbox\" id=\"menuToggler\" class=\"toggler__input\" aria-controls=\"navigation\"\n           aria-pressed=\"false\" aria-expanded=\"false\" role=\"button\" aria-label=\"Menu\">\n    <nav class=\"nav-content\" role=\"navigation\">\n        <label for=\"menuToggler\" class=\"toggler__label\">\n            <span></span>\n        </label>\n        <span class=\"nav-items-wrapper\">\n            <a href=\"https://www.python.org/\" class=\"nav-logo\">\n                <img src=\"../_static/py.svg\" alt=\"Python logo\">\n            </a>\n            <span class=\"version_switcher_placeholder\"></span>\n            <form role=\"search\" class=\"search\" action=\"../search.html\" method=\"get\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" class=\"search-icon\">\n                    <path fill-rule=\"nonzero\" fill=\"currentColor\" d=\"M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path>\n                </svg>\n                <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\">\n                <input type=\"submit\" value=\"Go\">\n            </form>\n        </span>\n    </nav>\n    <div class=\"menu-wrapper\">\n        <nav class=\"menu\" role=\"navigation\" aria-label=\"main navigation\">\n            <div class=\"language_switcher_placeholder\"></div>\n            \n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label>\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">contextvars</span></code> — Context Variables</a><ul>\n<li><a class=\"reference internal\" href=\"#context-variables\">Context Variables</a></li>\n<li><a class=\"reference internal\" href=\"#manual-context-management\">Manual Context Management</a></li>\n<li><a class=\"reference internal\" href=\"#asyncio-support\">asyncio support</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"queue.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">queue</span></code> — A synchronized queue class</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"_thread.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">_thread</span></code> — Low-level threading API</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/contextvars.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </nav>\n    </div>\n</div>\n\n  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             accesskey=\"I\">index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"_thread.html\" title=\"_thread — Low-level threading API\"\n             accesskey=\"N\">next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"queue.html\" title=\"queue — A synchronized queue class\"\n             accesskey=\"P\">previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"concurrency.html\" accesskey=\"U\">Concurrent Execution</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">contextvars</span></code> — Context Variables</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>    \n\n    <div class=\"document\">\n      <div class=\"documentwrapper\">\n        <div class=\"bodywrapper\">\n          <div class=\"body\" role=\"main\">\n            \n  <section id=\"module-contextvars\">\n<span id=\"contextvars-context-variables\"></span><h1><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">contextvars</span></code> — Context Variables<a class=\"headerlink\" href=\"#module-contextvars\" title=\"Link to this heading\">¶</a></h1>\n<hr class=\"docutils\" />\n<p>This module provides APIs to manage, store, and access context-local\nstate.  The <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVar</span></code></a> class is used to declare\nand work with <em>Context Variables</em>.  The <a class=\"reference internal\" href=\"#contextvars.copy_context\" title=\"contextvars.copy_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">copy_context()</span></code></a>\nfunction and the <a class=\"reference internal\" href=\"#contextvars.Context\" title=\"contextvars.Context\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code></a> class should be used to\nmanage the current context in asynchronous frameworks.</p>\n<p>Context managers that have state should use Context Variables\ninstead of <a class=\"reference internal\" href=\"threading.html#threading.local\" title=\"threading.local\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">threading.local()</span></code></a> to prevent their state from\nbleeding to other code unexpectedly, when used in concurrent code.</p>\n<p>See also <span class=\"target\" id=\"index-0\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-0567/\"><strong>PEP 567</strong></a> for additional details.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n<section id=\"context-variables\">\n<h2>Context Variables<a class=\"headerlink\" href=\"#context-variables\" title=\"Link to this heading\">¶</a></h2>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"contextvars.ContextVar\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">contextvars.</span></span><span class=\"sig-name descname\"><span class=\"pre\">ContextVar</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">name</span></span></em><span class=\"optional\">[</span>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">*</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">default</span></span></em><span class=\"optional\">]</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.ContextVar\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>This class is used to declare a new Context Variable, e.g.:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">var</span><span class=\"p\">:</span> <span class=\"n\">ContextVar</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">ContextVar</span><span class=\"p\">(</span><span class=\"s1\">&#39;var&#39;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"mi\">42</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The required <em>name</em> parameter is used for introspection and debug\npurposes.</p>\n<p>The optional keyword-only <em>default</em> parameter is returned by\n<a class=\"reference internal\" href=\"#contextvars.ContextVar.get\" title=\"contextvars.ContextVar.get\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.get()</span></code></a> when no value for the variable is found\nin the current context.</p>\n<p><strong>Important:</strong> Context Variables should be created at the top module\nlevel and never in closures.  <a class=\"reference internal\" href=\"#contextvars.Context\" title=\"contextvars.Context\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code></a> objects hold strong\nreferences to context variables which prevents context variables\nfrom being properly garbage collected.</p>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"contextvars.ContextVar.name\">\n<span class=\"sig-name descname\"><span class=\"pre\">name</span></span><a class=\"headerlink\" href=\"#contextvars.ContextVar.name\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The name of the variable.  This is a read-only property.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.1.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.ContextVar.get\">\n<span class=\"sig-name descname\"><span class=\"pre\">get</span></span><span class=\"sig-paren\">(</span><span class=\"optional\">[</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">default</span></span></em><span class=\"optional\">]</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.ContextVar.get\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a value for the context variable for the current context.</p>\n<p>If there is no value for the variable in the current context,\nthe method will:</p>\n<ul class=\"simple\">\n<li><p>return the value of the <em>default</em> argument of the method,\nif provided; or</p></li>\n<li><p>return the default value for the context variable,\nif it was created with one; or</p></li>\n<li><p>raise a <a class=\"reference internal\" href=\"exceptions.html#LookupError\" title=\"LookupError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">LookupError</span></code></a>.</p></li>\n</ul>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.ContextVar.set\">\n<span class=\"sig-name descname\"><span class=\"pre\">set</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">value</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.ContextVar.set\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Call to set a new value for the context variable in the current\ncontext.</p>\n<p>The required <em>value</em> argument is the new value for the context\nvariable.</p>\n<p>Returns a <a class=\"reference internal\" href=\"#contextvars.Token\" title=\"contextvars.Token\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Token</span></code></a> object that can be used\nto restore the variable to its previous value via the\n<a class=\"reference internal\" href=\"#contextvars.ContextVar.reset\" title=\"contextvars.ContextVar.reset\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.reset()</span></code></a> method.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.ContextVar.reset\">\n<span class=\"sig-name descname\"><span class=\"pre\">reset</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">token</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.ContextVar.reset\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Reset the context variable to the value it had before the\n<a class=\"reference internal\" href=\"#contextvars.ContextVar.set\" title=\"contextvars.ContextVar.set\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.set()</span></code></a> that created the <em>token</em> was used.</p>\n<p>For example:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">var</span> <span class=\"o\">=</span> <span class=\"n\">ContextVar</span><span class=\"p\">(</span><span class=\"s1\">&#39;var&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">token</span> <span class=\"o\">=</span> <span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"s1\">&#39;new value&#39;</span><span class=\"p\">)</span>\n<span class=\"c1\"># code that uses &#39;var&#39;; var.get() returns &#39;new value&#39;.</span>\n<span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">reset</span><span class=\"p\">(</span><span class=\"n\">token</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># After the reset call the var has no value again, so</span>\n<span class=\"c1\"># var.get() would raise a LookupError.</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Token\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">contextvars.</span></span><span class=\"sig-name descname\"><span class=\"pre\">Token</span></span><a class=\"headerlink\" href=\"#contextvars.Token\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><em>Token</em> objects are returned by the <a class=\"reference internal\" href=\"#contextvars.ContextVar.set\" title=\"contextvars.ContextVar.set\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.set()</span></code></a> method.\nThey can be passed to the <a class=\"reference internal\" href=\"#contextvars.ContextVar.reset\" title=\"contextvars.ContextVar.reset\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.reset()</span></code></a> method to revert\nthe value of the variable to what it was before the corresponding\n<em>set</em>.</p>\n<p>The token supports <a class=\"reference internal\" href=\"../reference/datamodel.html#context-managers\"><span class=\"std std-ref\">context manager protocol</span></a>\nto restore the corresponding context variable value at the exit from\n<a class=\"reference internal\" href=\"../reference/compound_stmts.html#with\"><code class=\"xref std std-keyword docutils literal notranslate\"><span class=\"pre\">with</span></code></a> block:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">var</span> <span class=\"o\">=</span> <span class=\"n\">ContextVar</span><span class=\"p\">(</span><span class=\"s1\">&#39;var&#39;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s1\">&#39;default value&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">with</span> <span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"s1\">&#39;new value&#39;</span><span class=\"p\">):</span>\n    <span class=\"k\">assert</span> <span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;new value&#39;</span>\n\n<span class=\"k\">assert</span> <span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;default value&#39;</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14: </span>Added support for usage as a context manager.</p>\n</div>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Token.var\">\n<span class=\"sig-name descname\"><span class=\"pre\">var</span></span><a class=\"headerlink\" href=\"#contextvars.Token.var\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A read-only property.  Points to the <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVar</span></code></a> object\nthat created the token.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Token.old_value\">\n<span class=\"sig-name descname\"><span class=\"pre\">old_value</span></span><a class=\"headerlink\" href=\"#contextvars.Token.old_value\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A read-only property.  Set to the value the variable had before\nthe <a class=\"reference internal\" href=\"#contextvars.ContextVar.set\" title=\"contextvars.ContextVar.set\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.set()</span></code></a> method call that created the token.\nIt points to <a class=\"reference internal\" href=\"#contextvars.Token.MISSING\" title=\"contextvars.Token.MISSING\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Token.MISSING</span></code></a> if the variable was not set\nbefore the call.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Token.MISSING\">\n<span class=\"sig-name descname\"><span class=\"pre\">MISSING</span></span><a class=\"headerlink\" href=\"#contextvars.Token.MISSING\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A marker object used by <a class=\"reference internal\" href=\"#contextvars.Token.old_value\" title=\"contextvars.Token.old_value\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">Token.old_value</span></code></a>.</p>\n</dd></dl>\n\n</dd></dl>\n\n</section>\n<section id=\"manual-context-management\">\n<h2>Manual Context Management<a class=\"headerlink\" href=\"#manual-context-management\" title=\"Link to this heading\">¶</a></h2>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"contextvars.copy_context\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">contextvars.</span></span><span class=\"sig-name descname\"><span class=\"pre\">copy_context</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.copy_context\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns a copy of the current <a class=\"reference internal\" href=\"#contextvars.Context\" title=\"contextvars.Context\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code></a> object.</p>\n<p>The following snippet gets a copy of the current context and prints\nall variables and their values that are set in it:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ctx</span><span class=\"p\">:</span> <span class=\"n\">Context</span> <span class=\"o\">=</span> <span class=\"n\">copy_context</span><span class=\"p\">()</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">()))</span>\n</pre></div>\n</div>\n<p>The function has an <em>O</em>(1) complexity, i.e. works equally fast for\ncontexts with a few context variables and for contexts that have\na lot of them.</p>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">contextvars.</span></span><span class=\"sig-name descname\"><span class=\"pre\">Context</span></span><a class=\"headerlink\" href=\"#contextvars.Context\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A mapping of <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVars</span></code></a> to their values.</p>\n<p><code class=\"docutils literal notranslate\"><span class=\"pre\">Context()</span></code> creates an empty context with no values in it.\nTo get a copy of the current context use the\n<a class=\"reference internal\" href=\"#contextvars.copy_context\" title=\"contextvars.copy_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">copy_context()</span></code></a> function.</p>\n<p>Each thread has its own effective stack of <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code> objects.  The\n<a class=\"reference internal\" href=\"../glossary.html#term-current-context\"><span class=\"xref std std-term\">current context</span></a> is the <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code> object at the top of the\ncurrent thread’s stack.  All <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Context</span></code> objects in the stacks are\nconsidered to be <em>entered</em>.</p>\n<p><em>Entering</em> a context, which can be done by calling its <a class=\"reference internal\" href=\"#contextvars.Context.run\" title=\"contextvars.Context.run\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">run()</span></code></a>\nmethod, makes the context the current context by pushing it onto the top of\nthe current thread’s context stack.</p>\n<p><em>Exiting</em> from the current context, which can be done by returning from the\ncallback passed to the <a class=\"reference internal\" href=\"#contextvars.Context.run\" title=\"contextvars.Context.run\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">run()</span></code></a> method, restores the current\ncontext to what it was before the context was entered by popping the context\noff the top of the context stack.</p>\n<p>Since each thread has its own context stack, <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVar</span></code></a> objects\nbehave in a similar fashion to <a class=\"reference internal\" href=\"threading.html#threading.local\" title=\"threading.local\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">threading.local()</span></code></a> when values are\nassigned in different threads.</p>\n<p>Attempting to enter an already entered context, including contexts entered in\nother threads, raises a <a class=\"reference internal\" href=\"exceptions.html#RuntimeError\" title=\"RuntimeError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">RuntimeError</span></code></a>.</p>\n<p>After exiting a context, it can later be re-entered (from any thread).</p>\n<p>Any changes to <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVar</span></code></a> values via the <a class=\"reference internal\" href=\"#contextvars.ContextVar.set\" title=\"contextvars.ContextVar.set\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.set()</span></code></a>\nmethod are recorded in the current context.  The <a class=\"reference internal\" href=\"#contextvars.ContextVar.get\" title=\"contextvars.ContextVar.get\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">ContextVar.get()</span></code></a>\nmethod returns the value associated with the current context.  Exiting a\ncontext effectively reverts any changes made to context variables while the\ncontext was entered (if needed, the values can be restored by re-entering the\ncontext).</p>\n<p>Context implements the <a class=\"reference internal\" href=\"collections.abc.html#collections.abc.Mapping\" title=\"collections.abc.Mapping\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">collections.abc.Mapping</span></code></a> interface.</p>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.run\">\n<span class=\"sig-name descname\"><span class=\"pre\">run</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">callable</span></span></em>, <em class=\"sig-param\"><span class=\"o\"><span class=\"pre\">*</span></span><span class=\"n\"><span class=\"pre\">args</span></span></em>, <em class=\"sig-param\"><span class=\"o\"><span class=\"pre\">**</span></span><span class=\"n\"><span class=\"pre\">kwargs</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.run\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enters the Context, executes <code class=\"docutils literal notranslate\"><span class=\"pre\">callable(*args,</span> <span class=\"pre\">**kwargs)</span></code>, then exits the\nContext.  Returns <em>callable</em>’s return value, or propagates an exception if\none occurred.</p>\n<p>Example:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">contextvars</span>\n\n<span class=\"n\">var</span> <span class=\"o\">=</span> <span class=\"n\">contextvars</span><span class=\"o\">.</span><span class=\"n\">ContextVar</span><span class=\"p\">(</span><span class=\"s1\">&#39;var&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"s1\">&#39;spam&#39;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">())</span>  <span class=\"c1\"># &#39;spam&#39;</span>\n\n<span class=\"n\">ctx</span> <span class=\"o\">=</span> <span class=\"n\">contextvars</span><span class=\"o\">.</span><span class=\"n\">copy_context</span><span class=\"p\">()</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"c1\"># &#39;var&#39; was set to &#39;spam&#39; before</span>\n    <span class=\"c1\"># calling &#39;copy_context()&#39; and &#39;ctx.run(main)&#39;, so:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">())</span>  <span class=\"c1\"># &#39;spam&#39;</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">[</span><span class=\"n\">var</span><span class=\"p\">])</span>  <span class=\"c1\"># &#39;spam&#39;</span>\n\n    <span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"s1\">&#39;ham&#39;</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Now, after setting &#39;var&#39; to &#39;ham&#39;:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">())</span>  <span class=\"c1\"># &#39;ham&#39;</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">[</span><span class=\"n\">var</span><span class=\"p\">])</span>  <span class=\"c1\"># &#39;ham&#39;</span>\n\n<span class=\"c1\"># Any changes that the &#39;main&#39; function makes to &#39;var&#39;</span>\n<span class=\"c1\"># will be contained in &#39;ctx&#39;.</span>\n<span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># The &#39;main()&#39; function was run in the &#39;ctx&#39; context,</span>\n<span class=\"c1\"># so changes to &#39;var&#39; are contained in it:</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">ctx</span><span class=\"p\">[</span><span class=\"n\">var</span><span class=\"p\">])</span>  <span class=\"c1\"># &#39;ham&#39;</span>\n\n<span class=\"c1\"># However, outside of &#39;ctx&#39;, &#39;var&#39; is still set to &#39;spam&#39;:</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">())</span>  <span class=\"c1\"># &#39;spam&#39;</span>\n</pre></div>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.copy\">\n<span class=\"sig-name descname\"><span class=\"pre\">copy</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.copy\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a shallow copy of the context object.</p>\n</dd></dl>\n\n<dl class=\"describe\">\n<dt class=\"sig sig-object\">\n<span class=\"sig-name descname\"><span class=\"pre\">var</span> <span class=\"pre\">in</span> <span class=\"pre\">context</span></span></dt>\n<dd><p>Return <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> if the <em>context</em> has a value for <em>var</em> set;\nreturn <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code> otherwise.</p>\n</dd></dl>\n\n<dl class=\"describe\">\n<dt class=\"sig sig-object\">\n<span class=\"sig-name descname\"><span class=\"pre\">context[var]</span></span></dt>\n<dd><p>Return the value of the <em>var</em> <a class=\"reference internal\" href=\"#contextvars.ContextVar\" title=\"contextvars.ContextVar\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ContextVar</span></code></a> variable.\nIf the variable is not set in the context object, a\n<a class=\"reference internal\" href=\"exceptions.html#KeyError\" title=\"KeyError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">KeyError</span></code></a> is raised.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.get\">\n<span class=\"sig-name descname\"><span class=\"pre\">get</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">var</span></span></em><span class=\"optional\">[</span>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">default</span></span></em><span class=\"optional\">]</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.get\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the value for <em>var</em> if <em>var</em> has the value in the context\nobject.  Return <em>default</em> otherwise.  If <em>default</em> is not given,\nreturn <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>.</p>\n</dd></dl>\n\n<dl class=\"describe\">\n<dt class=\"sig sig-object\">\n<span class=\"sig-name descname\"><span class=\"pre\">iter(context)</span></span></dt>\n<dd><p>Return an iterator over the variables stored in the context\nobject.</p>\n</dd></dl>\n\n<dl class=\"describe\">\n<dt class=\"sig sig-object\">\n<span class=\"sig-name descname\"><span class=\"pre\">len(proxy)</span></span></dt>\n<dd><p>Return the number of variables set in the context object.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.keys\">\n<span class=\"sig-name descname\"><span class=\"pre\">keys</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.keys\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a list of all variables in the context object.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.values\">\n<span class=\"sig-name descname\"><span class=\"pre\">values</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.values\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a list of all variables’ values in the context object.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"contextvars.Context.items\">\n<span class=\"sig-name descname\"><span class=\"pre\">items</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#contextvars.Context.items\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a list of 2-tuples containing all variables and their\nvalues in the context object.</p>\n</dd></dl>\n\n</dd></dl>\n\n</section>\n<section id=\"asyncio-support\">\n<h2>asyncio support<a class=\"headerlink\" href=\"#asyncio-support\" title=\"Link to this heading\">¶</a></h2>\n<p>Context variables are natively supported in <a class=\"reference internal\" href=\"asyncio.html#module-asyncio\" title=\"asyncio: Asynchronous I/O.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">asyncio</span></code></a> and are\nready to be used without any extra configuration.  For example, here\nis a simple echo server, that uses a context variable to make the\naddress of a remote client available in the Task that handles that\nclient:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">asyncio</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">contextvars</span>\n\n<span class=\"n\">client_addr_var</span> <span class=\"o\">=</span> <span class=\"n\">contextvars</span><span class=\"o\">.</span><span class=\"n\">ContextVar</span><span class=\"p\">(</span><span class=\"s1\">&#39;client_addr&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">render_goodbye</span><span class=\"p\">():</span>\n    <span class=\"c1\"># The address of the currently handled client can be accessed</span>\n    <span class=\"c1\"># without passing it explicitly to this function.</span>\n\n    <span class=\"n\">client_addr</span> <span class=\"o\">=</span> <span class=\"n\">client_addr_var</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"sa\">f</span><span class=\"s1\">&#39;Good bye, client @ </span><span class=\"si\">{</span><span class=\"n\">client_addr</span><span class=\"si\">}</span><span class=\"se\">\\r\\n</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">()</span>\n\n<span class=\"k\">async</span> <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">handle_request</span><span class=\"p\">(</span><span class=\"n\">reader</span><span class=\"p\">,</span> <span class=\"n\">writer</span><span class=\"p\">):</span>\n    <span class=\"n\">addr</span> <span class=\"o\">=</span> <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">transport</span><span class=\"o\">.</span><span class=\"n\">get_extra_info</span><span class=\"p\">(</span><span class=\"s1\">&#39;socket&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">getpeername</span><span class=\"p\">()</span>\n    <span class=\"n\">client_addr_var</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"n\">addr</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># In any code that we call is now possible to get</span>\n    <span class=\"c1\"># client&#39;s address by calling &#39;client_addr_var.get()&#39;.</span>\n\n    <span class=\"k\">while</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n        <span class=\"n\">line</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">reader</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">line</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">():</span>\n            <span class=\"k\">break</span>\n\n    <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s1\">&#39;HTTP/1.1 200 OK</span><span class=\"se\">\\r\\n</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>  <span class=\"c1\"># status line</span>\n    <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s1\">&#39;</span><span class=\"se\">\\r\\n</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>  <span class=\"c1\"># headers</span>\n    <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">render_goodbye</span><span class=\"p\">())</span>  <span class=\"c1\"># body</span>\n    <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n\n<span class=\"k\">async</span> <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">srv</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"n\">asyncio</span><span class=\"o\">.</span><span class=\"n\">start_server</span><span class=\"p\">(</span>\n        <span class=\"n\">handle_request</span><span class=\"p\">,</span> <span class=\"s1\">&#39;127.0.0.1&#39;</span><span class=\"p\">,</span> <span class=\"mi\">8081</span><span class=\"p\">)</span>\n\n    <span class=\"k\">async</span> <span class=\"k\">with</span> <span class=\"n\">srv</span><span class=\"p\">:</span>\n        <span class=\"k\">await</span> <span class=\"n\">srv</span><span class=\"o\">.</span><span class=\"n\">serve_forever</span><span class=\"p\">()</span>\n\n<span class=\"n\">asyncio</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">())</span>\n\n<span class=\"c1\"># To test it you can use telnet or curl:</span>\n<span class=\"c1\">#     telnet 127.0.0.1 8081</span>\n<span class=\"c1\">#     curl 127.0.0.1:8081</span>\n</pre></div>\n</div>\n</section>\n</section>\n\n\n            <div class=\"clearer\"></div>\n          </div>\n        </div>\n      </div>\n      <div class=\"sphinxsidebar\" role=\"navigation\" aria-label=\"Main\">\n        <div class=\"sphinxsidebarwrapper\">\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">contextvars</span></code> — Context Variables</a><ul>\n<li><a class=\"reference internal\" href=\"#context-variables\">Context Variables</a></li>\n<li><a class=\"reference internal\" href=\"#manual-context-management\">Manual Context Management</a></li>\n<li><a class=\"reference internal\" href=\"#asyncio-support\">asyncio support</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"queue.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">queue</span></code> — A synchronized queue class</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"_thread.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">_thread</span></code> — Low-level threading API</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/contextvars.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </div>\n<div id=\"sidebarbutton\" title=\"Collapse sidebar\">\n<span>«</span>\n</div>\n\n      </div>\n      <div class=\"clearer\"></div>\n    </div>  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             >index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"_thread.html\" title=\"_thread — Low-level threading API\"\n             >next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"queue.html\" title=\"queue — A synchronized queue class\"\n             >previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"concurrency.html\" >Concurrent Execution</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">contextvars</span></code> — Context Variables</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>  \n    <div class=\"footer\">\n    &copy; <a href=\"../copyright.html\">Copyright</a> 2001 Python Software Foundation.\n    <br>\n    This page is licensed under the Python Software Foundation License Version 2.\n    <br>\n    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.\n    <br>\n    \n      See <a href=\"/license.html\">History and License</a> for more information.<br>\n    \n    \n    <br>\n\n    The Python Software Foundation is a non-profit corporation.\n<a href=\"https://www.python.org/psf/donations/\">Please donate.</a>\n<br>\n    <br>\n      Last updated on Nov 25, 2025 (18:01 UTC).\n    \n      <a href=\"/bugs.html\">Found a bug</a>?\n    \n    <br>\n\n    Created using <a href=\"https://www.sphinx-doc.org/\">Sphinx</a> 8.2.3.\n    </div>\n\n    <script type=\"text/javascript\" src=\"../_static/switchers.js\"></script>\n  </body>\n</html>",
  "metadata": {
    "title": "contextvars — Context Variables — Python 3.14.0 documentation",
    "meta_description": "This module provides APIs to manage, store, and access context-local state. The ContextVar class is used to declare and work with Context Variables. The copy_context() function and the Context clas...",
    "h1": "— Context Variables"
  },
  "request_headers": {
    "Referer": "https://docs.python.org/3/library/",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en",
    "User-Agent": "DumbCrawler/1.0",
    "Accept-Encoding": "gzip, deflate"
  },
  "response_headers": {
    "Content-Length": "8905",
    "Server": "nginx",
    "Content-Type": "text/html",
    "Last-Modified": "Tue, 25 Nov 2025 18:03:26 GMT",
    "Etag": "\"6925ef6e-bc2f\"",
    "X-Clacks-Overhead": "GNU Terry Pratchett",
    "Strict-Transport-Security": "max-age=315360000; includeSubDomains; preload",
    "Via": "1.1 varnish, 1.1 varnish",
    "Accept-Ranges": "bytes",
    "Age": "2992",
    "Date": "Wed, 26 Nov 2025 05:25:21 GMT",
    "X-Served-By": "cache-lga21922-LGA, cache-yul1970036-YUL",
    "X-Cache": "HIT, HIT",
    "X-Cache-Hits": "266, 0",
    "X-Timer": "S1764134721.434028,VS0,VE1",
    "Vary": "Accept-Encoding"
  },
  "crawled_at": "2025-11-26T05:25:22.154351+00:00",
  "crawler": {
    "name": "DumbCrawler",
    "version": "1.0",
    "mode": "crawl",
    "js_mode": "off",
    "scope": "subdomain"
  }
}