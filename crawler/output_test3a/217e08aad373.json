{
  "url": "https://docs.python.org/3/library/heapq.html",
  "status_code": 200,
  "depth": 1,
  "referrer": "https://docs.python.org/3/library/",
  "raw_html": "<!DOCTYPE html>\n\n<html lang=\"en\" data-content_root=\"../\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<meta property=\"og:title\" content=\"heapq — Heap queue algorithm\" />\n<meta property=\"og:type\" content=\"website\" />\n<meta property=\"og:url\" content=\"https://docs.python.org/3/library/heapq.html\" />\n<meta property=\"og:site_name\" content=\"Python documentation\" />\n<meta property=\"og:description\" content=\"Source code: Lib/heapq.py This module provides an implementation of the heap queue algorithm, also known as the priority queue algorithm. Min-heaps are binary trees for which every parent node has ...\" />\n<meta property=\"og:image:width\" content=\"1146\" />\n<meta property=\"og:image:height\" content=\"600\" />\n<meta property=\"og:image\" content=\"https://docs.python.org/3.14/_images/social_previews/summary_library_heapq_8d19462b.png\" />\n<meta property=\"og:image:alt\" content=\"Source code: Lib/heapq.py This module provides an implementation of the heap queue algorithm, also known as the priority queue algorithm. Min-heaps are binary trees for which every parent node has ...\" />\n<meta name=\"description\" content=\"Source code: Lib/heapq.py This module provides an implementation of the heap queue algorithm, also known as the priority queue algorithm. Min-heaps are binary trees for which every parent node has ...\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"theme-color\" content=\"#3776ab\">\n\n    <title>heapq — Heap queue algorithm &#8212; Python 3.14.0 documentation</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    \n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments.css?v=b86133f3\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/classic.css?v=234b1a7c\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pydoctheme.css?v=8cd84f99\" />\n    <link id=\"pygments_dark_css\" media=\"(prefers-color-scheme: dark)\" rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments_dark.css?v=5349f25f\" />\n    \n    <script src=\"../_static/documentation_options.js?v=e4f4b189\"></script>\n    <script src=\"../_static/doctools.js?v=9bcbadda\"></script>\n    <script src=\"../_static/sphinx_highlight.js?v=dc90522c\"></script>\n    \n    <script src=\"../_static/sidebar.js\"></script>\n    \n    <link rel=\"search\" type=\"application/opensearchdescription+xml\"\n          title=\"Search within Python 3.14.0 documentation\"\n          href=\"../_static/opensearch.xml\"/>\n    <link rel=\"author\" title=\"About these documents\" href=\"../about.html\" />\n    <link rel=\"index\" title=\"Index\" href=\"../genindex.html\" />\n    <link rel=\"search\" title=\"Search\" href=\"../search.html\" />\n    <link rel=\"copyright\" title=\"Copyright\" href=\"../copyright.html\" />\n    <link rel=\"next\" title=\"bisect — Array bisection algorithm\" href=\"bisect.html\" />\n    <link rel=\"prev\" title=\"collections.abc — Abstract Base Classes for Containers\" href=\"collections.abc.html\" />\n    \n      \n      <script defer file-types=\"bz2,epub,zip\" data-domain=\"docs.python.org\" src=\"https://analytics.python.org/js/script.file-downloads.outbound-links.js\"></script>\n      \n      <link rel=\"canonical\" href=\"https://docs.python.org/3/library/heapq.html\">\n      \n    \n\n    \n    <style>\n      @media only screen {\n        table.full-width-table {\n            width: 100%;\n        }\n      }\n    </style>\n<link rel=\"stylesheet\" href=\"../_static/pydoctheme_dark.css\" media=\"(prefers-color-scheme: dark)\" id=\"pydoctheme_dark_css\">\n    <link rel=\"shortcut icon\" type=\"image/png\" href=\"../_static/py.svg\">\n            <script type=\"text/javascript\" src=\"../_static/copybutton.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/menu.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/search-focus.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/themetoggle.js\"></script> \n            <script type=\"text/javascript\" src=\"../_static/rtd_switcher.js\"></script>\n            <meta name=\"readthedocs-addons-api-version\" content=\"1\">\n\n  </head>\n<body>\n<div class=\"mobile-nav\">\n    <input type=\"checkbox\" id=\"menuToggler\" class=\"toggler__input\" aria-controls=\"navigation\"\n           aria-pressed=\"false\" aria-expanded=\"false\" role=\"button\" aria-label=\"Menu\">\n    <nav class=\"nav-content\" role=\"navigation\">\n        <label for=\"menuToggler\" class=\"toggler__label\">\n            <span></span>\n        </label>\n        <span class=\"nav-items-wrapper\">\n            <a href=\"https://www.python.org/\" class=\"nav-logo\">\n                <img src=\"../_static/py.svg\" alt=\"Python logo\">\n            </a>\n            <span class=\"version_switcher_placeholder\"></span>\n            <form role=\"search\" class=\"search\" action=\"../search.html\" method=\"get\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" class=\"search-icon\">\n                    <path fill-rule=\"nonzero\" fill=\"currentColor\" d=\"M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path>\n                </svg>\n                <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\">\n                <input type=\"submit\" value=\"Go\">\n            </form>\n        </span>\n    </nav>\n    <div class=\"menu-wrapper\">\n        <nav class=\"menu\" role=\"navigation\" aria-label=\"main navigation\">\n            <div class=\"language_switcher_placeholder\"></div>\n            \n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label>\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> — Heap queue algorithm</a><ul>\n<li><a class=\"reference internal\" href=\"#basic-examples\">Basic Examples</a></li>\n<li><a class=\"reference internal\" href=\"#priority-queue-implementation-notes\">Priority Queue Implementation Notes</a></li>\n<li><a class=\"reference internal\" href=\"#theory\">Theory</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"collections.abc.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">collections.abc</span></code> — Abstract Base Classes for Containers</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"bisect.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">bisect</span></code> — Array bisection algorithm</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/heapq.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </nav>\n    </div>\n</div>\n\n  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             accesskey=\"I\">index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"bisect.html\" title=\"bisect — Array bisection algorithm\"\n             accesskey=\"N\">next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"collections.abc.html\" title=\"collections.abc — Abstract Base Classes for Containers\"\n             accesskey=\"P\">previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"datatypes.html\" accesskey=\"U\">Data Types</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> — Heap queue algorithm</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>    \n\n    <div class=\"document\">\n      <div class=\"documentwrapper\">\n        <div class=\"bodywrapper\">\n          <div class=\"body\" role=\"main\">\n            \n  <section id=\"module-heapq\">\n<span id=\"heapq-heap-queue-algorithm\"></span><h1><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> — Heap queue algorithm<a class=\"headerlink\" href=\"#module-heapq\" title=\"Link to this heading\">¶</a></h1>\n<p><strong>Source code:</strong> <a class=\"extlink-source reference external\" href=\"https://github.com/python/cpython/tree/3.14/Lib/heapq.py\">Lib/heapq.py</a></p>\n<hr class=\"docutils\" />\n<p>This module provides an implementation of the heap queue algorithm, also known\nas the priority queue algorithm.</p>\n<p>Min-heaps are binary trees for which every parent node has a value less than\nor equal to any of its children.\nWe refer to this condition as the heap invariant.</p>\n<p>For min-heaps, this implementation uses lists for which\n<code class=\"docutils literal notranslate\"><span class=\"pre\">heap[k]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">heap[2*k+1]</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">heap[k]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">heap[2*k+2]</span></code> for all <em>k</em> for which\nthe compared elements exist.  Elements are counted from zero.  The interesting\nproperty of a min-heap is that its smallest element is always the root,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">heap[0]</span></code>.</p>\n<p>Max-heaps satisfy the reverse invariant: every parent node has a value\n<em>greater</em> than any of its children.  These are implemented as lists for which\n<code class=\"docutils literal notranslate\"><span class=\"pre\">maxheap[2*k+1]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">maxheap[k]</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">maxheap[2*k+2]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">maxheap[k]</span></code> for all\n<em>k</em> for which the compared elements exist.\nThe root, <code class=\"docutils literal notranslate\"><span class=\"pre\">maxheap[0]</span></code>, contains the <em>largest</em> element;\n<code class=\"docutils literal notranslate\"><span class=\"pre\">heap.sort(reverse=True)</span></code> maintains the max-heap invariant.</p>\n<p>The <code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> API differs from textbook heap algorithms in two aspects: (a)\nWe use zero-based indexing.  This makes the relationship between the index for\na node and the indexes for its children slightly less obvious, but is more\nsuitable since Python uses zero-based indexing. (b) Textbooks often focus on\nmax-heaps, due to their suitability for in-place sorting. Our implementation\nfavors min-heaps as they better correspond to Python <a class=\"reference internal\" href=\"stdtypes.html#list\" title=\"list\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">lists</span></code></a>.</p>\n<p>These two aspects make it possible to view the heap as a regular Python list\nwithout surprises: <code class=\"docutils literal notranslate\"><span class=\"pre\">heap[0]</span></code> is the smallest item, and <code class=\"docutils literal notranslate\"><span class=\"pre\">heap.sort()</span></code>\nmaintains the heap invariant!</p>\n<p>Like <a class=\"reference internal\" href=\"stdtypes.html#list.sort\" title=\"list.sort\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">list.sort()</span></code></a>, this implementation uses only the <code class=\"docutils literal notranslate\"><span class=\"pre\">&lt;</span></code> operator\nfor comparisons, for both min-heaps and max-heaps.</p>\n<p>In the API below, and in this documentation, the unqualified term <em>heap</em>\ngenerally refers to a min-heap.\nThe API for max-heaps is named using a <code class=\"docutils literal notranslate\"><span class=\"pre\">_max</span></code>  suffix.</p>\n<p>To create a heap, use a list initialized as <code class=\"docutils literal notranslate\"><span class=\"pre\">[]</span></code>, or transform an existing list\ninto a min-heap or max-heap using the <a class=\"reference internal\" href=\"#heapq.heapify\" title=\"heapq.heapify\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heapify()</span></code></a> or <a class=\"reference internal\" href=\"#heapq.heapify_max\" title=\"heapq.heapify_max\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heapify_max()</span></code></a>\nfunctions, respectively.</p>\n<p>The following functions are provided for min-heaps:</p>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heapify\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heapify</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">x</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heapify\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Transform list <em>x</em> into a min-heap, in-place, in linear time.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappush\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappush</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappush\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Push the value <em>item</em> onto the <em>heap</em>, maintaining the min-heap invariant.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappop\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappop</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappop\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Pop and return the smallest item from the <em>heap</em>, maintaining the min-heap\ninvariant.  If the heap is empty, <a class=\"reference internal\" href=\"exceptions.html#IndexError\" title=\"IndexError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">IndexError</span></code></a> is raised.  To access the\nsmallest item without popping it, use <code class=\"docutils literal notranslate\"><span class=\"pre\">heap[0]</span></code>.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappushpop\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappushpop</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappushpop\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Push <em>item</em> on the heap, then pop and return the smallest item from the\n<em>heap</em>.  The combined action runs more efficiently than <a class=\"reference internal\" href=\"#heapq.heappush\" title=\"heapq.heappush\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappush()</span></code></a>\nfollowed by a separate call to <a class=\"reference internal\" href=\"#heapq.heappop\" title=\"heapq.heappop\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappop()</span></code></a>.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heapreplace\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heapreplace</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heapreplace\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Pop and return the smallest item from the <em>heap</em>, and also push the new <em>item</em>.\nThe heap size doesn’t change. If the heap is empty, <a class=\"reference internal\" href=\"exceptions.html#IndexError\" title=\"IndexError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">IndexError</span></code></a> is raised.</p>\n<p>This one step operation is more efficient than a <a class=\"reference internal\" href=\"#heapq.heappop\" title=\"heapq.heappop\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappop()</span></code></a> followed by\n<a class=\"reference internal\" href=\"#heapq.heappush\" title=\"heapq.heappush\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappush()</span></code></a> and can be more appropriate when using a fixed-size heap.\nThe pop/push combination always returns an element from the heap and replaces\nit with <em>item</em>.</p>\n<p>The value returned may be larger than the <em>item</em> added.  If that isn’t\ndesired, consider using <a class=\"reference internal\" href=\"#heapq.heappushpop\" title=\"heapq.heappushpop\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappushpop()</span></code></a> instead.  Its push/pop\ncombination returns the smaller of the two values, leaving the larger value\non the heap.</p>\n</dd></dl>\n\n<p>For max-heaps, the following functions are provided:</p>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heapify_max\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heapify_max</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">x</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heapify_max\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Transform list <em>x</em> into a max-heap, in-place, in linear time.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappush_max\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappush_max</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappush_max\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Push the value <em>item</em> onto the max-heap <em>heap</em>, maintaining the max-heap\ninvariant.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappop_max\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappop_max</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappop_max\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Pop and return the largest item from the max-heap <em>heap</em>, maintaining the\nmax-heap invariant.  If the max-heap is empty, <a class=\"reference internal\" href=\"exceptions.html#IndexError\" title=\"IndexError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">IndexError</span></code></a> is raised.\nTo access the largest item without popping it, use <code class=\"docutils literal notranslate\"><span class=\"pre\">maxheap[0]</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heappushpop_max\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heappushpop_max</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heappushpop_max\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Push <em>item</em> on the max-heap <em>heap</em>, then pop and return the largest item\nfrom <em>heap</em>.\nThe combined action runs more efficiently than <a class=\"reference internal\" href=\"#heapq.heappush_max\" title=\"heapq.heappush_max\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappush_max()</span></code></a>\nfollowed by a separate call to <a class=\"reference internal\" href=\"#heapq.heappop_max\" title=\"heapq.heappop_max\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heappop_max()</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.heapreplace_max\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">heapreplace_max</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">heap</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">item</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.heapreplace_max\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Pop and return the largest item from the max-heap <em>heap</em> and also push the\nnew <em>item</em>.\nThe max-heap size doesn’t change. If the max-heap is empty,\n<a class=\"reference internal\" href=\"exceptions.html#IndexError\" title=\"IndexError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">IndexError</span></code></a> is raised.</p>\n<p>The value returned may be smaller than the <em>item</em> added.  Refer to the\nanalogous function <a class=\"reference internal\" href=\"#heapq.heapreplace\" title=\"heapq.heapreplace\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">heapreplace()</span></code></a> for detailed usage notes.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<p>The module also offers three general purpose functions based on heaps.</p>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.merge\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">merge</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"o\"><span class=\"pre\">*</span></span><span class=\"n\"><span class=\"pre\">iterables</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">key</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">reverse</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.merge\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Merge multiple sorted inputs into a single sorted output (for example, merge\ntimestamped entries from multiple log files).  Returns an <a class=\"reference internal\" href=\"../glossary.html#term-iterator\"><span class=\"xref std std-term\">iterator</span></a>\nover the sorted values.</p>\n<p>Similar to <code class=\"docutils literal notranslate\"><span class=\"pre\">sorted(itertools.chain(*iterables))</span></code> but returns an iterable, does\nnot pull the data into memory all at once, and assumes that each of the input\nstreams is already sorted (smallest to largest).</p>\n<p>Has two optional arguments which must be specified as keyword arguments.</p>\n<p><em>key</em> specifies a <a class=\"reference internal\" href=\"../glossary.html#term-key-function\"><span class=\"xref std std-term\">key function</span></a> of one argument that is used to\nextract a comparison key from each input element.  The default value is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> (compare the elements directly).</p>\n<p><em>reverse</em> is a boolean value.  If set to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>, then the input elements\nare merged as if each comparison were reversed. To achieve behavior similar\nto <code class=\"docutils literal notranslate\"><span class=\"pre\">sorted(itertools.chain(*iterables),</span> <span class=\"pre\">reverse=True)</span></code>, all iterables must\nbe sorted from largest to smallest.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>Added the optional <em>key</em> and <em>reverse</em> parameters.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.nlargest\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">nlargest</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">n</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">iterable</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">key</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.nlargest\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a list with the <em>n</em> largest elements from the dataset defined by\n<em>iterable</em>.  <em>key</em>, if provided, specifies a function of one argument that is\nused to extract a comparison key from each element in <em>iterable</em> (for example,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">key=str.lower</span></code>).  Equivalent to:  <code class=\"docutils literal notranslate\"><span class=\"pre\">sorted(iterable,</span> <span class=\"pre\">key=key,</span>\n<span class=\"pre\">reverse=True)[:n]</span></code>.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"heapq.nsmallest\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">heapq.</span></span><span class=\"sig-name descname\"><span class=\"pre\">nsmallest</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">n</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">iterable</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">key</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#heapq.nsmallest\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a list with the <em>n</em> smallest elements from the dataset defined by\n<em>iterable</em>.  <em>key</em>, if provided, specifies a function of one argument that is\nused to extract a comparison key from each element in <em>iterable</em> (for example,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">key=str.lower</span></code>).  Equivalent to:  <code class=\"docutils literal notranslate\"><span class=\"pre\">sorted(iterable,</span> <span class=\"pre\">key=key)[:n]</span></code>.</p>\n</dd></dl>\n\n<p>The latter two functions perform best for smaller values of <em>n</em>.  For larger\nvalues, it is more efficient to use the <a class=\"reference internal\" href=\"functions.html#sorted\" title=\"sorted\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">sorted()</span></code></a> function.  Also, when\n<code class=\"docutils literal notranslate\"><span class=\"pre\">n==1</span></code>, it is more efficient to use the built-in <a class=\"reference internal\" href=\"functions.html#min\" title=\"min\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">min()</span></code></a> and <a class=\"reference internal\" href=\"functions.html#max\" title=\"max\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">max()</span></code></a>\nfunctions.  If repeated usage of these functions is required, consider turning\nthe iterable into an actual heap.</p>\n<section id=\"basic-examples\">\n<h2>Basic Examples<a class=\"headerlink\" href=\"#basic-examples\" title=\"Link to this heading\">¶</a></h2>\n<p>A <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Heapsort\">heapsort</a> can be implemented by\npushing all values onto a heap and then popping off the smallest values one at a\ntime:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">heapsort</span><span class=\"p\">(</span><span class=\"n\">iterable</span><span class=\"p\">):</span>\n<span class=\"gp\">... </span>    <span class=\"n\">h</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"gp\">... </span>    <span class=\"k\">for</span> <span class=\"n\">value</span> <span class=\"ow\">in</span> <span class=\"n\">iterable</span><span class=\"p\">:</span>\n<span class=\"gp\">... </span>        <span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"n\">value</span><span class=\"p\">)</span>\n<span class=\"gp\">... </span>    <span class=\"k\">return</span> <span class=\"p\">[</span><span class=\"n\">heappop</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">))]</span>\n<span class=\"gp\">...</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heapsort</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"go\">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>\n</pre></div>\n</div>\n<p>This is similar to <code class=\"docutils literal notranslate\"><span class=\"pre\">sorted(iterable)</span></code>, but unlike <a class=\"reference internal\" href=\"functions.html#sorted\" title=\"sorted\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">sorted()</span></code></a>, this\nimplementation is not stable.</p>\n<p>Heap elements can be tuples.  This is useful for assigning comparison values\n(such as task priorities) alongside the main record being tracked:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">h</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"s1\">&#39;write code&#39;</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"s1\">&#39;release product&#39;</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"s1\">&#39;write spec&#39;</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"s1\">&#39;create tests&#39;</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">heappop</span><span class=\"p\">(</span><span class=\"n\">h</span><span class=\"p\">)</span>\n<span class=\"go\">(1, &#39;write spec&#39;)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"priority-queue-implementation-notes\">\n<h2>Priority Queue Implementation Notes<a class=\"headerlink\" href=\"#priority-queue-implementation-notes\" title=\"Link to this heading\">¶</a></h2>\n<p>A <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Priority_queue\">priority queue</a> is common use\nfor a heap, and it presents several implementation challenges:</p>\n<ul class=\"simple\">\n<li><p>Sort stability:  how do you get two tasks with equal priorities to be returned\nin the order they were originally added?</p></li>\n<li><p>Tuple comparison breaks for (priority, task) pairs if the priorities are equal\nand the tasks do not have a default comparison order.</p></li>\n<li><p>If the priority of a task changes, how do you move it to a new position in\nthe heap?</p></li>\n<li><p>Or if a pending task needs to be deleted, how do you find it and remove it\nfrom the queue?</p></li>\n</ul>\n<p>A solution to the first two challenges is to store entries as 3-element list\nincluding the priority, an entry count, and the task.  The entry count serves as\na tie-breaker so that two tasks with the same priority are returned in the order\nthey were added. And since no two entry counts are the same, the tuple\ncomparison will never attempt to directly compare two tasks.</p>\n<p>Another solution to the problem of non-comparable tasks is to create a wrapper\nclass that ignores the task item and only compares the priority field:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">dataclasses</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">dataclass</span><span class=\"p\">,</span> <span class=\"n\">field</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">typing</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Any</span>\n\n<span class=\"nd\">@dataclass</span><span class=\"p\">(</span><span class=\"n\">order</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">PrioritizedItem</span><span class=\"p\">:</span>\n    <span class=\"n\">priority</span><span class=\"p\">:</span> <span class=\"nb\">int</span>\n    <span class=\"n\">item</span><span class=\"p\">:</span> <span class=\"n\">Any</span><span class=\"o\">=</span><span class=\"n\">field</span><span class=\"p\">(</span><span class=\"n\">compare</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The remaining challenges revolve around finding a pending task and making\nchanges to its priority or removing it entirely.  Finding a task can be done\nwith a dictionary pointing to an entry in the queue.</p>\n<p>Removing the entry or changing its priority is more difficult because it would\nbreak the heap structure invariants.  So, a possible solution is to mark the\nentry as removed and add a new entry with the revised priority:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">pq</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>                         <span class=\"c1\"># list of entries arranged in a heap</span>\n<span class=\"n\">entry_finder</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>               <span class=\"c1\"># mapping of tasks to entries</span>\n<span class=\"n\">REMOVED</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;&lt;removed-task&gt;&#39;</span>      <span class=\"c1\"># placeholder for a removed task</span>\n<span class=\"n\">counter</span> <span class=\"o\">=</span> <span class=\"n\">itertools</span><span class=\"o\">.</span><span class=\"n\">count</span><span class=\"p\">()</span>     <span class=\"c1\"># unique sequence count</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">add_task</span><span class=\"p\">(</span><span class=\"n\">task</span><span class=\"p\">,</span> <span class=\"n\">priority</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">):</span>\n    <span class=\"s1\">&#39;Add a new task or update the priority of an existing task&#39;</span>\n    <span class=\"k\">if</span> <span class=\"n\">task</span> <span class=\"ow\">in</span> <span class=\"n\">entry_finder</span><span class=\"p\">:</span>\n        <span class=\"n\">remove_task</span><span class=\"p\">(</span><span class=\"n\">task</span><span class=\"p\">)</span>\n    <span class=\"n\">count</span> <span class=\"o\">=</span> <span class=\"nb\">next</span><span class=\"p\">(</span><span class=\"n\">counter</span><span class=\"p\">)</span>\n    <span class=\"n\">entry</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">priority</span><span class=\"p\">,</span> <span class=\"n\">count</span><span class=\"p\">,</span> <span class=\"n\">task</span><span class=\"p\">]</span>\n    <span class=\"n\">entry_finder</span><span class=\"p\">[</span><span class=\"n\">task</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">entry</span>\n    <span class=\"n\">heappush</span><span class=\"p\">(</span><span class=\"n\">pq</span><span class=\"p\">,</span> <span class=\"n\">entry</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">remove_task</span><span class=\"p\">(</span><span class=\"n\">task</span><span class=\"p\">):</span>\n    <span class=\"s1\">&#39;Mark an existing task as REMOVED.  Raise KeyError if not found.&#39;</span>\n    <span class=\"n\">entry</span> <span class=\"o\">=</span> <span class=\"n\">entry_finder</span><span class=\"o\">.</span><span class=\"n\">pop</span><span class=\"p\">(</span><span class=\"n\">task</span><span class=\"p\">)</span>\n    <span class=\"n\">entry</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">REMOVED</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">pop_task</span><span class=\"p\">():</span>\n    <span class=\"s1\">&#39;Remove and return the lowest priority task. Raise KeyError if empty.&#39;</span>\n    <span class=\"k\">while</span> <span class=\"n\">pq</span><span class=\"p\">:</span>\n        <span class=\"n\">priority</span><span class=\"p\">,</span> <span class=\"n\">count</span><span class=\"p\">,</span> <span class=\"n\">task</span> <span class=\"o\">=</span> <span class=\"n\">heappop</span><span class=\"p\">(</span><span class=\"n\">pq</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">task</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">REMOVED</span><span class=\"p\">:</span>\n            <span class=\"k\">del</span> <span class=\"n\">entry_finder</span><span class=\"p\">[</span><span class=\"n\">task</span><span class=\"p\">]</span>\n            <span class=\"k\">return</span> <span class=\"n\">task</span>\n    <span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"s1\">&#39;pop from an empty priority queue&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"theory\">\n<h2>Theory<a class=\"headerlink\" href=\"#theory\" title=\"Link to this heading\">¶</a></h2>\n<p>Heaps are arrays for which <code class=\"docutils literal notranslate\"><span class=\"pre\">a[k]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">a[2*k+1]</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">a[k]</span> <span class=\"pre\">&lt;=</span> <span class=\"pre\">a[2*k+2]</span></code> for all\n<em>k</em>, counting elements from 0.  For the sake of comparison, non-existing\nelements are considered to be infinite.  The interesting property of a heap is\nthat <code class=\"docutils literal notranslate\"><span class=\"pre\">a[0]</span></code> is always its smallest element.</p>\n<p>The strange invariant above is meant to be an efficient memory representation\nfor a tournament.  The numbers below are <em>k</em>, not <code class=\"docutils literal notranslate\"><span class=\"pre\">a[k]</span></code>:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span>                               <span class=\"mi\">0</span>\n\n              <span class=\"mi\">1</span>                                 <span class=\"mi\">2</span>\n\n      <span class=\"mi\">3</span>               <span class=\"mi\">4</span>                <span class=\"mi\">5</span>               <span class=\"mi\">6</span>\n\n  <span class=\"mi\">7</span>       <span class=\"mi\">8</span>       <span class=\"mi\">9</span>       <span class=\"mi\">10</span>      <span class=\"mi\">11</span>      <span class=\"mi\">12</span>      <span class=\"mi\">13</span>      <span class=\"mi\">14</span>\n\n<span class=\"mi\">15</span> <span class=\"mi\">16</span>   <span class=\"mi\">17</span> <span class=\"mi\">18</span>   <span class=\"mi\">19</span> <span class=\"mi\">20</span>   <span class=\"mi\">21</span> <span class=\"mi\">22</span>   <span class=\"mi\">23</span> <span class=\"mi\">24</span>   <span class=\"mi\">25</span> <span class=\"mi\">26</span>   <span class=\"mi\">27</span> <span class=\"mi\">28</span>   <span class=\"mi\">29</span> <span class=\"mi\">30</span>\n</pre></div>\n</div>\n<p>In the tree above, each cell <em>k</em> is topping <code class=\"docutils literal notranslate\"><span class=\"pre\">2*k+1</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">2*k+2</span></code>. In a usual\nbinary tournament we see in sports, each cell is the winner over the two cells\nit tops, and we can trace the winner down the tree to see all opponents s/he\nhad.  However, in many computer applications of such tournaments, we do not need\nto trace the history of a winner. To be more memory efficient, when a winner is\npromoted, we try to replace it by something else at a lower level, and the rule\nbecomes that a cell and the two cells it tops contain three different items, but\nthe top cell “wins” over the two topped cells.</p>\n<p>If this heap invariant is protected at all time, index 0 is clearly the overall\nwinner.  The simplest algorithmic way to remove it and find the “next” winner is\nto move some loser (let’s say cell 30 in the diagram above) into the 0 position,\nand then percolate this new 0 down the tree, exchanging values, until the\ninvariant is re-established. This is clearly logarithmic on the total number of\nitems in the tree. By iterating over all items, you get an <em>O</em>(<em>n</em> log <em>n</em>) sort.</p>\n<p>A nice feature of this sort is that you can efficiently insert new items while\nthe sort is going on, provided that the inserted items are not “better” than the\nlast 0’th element you extracted.  This is especially useful in simulation\ncontexts, where the tree holds all incoming events, and the “win” condition\nmeans the smallest scheduled time.  When an event schedules other events for\nexecution, they are scheduled into the future, so they can easily go into the\nheap.  So, a heap is a good structure for implementing schedulers (this is what\nI used for my MIDI sequencer :-).</p>\n<p>Various structures for implementing schedulers have been extensively studied,\nand heaps are good for this, as they are reasonably speedy, the speed is almost\nconstant, and the worst case is not much different than the average case.\nHowever, there are other representations which are more efficient overall, yet\nthe worst cases might be terrible.</p>\n<p>Heaps are also very useful in big disk sorts.  You most probably all know that a\nbig sort implies producing “runs” (which are pre-sorted sequences, whose size is\nusually related to the amount of CPU memory), followed by a merging passes for\nthese runs, which merging is often very cleverly organised <a class=\"footnote-reference brackets\" href=\"#id2\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a>. It is very\nimportant that the initial sort produces the longest runs possible.  Tournaments\nare a good way to achieve that.  If, using all the memory available to hold a\ntournament, you replace and percolate items that happen to fit the current run,\nyou’ll produce runs which are twice the size of the memory for random input, and\nmuch better for input fuzzily ordered.</p>\n<p>Moreover, if you output the 0’th item on disk and get an input which may not fit\nin the current tournament (because the value “wins” over the last output value),\nit cannot fit in the heap, so the size of the heap decreases.  The freed memory\ncould be cleverly reused immediately for progressively building a second heap,\nwhich grows at exactly the same rate the first heap is melting.  When the first\nheap completely vanishes, you switch heaps and start a new run.  Clever and\nquite effective!</p>\n<p>In a word, heaps are useful memory structures to know.  I use them in a few\napplications, and I think it is good to keep a ‘heap’ module around. :-)</p>\n<p class=\"rubric\">Footnotes</p>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id2\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id1\">1</a><span class=\"fn-bracket\">]</span></span>\n<p>The disk balancing algorithms which are current, nowadays, are more annoying\nthan clever, and this is a consequence of the seeking capabilities of the disks.\nOn devices which cannot seek, like big tape drives, the story was quite\ndifferent, and one had to be very clever to ensure (far in advance) that each\ntape movement will be the most effective possible (that is, will best\nparticipate at “progressing” the merge).  Some tapes were even able to read\nbackwards, and this was also used to avoid the rewinding time. Believe me, real\ngood tape sorts were quite spectacular to watch! From all times, sorting has\nalways been a Great Art! :-)</p>\n</aside>\n</aside>\n</section>\n</section>\n\n\n            <div class=\"clearer\"></div>\n          </div>\n        </div>\n      </div>\n      <div class=\"sphinxsidebar\" role=\"navigation\" aria-label=\"Main\">\n        <div class=\"sphinxsidebarwrapper\">\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> — Heap queue algorithm</a><ul>\n<li><a class=\"reference internal\" href=\"#basic-examples\">Basic Examples</a></li>\n<li><a class=\"reference internal\" href=\"#priority-queue-implementation-notes\">Priority Queue Implementation Notes</a></li>\n<li><a class=\"reference internal\" href=\"#theory\">Theory</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"collections.abc.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">collections.abc</span></code> — Abstract Base Classes for Containers</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"bisect.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">bisect</span></code> — Array bisection algorithm</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/heapq.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </div>\n<div id=\"sidebarbutton\" title=\"Collapse sidebar\">\n<span>«</span>\n</div>\n\n      </div>\n      <div class=\"clearer\"></div>\n    </div>  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             >index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"bisect.html\" title=\"bisect — Array bisection algorithm\"\n             >next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"collections.abc.html\" title=\"collections.abc — Abstract Base Classes for Containers\"\n             >previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"datatypes.html\" >Data Types</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">heapq</span></code> — Heap queue algorithm</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>  \n    <div class=\"footer\">\n    &copy; <a href=\"../copyright.html\">Copyright</a> 2001 Python Software Foundation.\n    <br>\n    This page is licensed under the Python Software Foundation License Version 2.\n    <br>\n    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.\n    <br>\n    \n      See <a href=\"/license.html\">History and License</a> for more information.<br>\n    \n    \n    <br>\n\n    The Python Software Foundation is a non-profit corporation.\n<a href=\"https://www.python.org/psf/donations/\">Please donate.</a>\n<br>\n    <br>\n      Last updated on Nov 25, 2025 (18:01 UTC).\n    \n      <a href=\"/bugs.html\">Found a bug</a>?\n    \n    <br>\n\n    Created using <a href=\"https://www.sphinx-doc.org/\">Sphinx</a> 8.2.3.\n    </div>\n\n    <script type=\"text/javascript\" src=\"../_static/switchers.js\"></script>\n  </body>\n</html>",
  "metadata": {
    "title": "heapq — Heap queue algorithm — Python 3.14.0 documentation",
    "meta_description": "Source code: Lib/heapq.py This module provides an implementation of the heap queue algorithm, also known as the priority queue algorithm. Min-heaps are binary trees for which every parent node has ...",
    "h1": "— Heap queue algorithm"
  },
  "request_headers": {
    "Referer": "https://docs.python.org/3/library/",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en",
    "User-Agent": "DumbCrawler/1.0",
    "Accept-Encoding": "gzip, deflate"
  },
  "response_headers": {
    "Content-Length": "11549",
    "Server": "nginx",
    "Content-Type": "text/html",
    "Last-Modified": "Tue, 25 Nov 2025 18:03:26 GMT",
    "Etag": "\"6925ef6e-d362\"",
    "X-Clacks-Overhead": "GNU Terry Pratchett",
    "Strict-Transport-Security": "max-age=315360000; includeSubDomains; preload",
    "Via": "1.1 varnish, 1.1 varnish",
    "Accept-Ranges": "bytes",
    "Age": "4606",
    "Date": "Wed, 26 Nov 2025 05:32:35 GMT",
    "X-Served-By": "cache-lga21932-LGA, cache-yul1970070-YUL",
    "X-Cache": "HIT, HIT",
    "X-Cache-Hits": "208, 0",
    "X-Timer": "S1764135155.306222,VS0,VE1",
    "Vary": "Accept-Encoding"
  },
  "crawled_at": "2025-11-26T05:32:35.806700+00:00",
  "crawler": {
    "name": "DumbCrawler",
    "version": "1.0",
    "mode": "crawl",
    "js_mode": "off",
    "scope": "subfolder"
  }
}