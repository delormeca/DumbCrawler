{
  "url": "https://docs.python.org/3/library/ssl.html",
  "status_code": 200,
  "depth": 1,
  "referrer": "https://docs.python.org/3/library/",
  "raw_html": "<!DOCTYPE html>\n\n<html lang=\"en\" data-content_root=\"../\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<meta property=\"og:title\" content=\"ssl — TLS/SSL wrapper for socket objects\" />\n<meta property=\"og:type\" content=\"website\" />\n<meta property=\"og:url\" content=\"https://docs.python.org/3/library/ssl.html\" />\n<meta property=\"og:site_name\" content=\"Python documentation\" />\n<meta property=\"og:description\" content=\"Source code: Lib/ssl.py This module provides access to Transport Layer Security (often known as “Secure Sockets Layer”) encryption and peer authentication facilities for network sockets, both clien...\" />\n<meta property=\"og:image:width\" content=\"1146\" />\n<meta property=\"og:image:height\" content=\"600\" />\n<meta property=\"og:image\" content=\"https://docs.python.org/3.14/_images/social_previews/summary_library_ssl_fab19422.png\" />\n<meta property=\"og:image:alt\" content=\"Source code: Lib/ssl.py This module provides access to Transport Layer Security (often known as “Secure Sockets Layer”) encryption and peer authentication facilities for network sockets, both clien...\" />\n<meta name=\"description\" content=\"Source code: Lib/ssl.py This module provides access to Transport Layer Security (often known as “Secure Sockets Layer”) encryption and peer authentication facilities for network sockets, both clien...\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"theme-color\" content=\"#3776ab\">\n\n    <title>ssl — TLS/SSL wrapper for socket objects &#8212; Python 3.14.0 documentation</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    \n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments.css?v=b86133f3\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/classic.css?v=234b1a7c\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pydoctheme.css?v=8cd84f99\" />\n    <link id=\"pygments_dark_css\" media=\"(prefers-color-scheme: dark)\" rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments_dark.css?v=5349f25f\" />\n    \n    <script src=\"../_static/documentation_options.js?v=e4f4b189\"></script>\n    <script src=\"../_static/doctools.js?v=9bcbadda\"></script>\n    <script src=\"../_static/sphinx_highlight.js?v=dc90522c\"></script>\n    \n    <script src=\"../_static/sidebar.js\"></script>\n    \n    <link rel=\"search\" type=\"application/opensearchdescription+xml\"\n          title=\"Search within Python 3.14.0 documentation\"\n          href=\"../_static/opensearch.xml\"/>\n    <link rel=\"author\" title=\"About these documents\" href=\"../about.html\" />\n    <link rel=\"index\" title=\"Index\" href=\"../genindex.html\" />\n    <link rel=\"search\" title=\"Search\" href=\"../search.html\" />\n    <link rel=\"copyright\" title=\"Copyright\" href=\"../copyright.html\" />\n    <link rel=\"next\" title=\"select — Waiting for I/O completion\" href=\"select.html\" />\n    <link rel=\"prev\" title=\"socket — Low-level networking interface\" href=\"socket.html\" />\n    \n      \n      <script defer file-types=\"bz2,epub,zip\" data-domain=\"docs.python.org\" src=\"https://analytics.python.org/js/script.file-downloads.outbound-links.js\"></script>\n      \n      <link rel=\"canonical\" href=\"https://docs.python.org/3/library/ssl.html\">\n      \n    \n\n    \n    <style>\n      @media only screen {\n        table.full-width-table {\n            width: 100%;\n        }\n      }\n    </style>\n<link rel=\"stylesheet\" href=\"../_static/pydoctheme_dark.css\" media=\"(prefers-color-scheme: dark)\" id=\"pydoctheme_dark_css\">\n    <link rel=\"shortcut icon\" type=\"image/png\" href=\"../_static/py.svg\">\n            <script type=\"text/javascript\" src=\"../_static/copybutton.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/menu.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/search-focus.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/themetoggle.js\"></script> \n            <script type=\"text/javascript\" src=\"../_static/rtd_switcher.js\"></script>\n            <meta name=\"readthedocs-addons-api-version\" content=\"1\">\n\n  </head>\n<body>\n<div class=\"mobile-nav\">\n    <input type=\"checkbox\" id=\"menuToggler\" class=\"toggler__input\" aria-controls=\"navigation\"\n           aria-pressed=\"false\" aria-expanded=\"false\" role=\"button\" aria-label=\"Menu\">\n    <nav class=\"nav-content\" role=\"navigation\">\n        <label for=\"menuToggler\" class=\"toggler__label\">\n            <span></span>\n        </label>\n        <span class=\"nav-items-wrapper\">\n            <a href=\"https://www.python.org/\" class=\"nav-logo\">\n                <img src=\"../_static/py.svg\" alt=\"Python logo\">\n            </a>\n            <span class=\"version_switcher_placeholder\"></span>\n            <form role=\"search\" class=\"search\" action=\"../search.html\" method=\"get\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" class=\"search-icon\">\n                    <path fill-rule=\"nonzero\" fill=\"currentColor\" d=\"M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path>\n                </svg>\n                <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\">\n                <input type=\"submit\" value=\"Go\">\n            </form>\n        </span>\n    </nav>\n    <div class=\"menu-wrapper\">\n        <nav class=\"menu\" role=\"navigation\" aria-label=\"main navigation\">\n            <div class=\"language_switcher_placeholder\"></div>\n            \n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label>\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code> — TLS/SSL wrapper for socket objects</a><ul>\n<li><a class=\"reference internal\" href=\"#functions-constants-and-exceptions\">Functions, Constants, and Exceptions</a><ul>\n<li><a class=\"reference internal\" href=\"#socket-creation\">Socket creation</a></li>\n<li><a class=\"reference internal\" href=\"#context-creation\">Context creation</a></li>\n<li><a class=\"reference internal\" href=\"#exceptions\">Exceptions</a></li>\n<li><a class=\"reference internal\" href=\"#random-generation\">Random generation</a></li>\n<li><a class=\"reference internal\" href=\"#certificate-handling\">Certificate handling</a></li>\n<li><a class=\"reference internal\" href=\"#constants\">Constants</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#ssl-sockets\">SSL Sockets</a></li>\n<li><a class=\"reference internal\" href=\"#ssl-contexts\">SSL Contexts</a></li>\n<li><a class=\"reference internal\" href=\"#certificates\">Certificates</a><ul>\n<li><a class=\"reference internal\" href=\"#certificate-chains\">Certificate chains</a></li>\n<li><a class=\"reference internal\" href=\"#ca-certificates\">CA certificates</a></li>\n<li><a class=\"reference internal\" href=\"#combined-key-and-certificate\">Combined key and certificate</a></li>\n<li><a class=\"reference internal\" href=\"#self-signed-certificates\">Self-signed certificates</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#examples\">Examples</a><ul>\n<li><a class=\"reference internal\" href=\"#testing-for-ssl-support\">Testing for SSL support</a></li>\n<li><a class=\"reference internal\" href=\"#client-side-operation\">Client-side operation</a></li>\n<li><a class=\"reference internal\" href=\"#server-side-operation\">Server-side operation</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#notes-on-non-blocking-sockets\">Notes on non-blocking sockets</a></li>\n<li><a class=\"reference internal\" href=\"#memory-bio-support\">Memory BIO Support</a></li>\n<li><a class=\"reference internal\" href=\"#ssl-session\">SSL session</a></li>\n<li><a class=\"reference internal\" href=\"#security-considerations\">Security considerations</a><ul>\n<li><a class=\"reference internal\" href=\"#best-defaults\">Best defaults</a></li>\n<li><a class=\"reference internal\" href=\"#manual-settings\">Manual settings</a><ul>\n<li><a class=\"reference internal\" href=\"#verifying-certificates\">Verifying certificates</a></li>\n<li><a class=\"reference internal\" href=\"#protocol-versions\">Protocol versions</a></li>\n<li><a class=\"reference internal\" href=\"#cipher-selection\">Cipher selection</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#multi-processing\">Multi-processing</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#tls-1-3\">TLS 1.3</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"socket.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">socket</span></code> — Low-level networking interface</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"select.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">select</span></code> — Waiting for I/O completion</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/ssl.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </nav>\n    </div>\n</div>\n\n  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             accesskey=\"I\">index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"select.html\" title=\"select — Waiting for I/O completion\"\n             accesskey=\"N\">next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"socket.html\" title=\"socket — Low-level networking interface\"\n             accesskey=\"P\">previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"ipc.html\" accesskey=\"U\">Networking and Interprocess Communication</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code> — TLS/SSL wrapper for socket objects</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>    \n\n    <div class=\"document\">\n      <div class=\"documentwrapper\">\n        <div class=\"bodywrapper\">\n          <div class=\"body\" role=\"main\">\n            \n  <section id=\"module-ssl\">\n<span id=\"ssl-tls-ssl-wrapper-for-socket-objects\"></span><h1><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code> — TLS/SSL wrapper for socket objects<a class=\"headerlink\" href=\"#module-ssl\" title=\"Link to this heading\">¶</a></h1>\n<p><strong>Source code:</strong> <a class=\"extlink-source reference external\" href=\"https://github.com/python/cpython/tree/3.14/Lib/ssl.py\">Lib/ssl.py</a></p>\n<span id=\"index-0\"></span><hr class=\"docutils\" id=\"index-1\" />\n<p>This module provides access to Transport Layer Security (often known as “Secure\nSockets Layer”) encryption and peer authentication facilities for network\nsockets, both client-side and server-side.  This module uses the OpenSSL\nlibrary.</p>\n<p>This is an <a class=\"reference internal\" href=\"../glossary.html#term-optional-module\"><span class=\"xref std std-term\">optional module</span></a>.\nIf it is missing from your copy of CPython,\nlook for documentation from your distributor (that is,\nwhoever provided Python to you).\nIf you are the distributor, see <a class=\"reference internal\" href=\"../using/configure.html#optional-module-requirements\"><span class=\"std std-ref\">Requirements for optional modules</span></a>.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Some behavior may be platform dependent, since calls are made to the\noperating system socket APIs.  The installed version of OpenSSL may also\ncause variations in behavior. For example, TLSv1.3 comes with OpenSSL version\n1.1.1.</p>\n</div>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>Don’t use this module without reading the <a class=\"reference internal\" href=\"#ssl-security\"><span class=\"std std-ref\">Security considerations</span></a>.  Doing so\nmay lead to a false sense of security, as the default settings of the\nssl module are not necessarily appropriate for your application.</p>\n</div>\n<div class=\"availability docutils container\">\n<p><a class=\"reference internal\" href=\"intro.html#availability\"><span class=\"std std-ref\">Availability</span></a>: not WASI.</p>\n<p>This module does not work or is not available on WebAssembly. See\n<a class=\"reference internal\" href=\"intro.html#wasm-availability\"><span class=\"std std-ref\">WebAssembly platforms</span></a> for more information.</p>\n</div>\n<p>This section documents the objects and functions in the <code class=\"docutils literal notranslate\"><span class=\"pre\">ssl</span></code> module; for more\ngeneral information about TLS, SSL, and certificates, the reader is referred to\nthe documents in the “See Also” section at the bottom.</p>\n<p>This module provides a class, <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ssl.SSLSocket</span></code></a>, which is derived from the\n<a class=\"reference internal\" href=\"socket.html#socket.socket\" title=\"socket.socket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">socket.socket</span></code></a> type, and provides a socket-like wrapper that also\nencrypts and decrypts the data going over the socket with SSL.  It supports\nadditional methods such as <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getpeercert()</span></code>, which retrieves the\ncertificate of the other side of the connection, <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">cipher()</span></code>, which\nretrieves the cipher being used for the secure connection or\n<code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_verified_chain()</span></code>, <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_unverified_chain()</span></code> which retrieves\ncertificate chain.</p>\n<p>For more sophisticated applications, the <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ssl.SSLContext</span></code></a> class\nhelps manage settings and certificates, which can then be inherited\nby SSL sockets created through the <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a> method.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5.3: </span>Updated to support linking with OpenSSL 1.1.0</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span>OpenSSL 0.9.8, 1.0.0 and 1.0.1 are deprecated and no longer supported.\nIn the future the ssl module will require at least OpenSSL 1.0.2 or\n1.1.0.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span><span class=\"target\" id=\"index-2\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-0644/\"><strong>PEP 644</strong></a> has been implemented. The ssl module requires OpenSSL 1.1.1\nor newer.</p>\n<p>Use of deprecated constants and functions result in deprecation warnings.</p>\n</div>\n<section id=\"functions-constants-and-exceptions\">\n<h2>Functions, Constants, and Exceptions<a class=\"headerlink\" href=\"#functions-constants-and-exceptions\" title=\"Link to this heading\">¶</a></h2>\n<section id=\"socket-creation\">\n<h3>Socket creation<a class=\"headerlink\" href=\"#socket-creation\" title=\"Link to this heading\">¶</a></h3>\n<p>Instances of <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> must be created using the\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a> method. The helper function\n<a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a> returns a new context with secure default\nsettings.</p>\n<p>Client socket example with default context and IPv4/IPv6 dual stack:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">socket</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">ssl</span>\n\n<span class=\"n\">hostname</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;www.python.org&#39;</span>\n<span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span>\n\n<span class=\"k\">with</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">create_connection</span><span class=\"p\">((</span><span class=\"n\">hostname</span><span class=\"p\">,</span> <span class=\"mi\">443</span><span class=\"p\">))</span> <span class=\"k\">as</span> <span class=\"n\">sock</span><span class=\"p\">:</span>\n    <span class=\"k\">with</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">sock</span><span class=\"p\">,</span> <span class=\"n\">server_hostname</span><span class=\"o\">=</span><span class=\"n\">hostname</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">ssock</span><span class=\"p\">:</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">ssock</span><span class=\"o\">.</span><span class=\"n\">version</span><span class=\"p\">())</span>\n</pre></div>\n</div>\n<p>Client socket example with custom context and IPv4:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">hostname</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;www.python.org&#39;</span>\n<span class=\"c1\"># PROTOCOL_TLS_CLIENT requires valid cert chain and hostname</span>\n<span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_CLIENT</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">load_verify_locations</span><span class=\"p\">(</span><span class=\"s1\">&#39;path/to/cabundle.pem&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">with</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">socket</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">AF_INET</span><span class=\"p\">,</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">SOCK_STREAM</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">sock</span><span class=\"p\">:</span>\n    <span class=\"k\">with</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">sock</span><span class=\"p\">,</span> <span class=\"n\">server_hostname</span><span class=\"o\">=</span><span class=\"n\">hostname</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">ssock</span><span class=\"p\">:</span>\n        <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">ssock</span><span class=\"o\">.</span><span class=\"n\">version</span><span class=\"p\">())</span>\n</pre></div>\n</div>\n<p>Server socket example listening on localhost IPv4:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_SERVER</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">load_cert_chain</span><span class=\"p\">(</span><span class=\"s1\">&#39;/path/to/certchain.pem&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;/path/to/private.key&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">with</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">socket</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">AF_INET</span><span class=\"p\">,</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">SOCK_STREAM</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">sock</span><span class=\"p\">:</span>\n    <span class=\"n\">sock</span><span class=\"o\">.</span><span class=\"n\">bind</span><span class=\"p\">((</span><span class=\"s1\">&#39;127.0.0.1&#39;</span><span class=\"p\">,</span> <span class=\"mi\">8443</span><span class=\"p\">))</span>\n    <span class=\"n\">sock</span><span class=\"o\">.</span><span class=\"n\">listen</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n    <span class=\"k\">with</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">sock</span><span class=\"p\">,</span> <span class=\"n\">server_side</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">ssock</span><span class=\"p\">:</span>\n        <span class=\"n\">conn</span><span class=\"p\">,</span> <span class=\"n\">addr</span> <span class=\"o\">=</span> <span class=\"n\">ssock</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n        <span class=\"o\">...</span>\n</pre></div>\n</div>\n</section>\n<section id=\"context-creation\">\n<h3>Context creation<a class=\"headerlink\" href=\"#context-creation\" title=\"Link to this heading\">¶</a></h3>\n<p>A convenience function helps create <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> objects for common\npurposes.</p>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.create_default_context\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">create_default_context</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">purpose</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">Purpose.SERVER_AUTH</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cafile</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">capath</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cadata</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.create_default_context\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a new <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> object with default settings for\nthe given <em>purpose</em>.  The settings are chosen by the <a class=\"reference internal\" href=\"#module-ssl\" title=\"ssl: TLS/SSL wrapper for socket objects\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code></a> module,\nand usually represent a higher security level than when calling the\n<a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> constructor directly.</p>\n<p><em>cafile</em>, <em>capath</em>, <em>cadata</em> represent optional CA certificates to\ntrust for certificate verification, as in\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"ssl.SSLContext.load_verify_locations\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_verify_locations()</span></code></a>.  If all three are\n<a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a>, this function can choose to trust the system’s default\nCA certificates instead.</p>\n<p>The settings are: <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a>, <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv2\" title=\"ssl.OP_NO_SSLv2\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv2</span></code></a>, and <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv3\" title=\"ssl.OP_NO_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv3</span></code></a>\nwith high encryption cipher suites without RC4 and\nwithout unauthenticated cipher suites. Passing <a class=\"reference internal\" href=\"#ssl.Purpose.SERVER_AUTH\" title=\"ssl.Purpose.SERVER_AUTH\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">SERVER_AUTH</span></code></a>\nas <em>purpose</em> sets <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> to <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>\nand either loads CA certificates (when at least one of <em>cafile</em>, <em>capath</em> or\n<em>cadata</em> is given) or uses <a class=\"reference internal\" href=\"#ssl.SSLContext.load_default_certs\" title=\"ssl.SSLContext.load_default_certs\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_default_certs()</span></code></a> to load\ndefault CA certificates.</p>\n<p>When <a class=\"reference internal\" href=\"#ssl.SSLContext.keylog_filename\" title=\"ssl.SSLContext.keylog_filename\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">keylog_filename</span></code></a> is supported and the environment\nvariable <span class=\"target\" id=\"index-3\"></span><code class=\"xref std std-envvar docutils literal notranslate\"><span class=\"pre\">SSLKEYLOGFILE</span></code> is set, <a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a>\nenables key logging.</p>\n<p>The default settings for this context include\n<a class=\"reference internal\" href=\"#ssl.VERIFY_X509_PARTIAL_CHAIN\" title=\"ssl.VERIFY_X509_PARTIAL_CHAIN\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_X509_PARTIAL_CHAIN</span></code></a> and <a class=\"reference internal\" href=\"#ssl.VERIFY_X509_STRICT\" title=\"ssl.VERIFY_X509_STRICT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_X509_STRICT</span></code></a>.\nThese make the underlying OpenSSL implementation behave more like\na conforming implementation of <span class=\"target\" id=\"index-4\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5280.html\"><strong>RFC 5280</strong></a>, in exchange for a small\namount of incompatibility with older X.509 certificates.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>The protocol, options, cipher and other settings may change to more\nrestrictive values anytime without prior deprecation.  The values\nrepresent a fair balance between compatibility and security.</p>\n<p>If your application needs specific settings, you should create a\n<a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> and apply the settings yourself.</p>\n</div>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>If you find that when certain older clients or servers attempt to connect\nwith a <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> created by this function that they get an error\nstating “Protocol or cipher suite mismatch”, it may be that they only\nsupport SSL3.0 which this function excludes using the\n<a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv3\" title=\"ssl.OP_NO_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv3</span></code></a>. SSL3.0 is widely considered to be <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/POODLE\">completely broken</a>. If you still wish to continue to\nuse this function but still allow SSL 3.0 connections you can re-enable\nthem using:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ctx</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">(</span><span class=\"n\">Purpose</span><span class=\"o\">.</span><span class=\"n\">CLIENT_AUTH</span><span class=\"p\">)</span>\n<span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">options</span> <span class=\"o\">&amp;=</span> <span class=\"o\">~</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">OP_NO_SSLv3</span>\n</pre></div>\n</div>\n</div>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>This context enables <a class=\"reference internal\" href=\"#ssl.VERIFY_X509_STRICT\" title=\"ssl.VERIFY_X509_STRICT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_X509_STRICT</span></code></a> by default, which\nmay reject pre-<span class=\"target\" id=\"index-5\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5280.html\"><strong>RFC 5280</strong></a> or malformed certificates that the\nunderlying OpenSSL implementation otherwise would accept. While disabling\nthis is not recommended, you can do so using:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ctx</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span>\n<span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">verify_flags</span> <span class=\"o\">&amp;=</span> <span class=\"o\">~</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">VERIFY_X509_STRICT</span>\n</pre></div>\n</div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.4.4: </span>RC4 was dropped from the default cipher string.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span>ChaCha20/Poly1305 was added to the default cipher string.</p>\n<p>3DES was dropped from the default cipher string.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>Support for key logging to <span class=\"target\" id=\"index-6\"></span><code class=\"xref std std-envvar docutils literal notranslate\"><span class=\"pre\">SSLKEYLOGFILE</span></code> was added.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span>The context now uses <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> protocol instead of generic\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.13: </span>The context now uses <a class=\"reference internal\" href=\"#ssl.VERIFY_X509_PARTIAL_CHAIN\" title=\"ssl.VERIFY_X509_PARTIAL_CHAIN\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_X509_PARTIAL_CHAIN</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.VERIFY_X509_STRICT\" title=\"ssl.VERIFY_X509_STRICT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_X509_STRICT</span></code></a> in its default verify flags.</p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"exceptions\">\n<h3>Exceptions<a class=\"headerlink\" href=\"#exceptions\" title=\"Link to this heading\">¶</a></h3>\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLError</span></span><a class=\"headerlink\" href=\"#ssl.SSLError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Raised to signal an error from the underlying SSL implementation\n(currently provided by the OpenSSL library).  This signifies some\nproblem in the higher-level encryption and authentication layer that’s\nsuperimposed on the underlying network connection.  This error\nis a subtype of <a class=\"reference internal\" href=\"exceptions.html#OSError\" title=\"OSError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">OSError</span></code></a>.  The error code and message of\n<a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> instances are provided by the OpenSSL library.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.3: </span><a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> used to be a subtype of <a class=\"reference internal\" href=\"socket.html#socket.error\" title=\"socket.error\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">socket.error</span></code></a>.</p>\n</div>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLError.library\">\n<span class=\"sig-name descname\"><span class=\"pre\">library</span></span><a class=\"headerlink\" href=\"#ssl.SSLError.library\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A string mnemonic designating the OpenSSL submodule in which the error\noccurred, such as <code class=\"docutils literal notranslate\"><span class=\"pre\">SSL</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">PEM</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">X509</span></code>.  The range of possible\nvalues depends on the OpenSSL version.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLError.reason\">\n<span class=\"sig-name descname\"><span class=\"pre\">reason</span></span><a class=\"headerlink\" href=\"#ssl.SSLError.reason\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A string mnemonic designating the reason this error occurred, for\nexample <code class=\"docutils literal notranslate\"><span class=\"pre\">CERTIFICATE_VERIFY_FAILED</span></code>.  The range of possible\nvalues depends on the OpenSSL version.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLZeroReturnError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLZeroReturnError</span></span><a class=\"headerlink\" href=\"#ssl.SSLZeroReturnError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised when trying to read or write and\nthe SSL connection has been closed cleanly.  Note that this doesn’t\nmean that the underlying transport (read TCP) has been closed.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLWantReadError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLWantReadError</span></span><a class=\"headerlink\" href=\"#ssl.SSLWantReadError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised by a <a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking SSL socket</span></a> when trying to read or write data, but more data needs\nto be received on the underlying TCP transport before the request can be\nfulfilled.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLWantWriteError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLWantWriteError</span></span><a class=\"headerlink\" href=\"#ssl.SSLWantWriteError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised by a <a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking SSL socket</span></a> when trying to read or write data, but more data needs\nto be sent on the underlying TCP transport before the request can be\nfulfilled.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSyscallError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLSyscallError</span></span><a class=\"headerlink\" href=\"#ssl.SSLSyscallError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised when a system error was encountered\nwhile trying to fulfill an operation on a SSL socket.  Unfortunately,\nthere is no easy way to inspect the original errno number.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLEOFError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLEOFError</span></span><a class=\"headerlink\" href=\"#ssl.SSLEOFError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised when the SSL connection has been\nterminated abruptly.  Generally, you shouldn’t try to reuse the underlying\ntransport when this error is encountered.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLCertVerificationError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLCertVerificationError</span></span><a class=\"headerlink\" href=\"#ssl.SSLCertVerificationError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A subclass of <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> raised when certificate validation has\nfailed.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLCertVerificationError.verify_code\">\n<span class=\"sig-name descname\"><span class=\"pre\">verify_code</span></span><a class=\"headerlink\" href=\"#ssl.SSLCertVerificationError.verify_code\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A numeric error number that denotes the verification error.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLCertVerificationError.verify_message\">\n<span class=\"sig-name descname\"><span class=\"pre\">verify_message</span></span><a class=\"headerlink\" href=\"#ssl.SSLCertVerificationError.verify_message\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A human readable string of the verification error.</p>\n</dd></dl>\n\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"ssl.CertificateError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CertificateError</span></span><a class=\"headerlink\" href=\"#ssl.CertificateError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>An alias for <a class=\"reference internal\" href=\"#ssl.SSLCertVerificationError\" title=\"ssl.SSLCertVerificationError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLCertVerificationError</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>The exception is now an alias for <a class=\"reference internal\" href=\"#ssl.SSLCertVerificationError\" title=\"ssl.SSLCertVerificationError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLCertVerificationError</span></code></a>.</p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"random-generation\">\n<h3>Random generation<a class=\"headerlink\" href=\"#random-generation\" title=\"Link to this heading\">¶</a></h3>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.RAND_bytes\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">RAND_bytes</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">num</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.RAND_bytes\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return <em>num</em> cryptographically strong pseudo-random bytes. Raises an\n<a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> if the PRNG has not been seeded with enough data or if the\noperation is not supported by the current RAND method. <a class=\"reference internal\" href=\"#ssl.RAND_status\" title=\"ssl.RAND_status\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">RAND_status()</span></code></a>\ncan be used to check the status of the PRNG and <a class=\"reference internal\" href=\"#ssl.RAND_add\" title=\"ssl.RAND_add\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">RAND_add()</span></code></a> can be used\nto seed the PRNG.</p>\n<p>For almost all applications <a class=\"reference internal\" href=\"os.html#os.urandom\" title=\"os.urandom\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">os.urandom()</span></code></a> is preferable.</p>\n<p>Read the Wikipedia article, <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator\">Cryptographically secure pseudorandom number\ngenerator (CSPRNG)</a>,\nto get the requirements of a cryptographically strong generator.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.RAND_status\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">RAND_status</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.RAND_status\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> if the SSL pseudo-random number generator has been seeded\nwith ‘enough’ randomness, and <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code> otherwise.  You can use\n<code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">ssl.RAND_egd()</span></code> and <a class=\"reference internal\" href=\"#ssl.RAND_add\" title=\"ssl.RAND_add\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">ssl.RAND_add()</span></code></a> to increase the randomness of\nthe pseudo-random number generator.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.RAND_add\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">RAND_add</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">bytes</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">entropy</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.RAND_add\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Mix the given <em>bytes</em> into the SSL pseudo-random number generator.  The\nparameter <em>entropy</em> (a float) is a lower bound on the entropy contained in\nstring (so you can always use <code class=\"docutils literal notranslate\"><span class=\"pre\">0.0</span></code>).  See <span class=\"target\" id=\"index-7\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc1750.html\"><strong>RFC 1750</strong></a> for more\ninformation on sources of entropy.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>Writable <a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a> is now accepted.</p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"certificate-handling\">\n<h3>Certificate handling<a class=\"headerlink\" href=\"#certificate-handling\" title=\"Link to this heading\">¶</a></h3>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.cert_time_to_seconds\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">cert_time_to_seconds</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cert_time</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.cert_time_to_seconds\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the time in seconds since the Epoch, given the <code class=\"docutils literal notranslate\"><span class=\"pre\">cert_time</span></code>\nstring representing the “notBefore” or “notAfter” date from a\ncertificate in <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;%b</span> <span class=\"pre\">%d</span> <span class=\"pre\">%H:%M:%S</span> <span class=\"pre\">%Y</span> <span class=\"pre\">%Z&quot;</span></code> strptime format (C\nlocale).</p>\n<p>Here’s an example:</p>\n<div class=\"highlight-pycon notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">ssl</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">timestamp</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">cert_time_to_seconds</span><span class=\"p\">(</span><span class=\"s2\">&quot;Jan  5 09:34:43 2018 GMT&quot;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">timestamp</span>\n<span class=\"go\">1515144883</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">datetime</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">datetime</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">datetime</span><span class=\"o\">.</span><span class=\"n\">utcfromtimestamp</span><span class=\"p\">(</span><span class=\"n\">timestamp</span><span class=\"p\">))</span>\n<span class=\"go\">2018-01-05 09:34:43</span>\n</pre></div>\n</div>\n<p>“notBefore” or “notAfter” dates must use GMT (<span class=\"target\" id=\"index-8\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5280.html\"><strong>RFC 5280</strong></a>).</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>Interpret the input time as a time in UTC as specified by ‘GMT’\ntimezone in the input string. Local timezone was used\npreviously. Return an integer (no fractions of a second in the\ninput format)</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.get_server_certificate\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_server_certificate</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">addr</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ssl_version=PROTOCOL_TLS_CLIENT</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ca_certs=None</span></span></em><span class=\"optional\">[</span>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">timeout</span></span></em><span class=\"optional\">]</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.get_server_certificate\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Given the address <code class=\"docutils literal notranslate\"><span class=\"pre\">addr</span></code> of an SSL-protected server, as a (<em>hostname</em>,\n<em>port-number</em>) pair, fetches the server’s certificate, and returns it as a\nPEM-encoded string.  If <code class=\"docutils literal notranslate\"><span class=\"pre\">ssl_version</span></code> is specified, uses that version of\nthe SSL protocol to attempt to connect to the server.  If <em>ca_certs</em> is\nspecified, it should be a file containing a list of root certificates, the\nsame format as used for the <em>cafile</em> parameter in\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"ssl.SSLContext.load_verify_locations\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_verify_locations()</span></code></a>.  The call will attempt to validate the\nserver certificate against that set of root certificates, and will fail\nif the validation attempt fails.  A timeout can be specified with the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">timeout</span></code> parameter.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.3: </span>This function is now IPv6-compatible.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The default <em>ssl_version</em> is changed from <a class=\"reference internal\" href=\"#ssl.PROTOCOL_SSLv3\" title=\"ssl.PROTOCOL_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_SSLv3</span></code></a> to\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a> for maximum compatibility with modern servers.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span>The <em>timeout</em> parameter was added.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.DER_cert_to_PEM_cert\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">DER_cert_to_PEM_cert</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">der_cert_bytes</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.DER_cert_to_PEM_cert\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Given a certificate as a DER-encoded blob of bytes, returns a PEM-encoded\nstring version of the same certificate.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.PEM_cert_to_DER_cert\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PEM_cert_to_DER_cert</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">pem_cert_string</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.PEM_cert_to_DER_cert\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Given a certificate as an ASCII PEM string, returns a DER-encoded sequence of\nbytes for that same certificate.</p>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.get_default_verify_paths\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_default_verify_paths</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.get_default_verify_paths\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns a named tuple with paths to OpenSSL’s default cafile and capath.\nThe paths are the same as used by\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_default_verify_paths\" title=\"ssl.SSLContext.set_default_verify_paths\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_default_verify_paths()</span></code></a>. The return value is a\n<a class=\"reference internal\" href=\"../glossary.html#term-named-tuple\"><span class=\"xref std std-term\">named tuple</span></a> <code class=\"docutils literal notranslate\"><span class=\"pre\">DefaultVerifyPaths</span></code>:</p>\n<ul class=\"simple\">\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">cafile</span></code> - resolved path to cafile or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> if the file doesn’t exist,</p></li>\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">capath</span></code> - resolved path to capath or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> if the directory doesn’t exist,</p></li>\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">openssl_cafile_env</span></code> - OpenSSL’s environment key that points to a cafile,</p></li>\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">openssl_cafile</span></code> - hard coded path to a cafile,</p></li>\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">openssl_capath_env</span></code> - OpenSSL’s environment key that points to a capath,</p></li>\n<li><p><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">openssl_capath</span></code> - hard coded path to a capath directory</p></li>\n</ul>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.enum_certificates\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">enum_certificates</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">store_name</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.enum_certificates\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Retrieve certificates from Windows’ system cert store. <em>store_name</em> may be\none of <code class=\"docutils literal notranslate\"><span class=\"pre\">CA</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">ROOT</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">MY</span></code>. Windows may provide additional cert\nstores, too.</p>\n<p>The function returns a list of (cert_bytes, encoding_type, trust) tuples.\nThe encoding_type specifies the encoding of cert_bytes. It is either\n<code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">x509_asn</span></code> for X.509 ASN.1 data or <code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">pkcs_7_asn</span></code> for\nPKCS#7 ASN.1 data. Trust specifies the purpose of the certificate as a set\nof OIDS or exactly <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> if the certificate is trustworthy for all\npurposes.</p>\n<p>Example:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">enum_certificates</span><span class=\"p\">(</span><span class=\"s2\">&quot;CA&quot;</span><span class=\"p\">)</span>\n<span class=\"go\">[(b&#39;data...&#39;, &#39;x509_asn&#39;, {&#39;1.3.6.1.5.5.7.3.1&#39;, &#39;1.3.6.1.5.5.7.3.2&#39;}),</span>\n<span class=\"go\"> (b&#39;data...&#39;, &#39;x509_asn&#39;, True)]</span>\n</pre></div>\n</div>\n<div class=\"availability docutils container\">\n<p><a class=\"reference internal\" href=\"intro.html#availability\"><span class=\"std std-ref\">Availability</span></a>: Windows.</p>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"ssl.enum_crls\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">enum_crls</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">store_name</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.enum_crls\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Retrieve CRLs from Windows’ system cert store. <em>store_name</em> may be\none of <code class=\"docutils literal notranslate\"><span class=\"pre\">CA</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">ROOT</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">MY</span></code>. Windows may provide additional cert\nstores, too.</p>\n<p>The function returns a list of (cert_bytes, encoding_type, trust) tuples.\nThe encoding_type specifies the encoding of cert_bytes. It is either\n<code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">x509_asn</span></code> for X.509 ASN.1 data or <code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">pkcs_7_asn</span></code> for\nPKCS#7 ASN.1 data.</p>\n<div class=\"availability docutils container\">\n<p><a class=\"reference internal\" href=\"intro.html#availability\"><span class=\"std std-ref\">Availability</span></a>: Windows.</p>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"constants\">\n<h3>Constants<a class=\"headerlink\" href=\"#constants\" title=\"Link to this heading\">¶</a></h3>\n<blockquote>\n<div><p>All constants are now <a class=\"reference internal\" href=\"enum.html#enum.IntEnum\" title=\"enum.IntEnum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntEnum</span></code></a> or <a class=\"reference internal\" href=\"enum.html#enum.IntFlag\" title=\"enum.IntFlag\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntFlag</span></code></a> collections.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</div></blockquote>\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.CERT_NONE\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CERT_NONE</span></span><a class=\"headerlink\" href=\"#ssl.CERT_NONE\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_mode</span></code></a>.\nExcept for <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a>,\nit is the default mode.  With client-side sockets, just about any\ncert is accepted.  Validation errors, such as untrusted or expired cert,\nare ignored and do not abort the TLS/SSL handshake.</p>\n<p>In server mode, no certificate is requested from the client, so the client\ndoes not send any for client cert authentication.</p>\n<p>See the discussion of <a class=\"reference internal\" href=\"#ssl-security\"><span class=\"std std-ref\">Security considerations</span></a> below.</p>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.CERT_OPTIONAL\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CERT_OPTIONAL</span></span><a class=\"headerlink\" href=\"#ssl.CERT_OPTIONAL\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_mode</span></code></a>.\nIn client mode, <a class=\"reference internal\" href=\"#ssl.CERT_OPTIONAL\" title=\"ssl.CERT_OPTIONAL\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_OPTIONAL</span></code></a>\nhas the same meaning as <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>. It is recommended to\nuse <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a> for client-side sockets instead.</p>\n<p>In server mode, a client certificate request is sent to the client.  The\nclient may either ignore the request or send a certificate in order\nperform TLS client cert authentication.  If the client chooses to send\na certificate, it is verified.  Any verification error immediately aborts\nthe TLS handshake.</p>\n<p>Use of this setting requires a valid set of CA certificates to\nbe passed to <a class=\"reference internal\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"ssl.SSLContext.load_verify_locations\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_verify_locations()</span></code></a>.</p>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.CERT_REQUIRED\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CERT_REQUIRED</span></span><a class=\"headerlink\" href=\"#ssl.CERT_REQUIRED\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_mode</span></code></a>.\nIn this mode, certificates are\nrequired from the other side of the socket connection; an <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a>\nwill be raised if no certificate is provided, or if its validation fails.\nThis mode is <strong>not</strong> sufficient to verify a certificate in client mode as\nit does not match hostnames.  <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> must be\nenabled as well to verify the authenticity of a cert.\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> uses <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a> and\nenables <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> by default.</p>\n<p>With server socket, this mode provides mandatory TLS client cert\nauthentication.  A client certificate request is sent to the client and\nthe client must provide a valid and trusted certificate.</p>\n<p>Use of this setting requires a valid set of CA certificates to\nbe passed to <a class=\"reference internal\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"ssl.SSLContext.load_verify_locations\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_verify_locations()</span></code></a>.</p>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.VerifyMode\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VerifyMode</span></span><a class=\"headerlink\" href=\"#ssl.VerifyMode\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntEnum\" title=\"enum.IntEnum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntEnum</span></code></a> collection of CERT_* constants.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_DEFAULT\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_DEFAULT</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_DEFAULT\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>. In this mode, certificate\nrevocation lists (CRLs) are not checked. By default OpenSSL does neither\nrequire nor verify CRLs.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_CRL_CHECK_LEAF\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_CRL_CHECK_LEAF</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_CRL_CHECK_LEAF\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>. In this mode, only the\npeer cert is checked but none of the intermediate CA certificates. The mode\nrequires a valid CRL that is signed by the peer cert’s issuer (its direct\nancestor CA). If no proper CRL has been loaded with\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"ssl.SSLContext.load_verify_locations\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.load_verify_locations</span></code></a>, validation will fail.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_CRL_CHECK_CHAIN\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_CRL_CHECK_CHAIN</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_CRL_CHECK_CHAIN\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>. In this mode, CRLs of\nall certificates in the peer cert chain are checked.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_X509_STRICT\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_X509_STRICT</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_X509_STRICT\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a> to disable workarounds\nfor broken X.509 certificates.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_ALLOW_PROXY_CERTS\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_ALLOW_PROXY_CERTS</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_ALLOW_PROXY_CERTS\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a> to enables proxy\ncertificate verification.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.10.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_X509_TRUSTED_FIRST\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_X509_TRUSTED_FIRST</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_X509_TRUSTED_FIRST\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>. It instructs OpenSSL to\nprefer trusted certificates when building the trust chain to validate a\ncertificate. This flag is enabled by default.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.VERIFY_X509_PARTIAL_CHAIN\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VERIFY_X509_PARTIAL_CHAIN</span></span><a class=\"headerlink\" href=\"#ssl.VERIFY_X509_PARTIAL_CHAIN\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Possible value for <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>. It instructs OpenSSL to\naccept intermediate CAs in the trust store to be treated as trust-anchors,\nin the same way as the self-signed root CA certificates. This makes it\npossible to trust certificates issued by an intermediate CA without having\nto trust its ancestor root CA.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.10.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.VerifyFlags\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">VerifyFlags</span></span><a class=\"headerlink\" href=\"#ssl.VerifyFlags\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntFlag\" title=\"enum.IntFlag\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntFlag</span></code></a> collection of VERIFY_* constants.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLS\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLS</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLS\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Selects the highest protocol version that both the client and server support.\nDespite the name, this option can select both “SSL” and “TLS” protocols.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.10: </span>TLS clients and servers require different default settings for secure\ncommunication. The generic TLS protocol constant is deprecated in\nfavor of <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> and <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLS_CLIENT\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Auto-negotiate the highest protocol version that both the client and\nserver support, and configure the context client-side connections. The\nprotocol enables <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> by default.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLS_SERVER\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Auto-negotiate the highest protocol version that both the client and\nserver support, and configure the context server-side connections.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_SSLv23\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_SSLv23</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_SSLv23\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Alias for <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>.</p>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>Use <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a> instead.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_SSLv3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_SSLv3</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_SSLv3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Selects SSL version 3 as the channel encryption protocol.</p>\n<p>This protocol is not available if OpenSSL is compiled with the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">no-ssl3</span></code> option.</p>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>SSL version 3 is insecure.  Its use is highly discouraged.</p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>OpenSSL has deprecated all version specific protocols. Use the default\nprotocol <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> or <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a>\nwith <a class=\"reference internal\" href=\"#ssl.SSLContext.minimum_version\" title=\"ssl.SSLContext.minimum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.minimum_version</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.maximum_version</span></code></a> instead.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLSv1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLSv1</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLSv1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Selects TLS version 1.0 as the channel encryption protocol.</p>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>OpenSSL has deprecated all version specific protocols.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLSv1_1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLSv1_1</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLSv1_1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Selects TLS version 1.1 as the channel encryption protocol.\nAvailable only with openssl version 1.0.1+.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>OpenSSL has deprecated all version specific protocols.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.PROTOCOL_TLSv1_2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PROTOCOL_TLSv1_2</span></span><a class=\"headerlink\" href=\"#ssl.PROTOCOL_TLSv1_2\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Selects TLS version 1.2 as the channel encryption protocol.\nAvailable only with openssl version 1.0.1+.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>OpenSSL has deprecated all version specific protocols.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_ALL\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_ALL</span></span><a class=\"headerlink\" href=\"#ssl.OP_ALL\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enables workarounds for various bugs present in other SSL implementations.\nThis option is set by default.  It does not necessarily set the same\nflags as OpenSSL’s <code class=\"docutils literal notranslate\"><span class=\"pre\">SSL_OP_ALL</span></code> constant.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_SSLv2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_SSLv2</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_SSLv2\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents an SSLv2 connection.  This option is only applicable in\nconjunction with <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>.  It prevents the peers from\nchoosing SSLv2 as the protocol version.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>SSLv2 is deprecated</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_SSLv3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_SSLv3</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_SSLv3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents an SSLv3 connection.  This option is only applicable in\nconjunction with <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>.  It prevents the peers from\nchoosing SSLv3 as the protocol version.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>SSLv3 is deprecated</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_TLSv1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_TLSv1</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_TLSv1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents a TLSv1 connection.  This option is only applicable in\nconjunction with <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>.  It prevents the peers from\nchoosing TLSv1 as the protocol version.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.7: </span>The option is deprecated since OpenSSL 1.1.0, use the new\n<a class=\"reference internal\" href=\"#ssl.SSLContext.minimum_version\" title=\"ssl.SSLContext.minimum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.minimum_version</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.maximum_version</span></code></a> instead.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_TLSv1_1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_TLSv1_1</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_TLSv1_1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents a TLSv1.1 connection. This option is only applicable in conjunction\nwith <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>. It prevents the peers from choosing TLSv1.1 as\nthe protocol version. Available only with openssl version 1.0.1+.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.7: </span>The option is deprecated since OpenSSL 1.1.0.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_TLSv1_2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_TLSv1_2</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_TLSv1_2\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents a TLSv1.2 connection. This option is only applicable in conjunction\nwith <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>. It prevents the peers from choosing TLSv1.2 as\nthe protocol version. Available only with openssl version 1.0.1+.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.7: </span>The option is deprecated since OpenSSL 1.1.0.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_TLSv1_3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_TLSv1_3</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_TLSv1_3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents a TLSv1.3 connection. This option is only applicable in conjunction\nwith <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>. It prevents the peers from choosing TLSv1.3 as\nthe protocol version. TLS 1.3 is available with OpenSSL 1.1.1 or later.\nWhen Python has been compiled against an older version of OpenSSL, the\nflag defaults to <em>0</em>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.3.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.7: </span>The option is deprecated since OpenSSL 1.1.0. It was added to 2.7.15 and\n3.6.3 for backwards compatibility with OpenSSL 1.0.2.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_RENEGOTIATION\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_RENEGOTIATION</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_RENEGOTIATION\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Disable all renegotiation in TLSv1.2 and earlier. Do not send\nHelloRequest messages, and ignore renegotiation requests via ClientHello.</p>\n<p>This option is only available with OpenSSL 1.1.0h and later.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_CIPHER_SERVER_PREFERENCE\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_CIPHER_SERVER_PREFERENCE</span></span><a class=\"headerlink\" href=\"#ssl.OP_CIPHER_SERVER_PREFERENCE\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Use the server’s cipher ordering preference, rather than the client’s.\nThis option has no effect on client sockets and SSLv2 server sockets.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_SINGLE_DH_USE\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_SINGLE_DH_USE</span></span><a class=\"headerlink\" href=\"#ssl.OP_SINGLE_DH_USE\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents reuse of the same DH key for distinct SSL sessions.  This\nimproves forward secrecy but requires more computational resources.\nThis option only applies to server sockets.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_SINGLE_ECDH_USE\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_SINGLE_ECDH_USE</span></span><a class=\"headerlink\" href=\"#ssl.OP_SINGLE_ECDH_USE\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevents reuse of the same ECDH key for distinct SSL sessions.  This\nimproves forward secrecy but requires more computational resources.\nThis option only applies to server sockets.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_ENABLE_MIDDLEBOX_COMPAT\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_ENABLE_MIDDLEBOX_COMPAT</span></span><a class=\"headerlink\" href=\"#ssl.OP_ENABLE_MIDDLEBOX_COMPAT\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Send dummy Change Cipher Spec (CCS) messages in TLS 1.3 handshake to make\na TLS 1.3 connection look more like a TLS 1.2 connection.</p>\n<p>This option is only available with OpenSSL 1.1.1 and later.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_COMPRESSION\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_COMPRESSION</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_COMPRESSION\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Disable compression on the SSL channel.  This is useful if the application\nprotocol supports its own compression scheme.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.Options\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">Options</span></span><a class=\"headerlink\" href=\"#ssl.Options\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntFlag\" title=\"enum.IntFlag\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntFlag</span></code></a> collection of OP_* constants.</p>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_NO_TICKET\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_NO_TICKET</span></span><a class=\"headerlink\" href=\"#ssl.OP_NO_TICKET\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Prevent client side from requesting a session ticket.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_IGNORE_UNEXPECTED_EOF\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_IGNORE_UNEXPECTED_EOF</span></span><a class=\"headerlink\" href=\"#ssl.OP_IGNORE_UNEXPECTED_EOF\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Ignore unexpected shutdown of TLS connections.</p>\n<p>This option is only available with OpenSSL 3.0.0 and later.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.10.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_ENABLE_KTLS\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_ENABLE_KTLS</span></span><a class=\"headerlink\" href=\"#ssl.OP_ENABLE_KTLS\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enable the use of the kernel TLS. To benefit from the feature, OpenSSL must\nhave been compiled with support for it, and the negotiated cipher suites and\nextensions must be supported by it (a list of supported ones may vary by\nplatform and kernel version).</p>\n<p>Note that with enabled kernel TLS some cryptographic operations are\nperformed by the kernel directly and not via any available OpenSSL\nProviders. This might be undesirable if, for example, the application\nrequires all cryptographic operations to be performed by the FIPS provider.</p>\n<p>This option is only available with OpenSSL 3.0.0 and later.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.12.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OP_LEGACY_SERVER_CONNECT\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OP_LEGACY_SERVER_CONNECT</span></span><a class=\"headerlink\" href=\"#ssl.OP_LEGACY_SERVER_CONNECT\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Allow legacy insecure renegotiation between OpenSSL and unpatched servers\nonly.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.12.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_ALPN\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_ALPN</span></span><a class=\"headerlink\" href=\"#ssl.HAS_ALPN\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the <em>Application-Layer\nProtocol Negotiation</em> TLS extension as described in <span class=\"target\" id=\"index-9\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc7301.html\"><strong>RFC 7301</strong></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_NEVER_CHECK_COMMON_NAME\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_NEVER_CHECK_COMMON_NAME</span></span><a class=\"headerlink\" href=\"#ssl.HAS_NEVER_CHECK_COMMON_NAME\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support not checking subject\ncommon name and <a class=\"reference internal\" href=\"#ssl.SSLContext.hostname_checks_common_name\" title=\"ssl.SSLContext.hostname_checks_common_name\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.hostname_checks_common_name</span></code></a> is\nwriteable.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_ECDH\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_ECDH</span></span><a class=\"headerlink\" href=\"#ssl.HAS_ECDH\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the Elliptic Curve-based\nDiffie-Hellman key exchange.  This should be true unless the feature was\nexplicitly disabled by the distributor.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_SNI\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_SNI</span></span><a class=\"headerlink\" href=\"#ssl.HAS_SNI\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the <em>Server Name\nIndication</em> extension (as defined in <span class=\"target\" id=\"index-10\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc6066.html\"><strong>RFC 6066</strong></a>).</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_NPN\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_NPN</span></span><a class=\"headerlink\" href=\"#ssl.HAS_NPN\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the <em>Next Protocol\nNegotiation</em> as described in the <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Application-Layer_Protocol_Negotiation\">Application Layer Protocol\nNegotiation</a>.\nWhen true, you can use the <a class=\"reference internal\" href=\"#ssl.SSLContext.set_npn_protocols\" title=\"ssl.SSLContext.set_npn_protocols\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_npn_protocols()</span></code></a> method to advertise\nwhich protocols you want to support.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_SSLv2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_SSLv2</span></span><a class=\"headerlink\" href=\"#ssl.HAS_SSLv2\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the SSL 2.0 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_SSLv3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_SSLv3</span></span><a class=\"headerlink\" href=\"#ssl.HAS_SSLv3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the SSL 3.0 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_TLSv1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_TLSv1</span></span><a class=\"headerlink\" href=\"#ssl.HAS_TLSv1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the TLS 1.0 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_TLSv1_1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_TLSv1_1</span></span><a class=\"headerlink\" href=\"#ssl.HAS_TLSv1_1\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the TLS 1.1 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_TLSv1_2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_TLSv1_2</span></span><a class=\"headerlink\" href=\"#ssl.HAS_TLSv1_2\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the TLS 1.2 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_TLSv1_3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_TLSv1_3</span></span><a class=\"headerlink\" href=\"#ssl.HAS_TLSv1_3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for the TLS 1.3 protocol.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_PSK\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_PSK</span></span><a class=\"headerlink\" href=\"#ssl.HAS_PSK\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for TLS-PSK.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.13.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.HAS_PHA\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HAS_PHA</span></span><a class=\"headerlink\" href=\"#ssl.HAS_PHA\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether the OpenSSL library has built-in support for TLS-PHA.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.14.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.CHANNEL_BINDING_TYPES\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CHANNEL_BINDING_TYPES</span></span><a class=\"headerlink\" href=\"#ssl.CHANNEL_BINDING_TYPES\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>List of supported TLS channel binding types.  Strings in this list\ncan be used as arguments to <a class=\"reference internal\" href=\"#ssl.SSLSocket.get_channel_binding\" title=\"ssl.SSLSocket.get_channel_binding\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.get_channel_binding()</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OPENSSL_VERSION\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OPENSSL_VERSION</span></span><a class=\"headerlink\" href=\"#ssl.OPENSSL_VERSION\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The version string of the OpenSSL library loaded by the interpreter:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">OPENSSL_VERSION</span>\n<span class=\"go\">&#39;OpenSSL 1.0.2k  26 Jan 2017&#39;</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OPENSSL_VERSION_INFO\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OPENSSL_VERSION_INFO</span></span><a class=\"headerlink\" href=\"#ssl.OPENSSL_VERSION_INFO\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A tuple of five integers representing version information about the\nOpenSSL library:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">OPENSSL_VERSION_INFO</span>\n<span class=\"go\">(1, 0, 2, 11, 15)</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.OPENSSL_VERSION_NUMBER\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">OPENSSL_VERSION_NUMBER</span></span><a class=\"headerlink\" href=\"#ssl.OPENSSL_VERSION_NUMBER\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The raw version number of the OpenSSL library, as a single integer:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">OPENSSL_VERSION_NUMBER</span>\n<span class=\"go\">268443839</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"nb\">hex</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">OPENSSL_VERSION_NUMBER</span><span class=\"p\">)</span>\n<span class=\"go\">&#39;0x100020bf&#39;</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.ALERT_DESCRIPTION_HANDSHAKE_FAILURE\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">ALERT_DESCRIPTION_HANDSHAKE_FAILURE</span></span><a class=\"headerlink\" href=\"#ssl.ALERT_DESCRIPTION_HANDSHAKE_FAILURE\" title=\"Link to this definition\">¶</a></dt>\n<dt class=\"sig sig-object py\" id=\"ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">ALERT_DESCRIPTION_INTERNAL_ERROR</span></span><a class=\"headerlink\" href=\"#ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\" title=\"Link to this definition\">¶</a></dt>\n<dt class=\"sig sig-object py\">\n<span class=\"sig-name descname\"><span class=\"pre\">ALERT_DESCRIPTION_*</span></span></dt>\n<dd><p>Alert Descriptions from <span class=\"target\" id=\"index-11\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5246.html\"><strong>RFC 5246</strong></a> and others. The <a class=\"reference external\" href=\"https://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-6\">IANA TLS Alert Registry</a>\ncontains this list and references to the RFCs where their meaning is defined.</p>\n<p>Used as the return value of the callback function in\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_servername_callback\" title=\"ssl.SSLContext.set_servername_callback\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_servername_callback()</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.AlertDescription\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">AlertDescription</span></span><a class=\"headerlink\" href=\"#ssl.AlertDescription\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntEnum\" title=\"enum.IntEnum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntEnum</span></code></a> collection of ALERT_DESCRIPTION_* constants.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.Purpose.SERVER_AUTH\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">Purpose.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SERVER_AUTH</span></span><a class=\"headerlink\" href=\"#ssl.Purpose.SERVER_AUTH\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Option for <a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_default_certs\" title=\"ssl.SSLContext.load_default_certs\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_default_certs()</span></code></a>.  This value indicates that the\ncontext may be used to authenticate web servers (therefore, it will\nbe used to create client-side sockets).</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"ssl.Purpose.CLIENT_AUTH\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">Purpose.</span></span><span class=\"sig-name descname\"><span class=\"pre\">CLIENT_AUTH</span></span><a class=\"headerlink\" href=\"#ssl.Purpose.CLIENT_AUTH\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Option for <a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_default_certs\" title=\"ssl.SSLContext.load_default_certs\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_default_certs()</span></code></a>.  This value indicates that the\ncontext may be used to authenticate web clients (therefore, it will\nbe used to create server-side sockets).</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLErrorNumber\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLErrorNumber</span></span><a class=\"headerlink\" href=\"#ssl.SSLErrorNumber\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntEnum\" title=\"enum.IntEnum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntEnum</span></code></a> collection of SSL_ERROR_* constants.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">TLSVersion</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion\" title=\"Link to this definition\">¶</a></dt>\n<dd><p><a class=\"reference internal\" href=\"enum.html#enum.IntEnum\" title=\"enum.IntEnum\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">enum.IntEnum</span></code></a> collection of SSL and TLS versions for\n<a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.maximum_version</span></code></a> and <a class=\"reference internal\" href=\"#ssl.SSLContext.minimum_version\" title=\"ssl.SSLContext.minimum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.minimum_version</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.MINIMUM_SUPPORTED\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">MINIMUM_SUPPORTED</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.MINIMUM_SUPPORTED\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.MAXIMUM_SUPPORTED\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">MAXIMUM_SUPPORTED</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.MAXIMUM_SUPPORTED\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The minimum or maximum supported SSL or TLS version. These are magic\nconstants. Their values don’t reflect the lowest and highest available\nTLS/SSL versions.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.SSLv3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLv3</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.SSLv3\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.TLSv1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">TLSv1</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.TLSv1\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.TLSv1_1\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">TLSv1_1</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.TLSv1_1\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.TLSv1_2\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">TLSv1_2</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.TLSv1_2\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.TLSVersion.TLSv1_3\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">TLSVersion.</span></span><span class=\"sig-name descname\"><span class=\"pre\">TLSv1_3</span></span><a class=\"headerlink\" href=\"#ssl.TLSVersion.TLSv1_3\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>SSL 3.0 to TLS 1.3.</p>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.10: </span>All <a class=\"reference internal\" href=\"#ssl.TLSVersion\" title=\"ssl.TLSVersion\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">TLSVersion</span></code></a> members except <a class=\"reference internal\" href=\"#ssl.TLSVersion.TLSv1_2\" title=\"ssl.TLSVersion.TLSv1_2\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">TLSVersion.TLSv1_2</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.TLSVersion.TLSv1_3\" title=\"ssl.TLSVersion.TLSv1_3\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">TLSVersion.TLSv1_3</span></code></a> are deprecated.</p>\n</div>\n</dd></dl>\n\n</section>\n</section>\n<section id=\"ssl-sockets\">\n<h2>SSL Sockets<a class=\"headerlink\" href=\"#ssl-sockets\" title=\"Link to this heading\">¶</a></h2>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLSocket</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">socket.socket</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>SSL sockets provide the following methods of <a class=\"reference internal\" href=\"socket.html#socket-objects\"><span class=\"std std-ref\">Socket Objects</span></a>:</p>\n<ul class=\"simple\">\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.accept\" title=\"socket.socket.accept\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">accept()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.bind\" title=\"socket.socket.bind\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">bind()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.close\" title=\"socket.socket.close\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">close()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.connect\" title=\"socket.socket.connect\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">connect()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.detach\" title=\"socket.socket.detach\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">detach()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.fileno\" title=\"socket.socket.fileno\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">fileno()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.getpeername\" title=\"socket.socket.getpeername\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getpeername()</span></code></a>, <a class=\"reference internal\" href=\"socket.html#socket.socket.getsockname\" title=\"socket.socket.getsockname\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getsockname()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.getsockopt\" title=\"socket.socket.getsockopt\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getsockopt()</span></code></a>, <a class=\"reference internal\" href=\"socket.html#socket.socket.setsockopt\" title=\"socket.socket.setsockopt\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">setsockopt()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.gettimeout\" title=\"socket.socket.gettimeout\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">gettimeout()</span></code></a>, <a class=\"reference internal\" href=\"socket.html#socket.socket.settimeout\" title=\"socket.socket.settimeout\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">settimeout()</span></code></a>,\n<a class=\"reference internal\" href=\"socket.html#socket.socket.setblocking\" title=\"socket.socket.setblocking\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">setblocking()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.listen\" title=\"socket.socket.listen\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">listen()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.makefile\" title=\"socket.socket.makefile\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">makefile()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.recv\" title=\"socket.socket.recv\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">recv()</span></code></a>, <a class=\"reference internal\" href=\"socket.html#socket.socket.recv_into\" title=\"socket.socket.recv_into\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">recv_into()</span></code></a>\n(but passing a non-zero <code class=\"docutils literal notranslate\"><span class=\"pre\">flags</span></code> argument is not allowed)</p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.send\" title=\"socket.socket.send\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">send()</span></code></a>, <a class=\"reference internal\" href=\"socket.html#socket.socket.sendall\" title=\"socket.socket.sendall\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">sendall()</span></code></a> (with\nthe same limitation)</p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.sendfile\" title=\"socket.socket.sendfile\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">sendfile()</span></code></a> (but <a class=\"reference internal\" href=\"os.html#os.sendfile\" title=\"os.sendfile\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">os.sendfile</span></code></a> will be used\nfor plain-text sockets only, else <a class=\"reference internal\" href=\"socket.html#socket.socket.send\" title=\"socket.socket.send\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">send()</span></code></a> will be used)</p></li>\n<li><p><a class=\"reference internal\" href=\"socket.html#socket.socket.shutdown\" title=\"socket.socket.shutdown\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">shutdown()</span></code></a></p></li>\n</ul>\n<p>However, since the SSL (and TLS) protocol has its own framing atop\nof TCP, the SSL sockets abstraction can, in certain respects, diverge from\nthe specification of normal, OS-level sockets.  See especially the\n<a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">notes on non-blocking sockets</span></a>.</p>\n<p>Instances of <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> must be created using the\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a> method.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">sendfile()</span></code> method was added.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">shutdown()</span></code> does not reset the socket timeout each time bytes\nare received or sent. The socket timeout is now the maximum total duration\nof the shutdown.</p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>It is deprecated to create a <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> instance directly, use\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a> to wrap a socket.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span><a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> instances must to created with\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">wrap_socket()</span></code></a>. In earlier versions, it was possible\nto create instances directly. This was never documented or officially\nsupported.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span>Python now uses <code class=\"docutils literal notranslate\"><span class=\"pre\">SSL_read_ex</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">SSL_write_ex</span></code> internally. The\nfunctions support reading and writing of data larger than 2 GB. Writing\nzero-length data no longer fails with a protocol violation error.</p>\n</div>\n</dd></dl>\n\n<p>SSL sockets also have the following additional methods and attributes:</p>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.read\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">read</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">len</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">1024</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffer</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.read\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Read up to <em>len</em> bytes of data from the SSL socket and return the result as\na <code class=\"docutils literal notranslate\"><span class=\"pre\">bytes</span></code> instance. If <em>buffer</em> is specified, then read into the buffer\ninstead, and return the number of bytes read.</p>\n<p>Raise <a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> or <a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a> if the socket is\n<a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking</span></a> and the read would block.</p>\n<p>As at any time a re-negotiation is possible, a call to <a class=\"reference internal\" href=\"#ssl.SSLSocket.read\" title=\"ssl.SSLSocket.read\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">read()</span></code></a> can also\ncause write operations.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The socket timeout is no longer reset each time bytes are received or sent.\nThe socket timeout is now the maximum total duration to read up to <em>len</em>\nbytes.</p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>Use <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">recv()</span></code> instead of <a class=\"reference internal\" href=\"#ssl.SSLSocket.read\" title=\"ssl.SSLSocket.read\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">read()</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.write\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">write</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">data</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.write\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write <em>data</em> to the SSL socket and return the number of bytes written. The\n<em>data</em> argument must be an object supporting the buffer interface.</p>\n<p>Raise <a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> or <a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a> if the socket is\n<a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking</span></a> and the write would block.</p>\n<p>As at any time a re-negotiation is possible, a call to <a class=\"reference internal\" href=\"#ssl.SSLSocket.write\" title=\"ssl.SSLSocket.write\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">write()</span></code></a> can\nalso cause read operations.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The socket timeout is no longer reset each time bytes are received or sent.\nThe socket timeout is now the maximum total duration to write <em>data</em>.</p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.6: </span>Use <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">send()</span></code> instead of <a class=\"reference internal\" href=\"#ssl.SSLSocket.write\" title=\"ssl.SSLSocket.write\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">write()</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>The <a class=\"reference internal\" href=\"#ssl.SSLSocket.read\" title=\"ssl.SSLSocket.read\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">read()</span></code></a> and <a class=\"reference internal\" href=\"#ssl.SSLSocket.write\" title=\"ssl.SSLSocket.write\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">write()</span></code></a> methods are the\nlow-level methods that read and write unencrypted, application-level data\nand decrypt/encrypt it to encrypted, wire-level data. These methods\nrequire an active SSL connection, i.e. the handshake was completed and\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.unwrap\" title=\"ssl.SSLSocket.unwrap\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.unwrap()</span></code></a> was not called.</p>\n<p>Normally you should use the socket API methods like\n<a class=\"reference internal\" href=\"socket.html#socket.socket.recv\" title=\"socket.socket.recv\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">recv()</span></code></a> and <a class=\"reference internal\" href=\"socket.html#socket.socket.send\" title=\"socket.socket.send\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">send()</span></code></a> instead of these\nmethods.</p>\n</div>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.do_handshake\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">do_handshake</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">block</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.do_handshake\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Perform the SSL setup handshake.</p>\n<p>If <em>block</em> is true and the timeout obtained by <a class=\"reference internal\" href=\"socket.html#socket.socket.gettimeout\" title=\"socket.socket.gettimeout\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">gettimeout()</span></code></a>\nis zero, the socket is set in blocking mode until the handshake is performed.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.4: </span>The handshake method also performs <code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">match_hostname()</span></code> when the\n<a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> attribute of the socket’s\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.context\" title=\"ssl.SSLSocket.context\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">context</span></code></a> is true.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>The socket timeout is no longer reset each time bytes are received or sent.\nThe socket timeout is now the maximum total duration of the handshake.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>Hostname or IP address is matched by OpenSSL during handshake. The\nfunction <code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">match_hostname()</span></code> is no longer used. In case OpenSSL\nrefuses a hostname or IP address, the handshake is aborted early and\na TLS alert message is sent to the peer.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.getpeercert\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">getpeercert</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">binary_form</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.getpeercert\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>If there is no certificate for the peer on the other end of the connection,\nreturn <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>.  If the SSL handshake hasn’t been done yet, raise\n<a class=\"reference internal\" href=\"exceptions.html#ValueError\" title=\"ValueError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ValueError</span></code></a>.</p>\n<p>If the <code class=\"docutils literal notranslate\"><span class=\"pre\">binary_form</span></code> parameter is <a class=\"reference internal\" href=\"constants.html#False\" title=\"False\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">False</span></code></a>, and a certificate was\nreceived from the peer, this method returns a <a class=\"reference internal\" href=\"stdtypes.html#dict\" title=\"dict\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">dict</span></code></a> instance.  If the\ncertificate was not validated, the dict is empty.  If the certificate was\nvalidated, it returns a dict with several keys, amongst them <code class=\"docutils literal notranslate\"><span class=\"pre\">subject</span></code>\n(the principal for which the certificate was issued) and <code class=\"docutils literal notranslate\"><span class=\"pre\">issuer</span></code>\n(the principal issuing the certificate).  If a certificate contains an\ninstance of the <em>Subject Alternative Name</em> extension (see <span class=\"target\" id=\"index-12\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc3280.html\"><strong>RFC 3280</strong></a>),\nthere will also be a <code class=\"docutils literal notranslate\"><span class=\"pre\">subjectAltName</span></code> key in the dictionary.</p>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">subject</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">issuer</span></code> fields are tuples containing the sequence\nof relative distinguished names (RDNs) given in the certificate’s data\nstructure for the respective fields, and each RDN is a sequence of\nname-value pairs.  Here is a real-world example:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">{</span><span class=\"s1\">&#39;issuer&#39;</span><span class=\"p\">:</span> <span class=\"p\">(((</span><span class=\"s1\">&#39;countryName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;IL&#39;</span><span class=\"p\">),),</span>\n            <span class=\"p\">((</span><span class=\"s1\">&#39;organizationName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;StartCom Ltd.&#39;</span><span class=\"p\">),),</span>\n            <span class=\"p\">((</span><span class=\"s1\">&#39;organizationalUnitName&#39;</span><span class=\"p\">,</span>\n              <span class=\"s1\">&#39;Secure Digital Certificate Signing&#39;</span><span class=\"p\">),),</span>\n            <span class=\"p\">((</span><span class=\"s1\">&#39;commonName&#39;</span><span class=\"p\">,</span>\n              <span class=\"s1\">&#39;StartCom Class 2 Primary Intermediate Server CA&#39;</span><span class=\"p\">),)),</span>\n <span class=\"s1\">&#39;notAfter&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Nov 22 08:15:19 2013 GMT&#39;</span><span class=\"p\">,</span>\n <span class=\"s1\">&#39;notBefore&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Nov 21 03:09:52 2011 GMT&#39;</span><span class=\"p\">,</span>\n <span class=\"s1\">&#39;serialNumber&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;95F0&#39;</span><span class=\"p\">,</span>\n <span class=\"s1\">&#39;subject&#39;</span><span class=\"p\">:</span> <span class=\"p\">(((</span><span class=\"s1\">&#39;description&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;571208-SLe257oHY9fVQ07Z&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;countryName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;US&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;stateOrProvinceName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;California&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;localityName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;San Francisco&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;organizationName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Electronic Frontier Foundation, Inc.&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;commonName&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;*.eff.org&#39;</span><span class=\"p\">),),</span>\n             <span class=\"p\">((</span><span class=\"s1\">&#39;emailAddress&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;hostmaster@eff.org&#39;</span><span class=\"p\">),)),</span>\n <span class=\"s1\">&#39;subjectAltName&#39;</span><span class=\"p\">:</span> <span class=\"p\">((</span><span class=\"s1\">&#39;DNS&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;*.eff.org&#39;</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"s1\">&#39;DNS&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;eff.org&#39;</span><span class=\"p\">)),</span>\n <span class=\"s1\">&#39;version&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">}</span>\n</pre></div>\n</div>\n<p>If the <code class=\"docutils literal notranslate\"><span class=\"pre\">binary_form</span></code> parameter is <a class=\"reference internal\" href=\"constants.html#True\" title=\"True\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">True</span></code></a>, and a certificate was\nprovided, this method returns the DER-encoded form of the entire certificate\nas a sequence of bytes, or <a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a> if the peer did not provide a\ncertificate.  Whether the peer provides a certificate depends on the SSL\nsocket’s role:</p>\n<ul class=\"simple\">\n<li><p>for a client SSL socket, the server will always provide a certificate,\nregardless of whether validation was required;</p></li>\n<li><p>for a server SSL socket, the client will only provide a certificate\nwhen requested by the server; therefore <a class=\"reference internal\" href=\"#ssl.SSLSocket.getpeercert\" title=\"ssl.SSLSocket.getpeercert\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getpeercert()</span></code></a> will return\n<a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a> if you used <a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a> (rather than\n<a class=\"reference internal\" href=\"#ssl.CERT_OPTIONAL\" title=\"ssl.CERT_OPTIONAL\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_OPTIONAL</span></code></a> or <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>).</p></li>\n</ul>\n<p>See also <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.check_hostname</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.2: </span>The returned dictionary includes additional items such as <code class=\"docutils literal notranslate\"><span class=\"pre\">issuer</span></code>\nand <code class=\"docutils literal notranslate\"><span class=\"pre\">notBefore</span></code>.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.4: </span><a class=\"reference internal\" href=\"exceptions.html#ValueError\" title=\"ValueError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ValueError</span></code></a> is raised when the handshake isn’t done.\nThe returned dictionary includes additional X509v3 extension items\n  such as <code class=\"docutils literal notranslate\"><span class=\"pre\">crlDistributionPoints</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">caIssuers</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">OCSP</span></code> URIs.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.9: </span>IPv6 address strings no longer have a trailing new line.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.get_verified_chain\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_verified_chain</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.get_verified_chain\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns verified certificate chain provided by the other\nend of the SSL channel as a list of DER-encoded bytes.\nIf certificate verification was disabled method acts the same as\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.get_unverified_chain\" title=\"ssl.SSLSocket.get_unverified_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_unverified_chain()</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.13.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.get_unverified_chain\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_unverified_chain</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.get_unverified_chain\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns raw certificate chain provided by the other\nend of the SSL channel as a list of DER-encoded bytes.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.13.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.cipher\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">cipher</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.cipher\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns a three-value tuple containing the name of the cipher being used, the\nversion of the SSL protocol that defines its use, and the number of secret\nbits being used.  If no connection has been established, returns <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.shared_ciphers\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">shared_ciphers</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.shared_ciphers\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the list of ciphers available in both the client and server.  Each\nentry of the returned list is a three-value tuple containing the name of the\ncipher, the version of the SSL protocol that defines its use, and the number\nof secret bits the cipher uses.  <a class=\"reference internal\" href=\"#ssl.SSLSocket.shared_ciphers\" title=\"ssl.SSLSocket.shared_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">shared_ciphers()</span></code></a> returns\n<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> if no connection has been established or the socket is a client\nsocket.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.compression\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">compression</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.compression\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the compression algorithm being used as a string, or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>\nif the connection isn’t compressed.</p>\n<p>If the higher-level protocol supports its own compression mechanism,\nyou can use <a class=\"reference internal\" href=\"#ssl.OP_NO_COMPRESSION\" title=\"ssl.OP_NO_COMPRESSION\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_COMPRESSION</span></code></a> to disable SSL-level compression.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.get_channel_binding\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_channel_binding</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cb_type</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'tls-unique'</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.get_channel_binding\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Get channel binding data for current connection, as a bytes object.  Returns\n<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> if not connected or the handshake has not been completed.</p>\n<p>The <em>cb_type</em> parameter allow selection of the desired channel binding\ntype. Valid channel binding types are listed in the\n<a class=\"reference internal\" href=\"#ssl.CHANNEL_BINDING_TYPES\" title=\"ssl.CHANNEL_BINDING_TYPES\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CHANNEL_BINDING_TYPES</span></code></a> list.  Currently only the ‘tls-unique’ channel\nbinding, defined by <span class=\"target\" id=\"index-13\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5929.html\"><strong>RFC 5929</strong></a>, is supported.  <a class=\"reference internal\" href=\"exceptions.html#ValueError\" title=\"ValueError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ValueError</span></code></a> will be\nraised if an unsupported channel binding type is requested.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.selected_alpn_protocol\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">selected_alpn_protocol</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.selected_alpn_protocol\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the protocol that was selected during the TLS handshake.  If\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_alpn_protocols\" title=\"ssl.SSLContext.set_alpn_protocols\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_alpn_protocols()</span></code></a> was not called, if the other party does\nnot support ALPN, if this socket does not support any of the client’s\nproposed protocols, or if the handshake has not happened yet, <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> is\nreturned.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.selected_npn_protocol\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">selected_npn_protocol</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.selected_npn_protocol\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the higher-level protocol that was selected during the TLS/SSL\nhandshake. If <a class=\"reference internal\" href=\"#ssl.SSLContext.set_npn_protocols\" title=\"ssl.SSLContext.set_npn_protocols\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_npn_protocols()</span></code></a> was not called, or\nif the other party does not support NPN, or if the handshake has not yet\nhappened, this will return <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.10: </span>NPN has been superseded by ALPN</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.unwrap\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">unwrap</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.unwrap\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Performs the SSL shutdown handshake, which removes the TLS layer from the\nunderlying socket, and returns the underlying socket object.  This can be\nused to go from encrypted operation over a connection to unencrypted.  The\nreturned socket should always be used for further communication with the\nother side of the connection, rather than the original socket.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.verify_client_post_handshake\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">verify_client_post_handshake</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.verify_client_post_handshake\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Requests post-handshake authentication (PHA) from a TLS 1.3 client. PHA\ncan only be initiated for a TLS 1.3 connection from a server-side socket,\nafter the initial TLS handshake and with PHA enabled on both sides, see\n<a class=\"reference internal\" href=\"#ssl.SSLContext.post_handshake_auth\" title=\"ssl.SSLContext.post_handshake_auth\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.post_handshake_auth</span></code></a>.</p>\n<p>The method does not perform a cert exchange immediately. The server-side\nsends a CertificateRequest during the next write event and expects the\nclient to respond with a certificate on the next read event.</p>\n<p>If any precondition isn’t met (e.g. not TLS 1.3, PHA not enabled), an\n<a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> is raised.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Only available with OpenSSL 1.1.1 and TLS 1.3 enabled. Without TLS 1.3\nsupport, the method raises <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a>.</p>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.version\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">version</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.version\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the actual SSL protocol version negotiated by the connection\nas a string, or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> if no secure connection is established.\nAs of this writing, possible return values include <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;SSLv2&quot;</span></code>,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;SSLv3&quot;</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;TLSv1&quot;</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;TLSv1.1&quot;</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;TLSv1.2&quot;</span></code>.\nRecent OpenSSL versions may define more return values.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.pending\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">pending</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLSocket.pending\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Returns the number of already decrypted bytes available for read, pending on\nthe connection.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.context\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">context</span></span><a class=\"headerlink\" href=\"#ssl.SSLSocket.context\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> object this SSL socket is tied to.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.server_side\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">server_side</span></span><a class=\"headerlink\" href=\"#ssl.SSLSocket.server_side\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A boolean which is <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> for server-side sockets and <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code> for\nclient-side sockets.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.server_hostname\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">server_hostname</span></span><a class=\"headerlink\" href=\"#ssl.SSLSocket.server_hostname\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Hostname of the server: <a class=\"reference internal\" href=\"stdtypes.html#str\" title=\"str\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">str</span></code></a> type, or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> for server-side\nsocket or if the hostname was not specified in the constructor.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>The attribute is now always ASCII text. When <code class=\"docutils literal notranslate\"><span class=\"pre\">server_hostname</span></code> is\nan internationalized domain name (IDN), this attribute now stores the\nA-label form (<code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;xn--pythn-mua.org&quot;</span></code>), rather than the U-label form\n(<code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;pythön.org&quot;</span></code>).</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.session\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">session</span></span><a class=\"headerlink\" href=\"#ssl.SSLSocket.session\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The <a class=\"reference internal\" href=\"#ssl.SSLSession\" title=\"ssl.SSLSession\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSession</span></code></a> for this SSL connection. The session is available\nfor client and server side sockets after the TLS handshake has been\nperformed. For client sockets the session can be set before\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">do_handshake()</span></code></a> has been called to reuse a session.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSocket.session_reused\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLSocket.</span></span><span class=\"sig-name descname\"><span class=\"pre\">session_reused</span></span><a class=\"headerlink\" href=\"#ssl.SSLSocket.session_reused\" title=\"Link to this definition\">¶</a></dt>\n<dd><div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"ssl-contexts\">\n<h2>SSL Contexts<a class=\"headerlink\" href=\"#ssl-contexts\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.2.</span></p>\n</div>\n<p>An SSL context holds various data longer-lived than single SSL connections,\nsuch as SSL configuration options, certificate(s) and private key(s).\nIt also manages a cache of SSL sessions for server-side sockets, in order\nto speed up repeated connections from the same clients.</p>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLContext</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">protocol</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Create a new SSL context.  You may pass <em>protocol</em> which must be one\nof the <code class=\"docutils literal notranslate\"><span class=\"pre\">PROTOCOL_*</span></code> constants defined in this module.  The parameter\nspecifies which version of the SSL protocol to use.  Typically, the\nserver chooses a particular protocol version, and the client must adapt\nto the server’s choice.  Most of the versions are not interoperable\nwith the other versions.  If not specified, the default is\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>; it provides the most compatibility with other\nversions.</p>\n<p>Here’s a table showing which versions in a client (down the side) can connect\nto which versions in a server (along the top):</p>\n<table class=\"docutils align-default\">\n<tbody>\n<tr class=\"row-odd\"><td><p><em>client</em> / <strong>server</strong></p></td>\n<td><p><strong>SSLv2</strong></p></td>\n<td><p><strong>SSLv3</strong></p></td>\n<td><p><strong>TLS</strong> <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p><strong>TLSv1</strong></p></td>\n<td><p><strong>TLSv1.1</strong></p></td>\n<td><p><strong>TLSv1.2</strong></p></td>\n</tr>\n<tr class=\"row-even\"><td><p><em>SSLv2</em></p></td>\n<td><p>yes</p></td>\n<td><p>no</p></td>\n<td><p>no <a class=\"footnote-reference brackets\" href=\"#id7\" id=\"id2\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n</tr>\n<tr class=\"row-odd\"><td><p><em>SSLv3</em></p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n<td><p>no <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id3\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n</tr>\n<tr class=\"row-even\"><td><p><em>TLS</em> (<em>SSLv23</em>) <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id4\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p>no <a class=\"footnote-reference brackets\" href=\"#id7\" id=\"id5\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p>no <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id6\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a></p></td>\n<td><p>yes</p></td>\n<td><p>yes</p></td>\n<td><p>yes</p></td>\n<td><p>yes</p></td>\n</tr>\n<tr class=\"row-odd\"><td><p><em>TLSv1</em></p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n<td><p>yes</p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n</tr>\n<tr class=\"row-even\"><td><p><em>TLSv1.1</em></p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n<td><p>no</p></td>\n</tr>\n<tr class=\"row-odd\"><td><p><em>TLSv1.2</em></p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n<td><p>no</p></td>\n<td><p>no</p></td>\n<td><p>yes</p></td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Footnotes</p>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id7\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id2\">1</a>,<a role=\"doc-backlink\" href=\"#id5\">2</a>)</span>\n<p><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> disables SSLv2 with <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv2\" title=\"ssl.OP_NO_SSLv2\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv2</span></code></a> by default.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id8\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id3\">1</a>,<a role=\"doc-backlink\" href=\"#id6\">2</a>)</span>\n<p><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> disables SSLv3 with <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv3\" title=\"ssl.OP_NO_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv3</span></code></a> by default.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id9\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id4\">2</a>)</span>\n<p>TLS 1.3 protocol will be available with <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a> in\nOpenSSL &gt;= 1.1.1. There is no dedicated PROTOCOL constant for just\nTLS 1.3.</p>\n</aside>\n</aside>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<p><a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a> lets the <a class=\"reference internal\" href=\"#module-ssl\" title=\"ssl: TLS/SSL wrapper for socket objects\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code></a> module choose\nsecurity settings for a given purpose.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span>The context is created with secure default values. The options\n<a class=\"reference internal\" href=\"#ssl.OP_NO_COMPRESSION\" title=\"ssl.OP_NO_COMPRESSION\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_COMPRESSION</span></code></a>, <a class=\"reference internal\" href=\"#ssl.OP_CIPHER_SERVER_PREFERENCE\" title=\"ssl.OP_CIPHER_SERVER_PREFERENCE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_CIPHER_SERVER_PREFERENCE</span></code></a>,\n<a class=\"reference internal\" href=\"#ssl.OP_SINGLE_DH_USE\" title=\"ssl.OP_SINGLE_DH_USE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_SINGLE_DH_USE</span></code></a>, <a class=\"reference internal\" href=\"#ssl.OP_SINGLE_ECDH_USE\" title=\"ssl.OP_SINGLE_ECDH_USE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_SINGLE_ECDH_USE</span></code></a>,\n<a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv2\" title=\"ssl.OP_NO_SSLv2\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv2</span></code></a>,\nand <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv3\" title=\"ssl.OP_NO_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv3</span></code></a> (except for <a class=\"reference internal\" href=\"#ssl.PROTOCOL_SSLv3\" title=\"ssl.PROTOCOL_SSLv3\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_SSLv3</span></code></a>) are\nset by default. The initial cipher suite list contains only <code class=\"docutils literal notranslate\"><span class=\"pre\">HIGH</span></code>\nciphers, no <code class=\"docutils literal notranslate\"><span class=\"pre\">NULL</span></code> ciphers and no <code class=\"docutils literal notranslate\"><span class=\"pre\">MD5</span></code> ciphers.</p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.10: </span><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> without protocol argument is deprecated. The\ncontext class will either require <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> protocol in the future.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span>The default cipher suites now include only secure AES and ChaCha20\nciphers with forward secrecy and security level 2. RSA and DH keys with\nless than 2048 bits and ECC keys with less than 224 bits are prohibited.\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>, <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a>, and\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> use TLS 1.2 as minimum TLS version.</p>\n</div>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> only supports limited mutation once it has been used\nby a connection. Adding new certificates to the internal trust store is\nallowed, but changing ciphers, verification settings, or mTLS\ncertificates may result in surprising behavior.</p>\n</div>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> is designed to be shared and used by multiple\nconnections.\nThus, it is thread-safe as long as it is not reconfigured after being\nused by a connection.</p>\n</div>\n</dd></dl>\n\n<p><a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> objects have the following methods and attributes:</p>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.cert_store_stats\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">cert_store_stats</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.cert_store_stats\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Get statistics about quantities of loaded X.509 certificates, count of\nX.509 certificates flagged as CA certificates and certificate revocation\nlists as dictionary.</p>\n<p>Example for a context with one CA cert and one other cert:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">cert_store_stats</span><span class=\"p\">()</span>\n<span class=\"go\">{&#39;crl&#39;: 0, &#39;x509_ca&#39;: 1, &#39;x509&#39;: 2}</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.load_cert_chain\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">load_cert_chain</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">certfile</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">keyfile</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">password</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.load_cert_chain\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Load a private key and the corresponding certificate.  The <em>certfile</em>\nstring must be the path to a single file in PEM format containing the\ncertificate as well as any number of CA certificates needed to establish\nthe certificate’s authenticity.  The <em>keyfile</em> string, if present, must\npoint to a file containing the private key.  Otherwise the private\nkey will be taken from <em>certfile</em> as well.  See the discussion of\n<a class=\"reference internal\" href=\"#ssl-certificates\"><span class=\"std std-ref\">Certificates</span></a> for more information on how the certificate\nis stored in the <em>certfile</em>.</p>\n<p>The <em>password</em> argument may be a function to call to get the password for\ndecrypting the private key.  It will only be called if the private key is\nencrypted and a password is necessary.  It will be called with no arguments,\nand it should return a string, bytes, or bytearray.  If the return value is\na string it will be encoded as UTF-8 before using it to decrypt the key.\nAlternatively a string, bytes, or bytearray value may be supplied directly\nas the <em>password</em> argument.  It will be ignored if the private key is not\nencrypted and no password is needed.</p>\n<p>If the <em>password</em> argument is not specified and a password is required,\nOpenSSL’s built-in password prompting mechanism will be used to\ninteractively prompt the user for a password.</p>\n<p>An <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> is raised if the private key doesn’t\nmatch with the certificate.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.3: </span>New optional argument <em>password</em>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.load_default_certs\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">load_default_certs</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">purpose</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">Purpose.SERVER_AUTH</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.load_default_certs\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Load a set of default “certification authority” (CA) certificates from\ndefault locations. On Windows it loads CA certs from the <code class=\"docutils literal notranslate\"><span class=\"pre\">CA</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">ROOT</span></code> system stores. On all systems it calls\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_default_verify_paths\" title=\"ssl.SSLContext.set_default_verify_paths\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_default_verify_paths()</span></code></a>. In the future the method may\nload CA certificates from other locations, too.</p>\n<p>The <em>purpose</em> flag specifies what kind of CA certificates are loaded. The\ndefault settings <a class=\"reference internal\" href=\"#ssl.Purpose.SERVER_AUTH\" title=\"ssl.Purpose.SERVER_AUTH\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">Purpose.SERVER_AUTH</span></code></a> loads certificates, that are\nflagged and trusted for TLS web server authentication (client side\nsockets). <a class=\"reference internal\" href=\"#ssl.Purpose.CLIENT_AUTH\" title=\"ssl.Purpose.CLIENT_AUTH\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">Purpose.CLIENT_AUTH</span></code></a> loads CA certificates for client\ncertificate verification on the server side.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.load_verify_locations\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">load_verify_locations</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cafile</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">capath</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">cadata</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.load_verify_locations\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Load a set of “certification authority” (CA) certificates used to validate\nother peers’ certificates when <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> is other than\n<a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a>.  At least one of <em>cafile</em> or <em>capath</em> must be specified.</p>\n<p>This method can also load certification revocation lists (CRLs) in PEM or\nDER format. In order to make use of CRLs, <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a>\nmust be configured properly.</p>\n<p>The <em>cafile</em> string, if present, is the path to a file of concatenated\nCA certificates in PEM format. See the discussion of\n<a class=\"reference internal\" href=\"#ssl-certificates\"><span class=\"std std-ref\">Certificates</span></a> for more information about how to arrange the\ncertificates in this file.</p>\n<p>The <em>capath</em> string, if present, is\nthe path to a directory containing several CA certificates in PEM format,\nfollowing an <a class=\"reference external\" href=\"https://docs.openssl.org/master/man3/SSL_CTX_load_verify_locations/\">OpenSSL specific layout</a>.</p>\n<p>The <em>cadata</em> object, if present, is either an ASCII string of one or more\nPEM-encoded certificates or a <a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a> of DER-encoded\ncertificates. Like with <em>capath</em> extra lines around PEM-encoded\ncertificates are ignored but at least one certificate must be present.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.4: </span>New optional argument <em>cadata</em></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.get_ca_certs\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_ca_certs</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">binary_form</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.get_ca_certs\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Get a list of loaded “certification authority” (CA) certificates. If the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">binary_form</span></code> parameter is <a class=\"reference internal\" href=\"constants.html#False\" title=\"False\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">False</span></code></a> each list\nentry is a dict like the output of <a class=\"reference internal\" href=\"#ssl.SSLSocket.getpeercert\" title=\"ssl.SSLSocket.getpeercert\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.getpeercert()</span></code></a>. Otherwise\nthe method returns a list of DER-encoded certificates. The returned list\ndoes not contain certificates from <em>capath</em> unless a certificate was\nrequested and loaded by a SSL connection.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Certificates in a capath directory aren’t loaded unless they have\nbeen used at least once.</p>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.get_ciphers\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">get_ciphers</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.get_ciphers\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Get a list of enabled ciphers. The list is in order of cipher priority.\nSee <a class=\"reference internal\" href=\"#ssl.SSLContext.set_ciphers\" title=\"ssl.SSLContext.set_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_ciphers()</span></code></a>.</p>\n<p>Example:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ctx</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_SSLv23</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">set_ciphers</span><span class=\"p\">(</span><span class=\"s1\">&#39;ECDHE+AESGCM:!ECDSA&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ctx</span><span class=\"o\">.</span><span class=\"n\">get_ciphers</span><span class=\"p\">()</span>\n<span class=\"go\">[{&#39;aead&#39;: True,</span>\n<span class=\"go\">  &#39;alg_bits&#39;: 256,</span>\n<span class=\"go\">  &#39;auth&#39;: &#39;auth-rsa&#39;,</span>\n<span class=\"go\">  &#39;description&#39;: &#39;ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  &#39;</span>\n<span class=\"go\">                 &#39;Enc=AESGCM(256) Mac=AEAD&#39;,</span>\n<span class=\"go\">  &#39;digest&#39;: None,</span>\n<span class=\"go\">  &#39;id&#39;: 50380848,</span>\n<span class=\"go\">  &#39;kea&#39;: &#39;kx-ecdhe&#39;,</span>\n<span class=\"go\">  &#39;name&#39;: &#39;ECDHE-RSA-AES256-GCM-SHA384&#39;,</span>\n<span class=\"go\">  &#39;protocol&#39;: &#39;TLSv1.2&#39;,</span>\n<span class=\"go\">  &#39;strength_bits&#39;: 256,</span>\n<span class=\"go\">  &#39;symmetric&#39;: &#39;aes-256-gcm&#39;},</span>\n<span class=\"go\"> {&#39;aead&#39;: True,</span>\n<span class=\"go\">  &#39;alg_bits&#39;: 128,</span>\n<span class=\"go\">  &#39;auth&#39;: &#39;auth-rsa&#39;,</span>\n<span class=\"go\">  &#39;description&#39;: &#39;ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  &#39;</span>\n<span class=\"go\">                 &#39;Enc=AESGCM(128) Mac=AEAD&#39;,</span>\n<span class=\"go\">  &#39;digest&#39;: None,</span>\n<span class=\"go\">  &#39;id&#39;: 50380847,</span>\n<span class=\"go\">  &#39;kea&#39;: &#39;kx-ecdhe&#39;,</span>\n<span class=\"go\">  &#39;name&#39;: &#39;ECDHE-RSA-AES128-GCM-SHA256&#39;,</span>\n<span class=\"go\">  &#39;protocol&#39;: &#39;TLSv1.2&#39;,</span>\n<span class=\"go\">  &#39;strength_bits&#39;: 128,</span>\n<span class=\"go\">  &#39;symmetric&#39;: &#39;aes-128-gcm&#39;}]</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_default_verify_paths\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_default_verify_paths</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_default_verify_paths\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Load a set of default “certification authority” (CA) certificates from\na filesystem path defined when building the OpenSSL library.  Unfortunately,\nthere’s no easy way to know whether this method succeeds: no error is\nreturned if no certificates are to be found.  When the OpenSSL library is\nprovided as part of the operating system, though, it is likely to be\nconfigured properly.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_ciphers\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_ciphers</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">ciphers</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_ciphers\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Set the available ciphers for sockets created with this context.\nIt should be a string in the <a class=\"reference external\" href=\"https://docs.openssl.org/master/man1/ciphers/\">OpenSSL cipher list format</a>.\nIf no cipher can be selected (because compile-time options or other\nconfiguration forbids use of all the specified ciphers), an\n<a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a> will be raised.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>when connected, the <a class=\"reference internal\" href=\"#ssl.SSLSocket.cipher\" title=\"ssl.SSLSocket.cipher\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.cipher()</span></code></a> method of SSL sockets will\ngive the currently selected cipher.</p>\n<p>TLS 1.3 cipher suites cannot be disabled with\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_ciphers\" title=\"ssl.SSLContext.set_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">set_ciphers()</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_alpn_protocols\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_alpn_protocols</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">alpn_protocols</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_alpn_protocols\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Specify which protocols the socket should advertise during the SSL/TLS\nhandshake. It should be a list of ASCII strings, like <code class=\"docutils literal notranslate\"><span class=\"pre\">['http/1.1',</span>\n<span class=\"pre\">'spdy/2']</span></code>, ordered by preference. The selection of a protocol will happen\nduring the handshake, and will play out according to <span class=\"target\" id=\"index-14\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc7301.html\"><strong>RFC 7301</strong></a>. After a\nsuccessful handshake, the <a class=\"reference internal\" href=\"#ssl.SSLSocket.selected_alpn_protocol\" title=\"ssl.SSLSocket.selected_alpn_protocol\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.selected_alpn_protocol()</span></code></a> method will\nreturn the agreed-upon protocol.</p>\n<p>This method will raise <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a> if <a class=\"reference internal\" href=\"#ssl.HAS_ALPN\" title=\"ssl.HAS_ALPN\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HAS_ALPN</span></code></a> is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_npn_protocols\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_npn_protocols</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">npn_protocols</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_npn_protocols\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Specify which protocols the socket should advertise during the SSL/TLS\nhandshake. It should be a list of strings, like <code class=\"docutils literal notranslate\"><span class=\"pre\">['http/1.1',</span> <span class=\"pre\">'spdy/2']</span></code>,\nordered by preference. The selection of a protocol will happen during the\nhandshake, and will play out according to the <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Application-Layer_Protocol_Negotiation\">Application Layer Protocol Negotiation</a>. After a\nsuccessful handshake, the <a class=\"reference internal\" href=\"#ssl.SSLSocket.selected_npn_protocol\" title=\"ssl.SSLSocket.selected_npn_protocol\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.selected_npn_protocol()</span></code></a> method will\nreturn the agreed-upon protocol.</p>\n<p>This method will raise <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a> if <a class=\"reference internal\" href=\"#ssl.HAS_NPN\" title=\"ssl.HAS_NPN\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HAS_NPN</span></code></a> is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.10: </span>NPN has been superseded by ALPN</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.sni_callback\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">sni_callback</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.sni_callback\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Register a callback function that will be called after the TLS Client Hello\nhandshake message has been received by the SSL/TLS server when the TLS client\nspecifies a server name indication. The server name indication mechanism\nis specified in <span class=\"target\" id=\"index-15\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc6066.html\"><strong>RFC 6066</strong></a> section 3 - Server Name Indication.</p>\n<p>Only one callback can be set per <code class=\"docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code>.  If <em>sni_callback</em>\nis set to <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> then the callback is disabled. Calling this function a\nsubsequent time will disable the previously registered callback.</p>\n<p>The callback function will be called with three\narguments; the first being the <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ssl.SSLSocket</span></code></a>, the second is a string\nthat represents the server name that the client is intending to communicate\n(or <a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a> if the TLS Client Hello does not contain a server name)\nand the third argument is the original <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a>. The server name\nargument is text. For internationalized domain name, the server\nname is an IDN A-label (<code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;xn--pythn-mua.org&quot;</span></code>).</p>\n<p>A typical use of this callback is to change the <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">ssl.SSLSocket</span></code></a>’s\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.context\" title=\"ssl.SSLSocket.context\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLSocket.context</span></code></a> attribute to a new object of type\n<a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> representing a certificate chain that matches the server\nname.</p>\n<p>Due to the early negotiation phase of the TLS connection, only limited\nmethods and attributes are usable like\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.selected_alpn_protocol\" title=\"ssl.SSLSocket.selected_alpn_protocol\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.selected_alpn_protocol()</span></code></a> and <a class=\"reference internal\" href=\"#ssl.SSLSocket.context\" title=\"ssl.SSLSocket.context\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLSocket.context</span></code></a>.\nThe <a class=\"reference internal\" href=\"#ssl.SSLSocket.getpeercert\" title=\"ssl.SSLSocket.getpeercert\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.getpeercert()</span></code></a>, <a class=\"reference internal\" href=\"#ssl.SSLSocket.get_verified_chain\" title=\"ssl.SSLSocket.get_verified_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.get_verified_chain()</span></code></a>,\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.get_unverified_chain\" title=\"ssl.SSLSocket.get_unverified_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.get_unverified_chain()</span></code></a> <a class=\"reference internal\" href=\"#ssl.SSLSocket.cipher\" title=\"ssl.SSLSocket.cipher\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.cipher()</span></code></a>\nand <a class=\"reference internal\" href=\"#ssl.SSLSocket.compression\" title=\"ssl.SSLSocket.compression\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.compression()</span></code></a> methods require that\nthe TLS connection has progressed beyond the TLS Client Hello and therefore\nwill not return meaningful values nor can they be called safely.</p>\n<p>The <em>sni_callback</em> function must return <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> to allow the\nTLS negotiation to continue.  If a TLS failure is required, a constant\n<a class=\"reference internal\" href=\"#ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\" title=\"ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">ALERT_DESCRIPTION_*</span></code></a> can be\nreturned.  Other return values will result in a TLS fatal error with\n<a class=\"reference internal\" href=\"#ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\" title=\"ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">ALERT_DESCRIPTION_INTERNAL_ERROR</span></code></a>.</p>\n<p>If an exception is raised from the <em>sni_callback</em> function the TLS\nconnection will terminate with a fatal TLS alert message\n<a class=\"reference internal\" href=\"#ssl.ALERT_DESCRIPTION_HANDSHAKE_FAILURE\" title=\"ssl.ALERT_DESCRIPTION_HANDSHAKE_FAILURE\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">ALERT_DESCRIPTION_HANDSHAKE_FAILURE</span></code></a>.</p>\n<p>This method will raise <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a> if the OpenSSL library\nhad OPENSSL_NO_TLSEXT defined when it was built.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_servername_callback\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_servername_callback</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">server_name_callback</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_servername_callback\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>This is a legacy API retained for backwards compatibility. When possible,\nyou should use <a class=\"reference internal\" href=\"#ssl.SSLContext.sni_callback\" title=\"ssl.SSLContext.sni_callback\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">sni_callback</span></code></a> instead. The given <em>server_name_callback</em>\nis similar to <em>sni_callback</em>, except that when the server hostname is an\nIDN-encoded internationalized domain name, the <em>server_name_callback</em>\nreceives a decoded U-label (<code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;pythön.org&quot;</span></code>).</p>\n<p>If there is a decoding error on the server name, the TLS connection will\nterminate with an <a class=\"reference internal\" href=\"#ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\" title=\"ssl.ALERT_DESCRIPTION_INTERNAL_ERROR\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">ALERT_DESCRIPTION_INTERNAL_ERROR</span></code></a> fatal TLS\nalert message to the client.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.load_dh_params\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">load_dh_params</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">dhfile</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.load_dh_params\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Load the key generation parameters for Diffie-Hellman (DH) key exchange.\nUsing DH key exchange improves forward secrecy at the expense of\ncomputational resources (both on the server and on the client).\nThe <em>dhfile</em> parameter should be the path to a file containing DH\nparameters in PEM format.</p>\n<p>This setting doesn’t apply to client sockets.  You can also use the\n<a class=\"reference internal\" href=\"#ssl.OP_SINGLE_DH_USE\" title=\"ssl.OP_SINGLE_DH_USE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_SINGLE_DH_USE</span></code></a> option to further improve security.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_ecdh_curve\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_ecdh_curve</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">curve_name</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_ecdh_curve\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Set the curve name for Elliptic Curve-based Diffie-Hellman (ECDH) key\nexchange.  ECDH is significantly faster than regular DH while arguably\nas secure.  The <em>curve_name</em> parameter should be a string describing\na well-known elliptic curve, for example <code class=\"docutils literal notranslate\"><span class=\"pre\">prime256v1</span></code> for a widely\nsupported curve.</p>\n<p>This setting doesn’t apply to client sockets.  You can also use the\n<a class=\"reference internal\" href=\"#ssl.OP_SINGLE_ECDH_USE\" title=\"ssl.OP_SINGLE_ECDH_USE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_SINGLE_ECDH_USE</span></code></a> option to further improve security.</p>\n<p>This method is not available if <a class=\"reference internal\" href=\"#ssl.HAS_ECDH\" title=\"ssl.HAS_ECDH\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HAS_ECDH</span></code></a> is <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<dl class=\"simple\">\n<dt><a class=\"reference external\" href=\"https://vincent.bernat.ch/en/blog/2011-ssl-perfect-forward-secrecy\">SSL/TLS &amp; Perfect Forward Secrecy</a></dt><dd><p>Vincent Bernat.</p>\n</dd>\n</dl>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.wrap_socket\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">wrap_socket</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">sock</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">server_side</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">do_handshake_on_connect</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">suppress_ragged_eofs</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">server_hostname</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">session</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.wrap_socket\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Wrap an existing Python socket <em>sock</em> and return an instance of\n<a class=\"reference internal\" href=\"#ssl.SSLContext.sslsocket_class\" title=\"ssl.SSLContext.sslsocket_class\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.sslsocket_class</span></code></a> (default <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>). The\nreturned SSL socket is tied to the context, its settings and certificates.\n<em>sock</em> must be a <a class=\"reference internal\" href=\"socket.html#socket.SOCK_STREAM\" title=\"socket.SOCK_STREAM\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">SOCK_STREAM</span></code></a> socket; other\nsocket types are unsupported.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">server_side</span></code> is a boolean which identifies whether\nserver-side or client-side behavior is desired from this socket.</p>\n<p>For client-side sockets, the context construction is lazy; if the\nunderlying socket isn’t connected yet, the context construction will be\nperformed after <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">connect()</span></code> is called on the socket.  For\nserver-side sockets, if the socket has no remote peer, it is assumed\nto be a listening socket, and the server-side SSL wrapping is\nautomatically performed on client connections accepted via the\n<code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">accept()</span></code> method. The method may raise <a class=\"reference internal\" href=\"#ssl.SSLError\" title=\"ssl.SSLError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLError</span></code></a>.</p>\n<p>On client connections, the optional parameter <em>server_hostname</em> specifies\nthe hostname of the service which we are connecting to.  This allows a\nsingle server to host multiple SSL-based services with distinct certificates,\nquite similarly to HTTP virtual hosts. Specifying <em>server_hostname</em> will\nraise a <a class=\"reference internal\" href=\"exceptions.html#ValueError\" title=\"ValueError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ValueError</span></code></a> if <em>server_side</em> is true.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">do_handshake_on_connect</span></code> specifies whether to do the SSL\nhandshake automatically after doing a <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">socket.connect()</span></code>, or whether the\napplication program will call it explicitly, by invoking the\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.do_handshake()</span></code></a> method.  Calling\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.do_handshake()</span></code></a> explicitly gives the program control over the\nblocking behavior of the socket I/O involved in the handshake.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">suppress_ragged_eofs</span></code> specifies how the\n<code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.recv()</span></code> method should signal unexpected EOF from the other end\nof the connection.  If specified as <a class=\"reference internal\" href=\"constants.html#True\" title=\"True\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">True</span></code></a> (the default), it returns a\nnormal EOF (an empty bytes object) in response to unexpected EOF errors\nraised from the underlying socket; if <a class=\"reference internal\" href=\"constants.html#False\" title=\"False\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">False</span></code></a>, it will raise the\nexceptions back to the caller.</p>\n<p><em>session</em>, see <a class=\"reference internal\" href=\"#ssl.SSLSocket.session\" title=\"ssl.SSLSocket.session\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">session</span></code></a>.</p>\n<p>To wrap an <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> in another <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>, use\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_bio\" title=\"ssl.SSLContext.wrap_bio\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_bio()</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>Always allow a server_hostname to be passed, even if OpenSSL does not\nhave SNI.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><em>session</em> argument was added.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>The method returns an instance of <a class=\"reference internal\" href=\"#ssl.SSLContext.sslsocket_class\" title=\"ssl.SSLContext.sslsocket_class\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.sslsocket_class</span></code></a>\ninstead of hard-coded <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.sslsocket_class\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">sslsocket_class</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.sslsocket_class\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The return type of <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a>, defaults to\n<a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>. The attribute can be assigned to on instances of\n<a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> in order to return a custom subclass of\n<a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.wrap_bio\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">wrap_bio</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">incoming</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">outgoing</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">server_side</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">False</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">server_hostname</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">session</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.wrap_bio\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Wrap the BIO objects <em>incoming</em> and <em>outgoing</em> and return an instance of\n<a class=\"reference internal\" href=\"#ssl.SSLContext.sslobject_class\" title=\"ssl.SSLContext.sslobject_class\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.sslobject_class</span></code></a> (default <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>). The SSL\nroutines will read input data from the incoming BIO and write data to the\noutgoing BIO.</p>\n<p>The <em>server_side</em>, <em>server_hostname</em> and <em>session</em> parameters have the\nsame meaning as in <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><em>session</em> argument was added.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>The method returns an instance of <a class=\"reference internal\" href=\"#ssl.SSLContext.sslobject_class\" title=\"ssl.SSLContext.sslobject_class\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.sslobject_class</span></code></a>\ninstead of hard-coded <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.sslobject_class\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">sslobject_class</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.sslobject_class\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The return type of <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_bio\" title=\"ssl.SSLContext.wrap_bio\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_bio()</span></code></a>, defaults to\n<a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>. The attribute can be overridden on instance of class\nin order to return a custom subclass of <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.session_stats\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">session_stats</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.session_stats\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Get statistics about the SSL sessions created or managed by this context.\nA dictionary is returned which maps the names of each <a class=\"reference external\" href=\"https://docs.openssl.org/1.1.1/man3/SSL_CTX_sess_number/\">piece of information</a> to their\nnumeric values.  For example, here is the total number of hits and misses\nin the session cache since the context was created:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">stats</span> <span class=\"o\">=</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">session_stats</span><span class=\"p\">()</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">stats</span><span class=\"p\">[</span><span class=\"s1\">&#39;hits&#39;</span><span class=\"p\">],</span> <span class=\"n\">stats</span><span class=\"p\">[</span><span class=\"s1\">&#39;misses&#39;</span><span class=\"p\">]</span>\n<span class=\"go\">(0, 0)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.check_hostname\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">check_hostname</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.check_hostname\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether to match the peer cert’s hostname in\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.do_handshake()</span></code></a>. The context’s\n<a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> must be set to <a class=\"reference internal\" href=\"#ssl.CERT_OPTIONAL\" title=\"ssl.CERT_OPTIONAL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_OPTIONAL</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>, and you must pass <em>server_hostname</em> to\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">wrap_socket()</span></code></a> in order to match the hostname.  Enabling\nhostname checking automatically sets <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> from\n<a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a> to <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>.  It cannot be set back to\n<a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a> as long as hostname checking is enabled. The\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> protocol enables hostname checking by default.\nWith other protocols, hostname checking must be enabled explicitly.</p>\n<p>Example:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">socket</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"nn\">ssl</span>\n\n<span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLSv1_2</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">verify_mode</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">CERT_REQUIRED</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">check_hostname</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">load_default_certs</span><span class=\"p\">()</span>\n\n<span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">socket</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">AF_INET</span><span class=\"p\">,</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">SOCK_STREAM</span><span class=\"p\">)</span>\n<span class=\"n\">ssl_sock</span> <span class=\"o\">=</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">,</span> <span class=\"n\">server_hostname</span><span class=\"o\">=</span><span class=\"s1\">&#39;www.verisign.com&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ssl_sock</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">((</span><span class=\"s1\">&#39;www.verisign.com&#39;</span><span class=\"p\">,</span> <span class=\"mi\">443</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span><a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> is now automatically changed\nto <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>  when hostname checking is enabled and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> is <a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a>. Previously\nthe same operation would have failed with a <a class=\"reference internal\" href=\"exceptions.html#ValueError\" title=\"ValueError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ValueError</span></code></a>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.keylog_filename\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">keylog_filename</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.keylog_filename\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write TLS keys to a keylog file, whenever key material is generated or\nreceived. The keylog file is designed for debugging purposes only. The\nfile format is specified by NSS and used by many traffic analyzers such\nas Wireshark. The log file is opened in append-only mode. Writes are\nsynchronized between threads, but not between processes.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.maximum_version\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">maximum_version</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.maximum_version\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A <a class=\"reference internal\" href=\"#ssl.TLSVersion\" title=\"ssl.TLSVersion\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">TLSVersion</span></code></a> enum member representing the highest supported\nTLS version. The value defaults to <a class=\"reference internal\" href=\"#ssl.TLSVersion.MAXIMUM_SUPPORTED\" title=\"ssl.TLSVersion.MAXIMUM_SUPPORTED\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">TLSVersion.MAXIMUM_SUPPORTED</span></code></a>.\nThe attribute is read-only for protocols other than <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS\" title=\"ssl.PROTOCOL_TLS\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS</span></code></a>,\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a>, and <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a>.</p>\n<p>The attributes <a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">maximum_version</span></code></a>,\n<a class=\"reference internal\" href=\"#ssl.SSLContext.minimum_version\" title=\"ssl.SSLContext.minimum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">minimum_version</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.options\" title=\"ssl.SSLContext.options\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.options</span></code></a> all affect the supported SSL\nand TLS versions of the context. The implementation does not prevent\ninvalid combination. For example a context with\n<a class=\"reference internal\" href=\"#ssl.OP_NO_TLSv1_2\" title=\"ssl.OP_NO_TLSv1_2\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">OP_NO_TLSv1_2</span></code></a> in <a class=\"reference internal\" href=\"#ssl.SSLContext.options\" title=\"ssl.SSLContext.options\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">options</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">maximum_version</span></code></a> set to <a class=\"reference internal\" href=\"#ssl.TLSVersion.TLSv1_2\" title=\"ssl.TLSVersion.TLSv1_2\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">TLSVersion.TLSv1_2</span></code></a>\nwill not be able to establish a TLS 1.2 connection.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.minimum_version\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">minimum_version</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.minimum_version\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Like <a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.maximum_version</span></code></a> except it is the lowest\nsupported version or <a class=\"reference internal\" href=\"#ssl.TLSVersion.MINIMUM_SUPPORTED\" title=\"ssl.TLSVersion.MINIMUM_SUPPORTED\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">TLSVersion.MINIMUM_SUPPORTED</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.num_tickets\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">num_tickets</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.num_tickets\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Control the number of TLS 1.3 session tickets of a\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> context. The setting has no impact on TLS\n1.0 to 1.2 connections.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.options\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">options</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.options\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>An integer representing the set of SSL options enabled on this context.\nThe default value is <a class=\"reference internal\" href=\"#ssl.OP_ALL\" title=\"ssl.OP_ALL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_ALL</span></code></a>, but you can specify other options\nsuch as <a class=\"reference internal\" href=\"#ssl.OP_NO_SSLv2\" title=\"ssl.OP_NO_SSLv2\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">OP_NO_SSLv2</span></code></a> by ORing them together.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><a class=\"reference internal\" href=\"#ssl.SSLContext.options\" title=\"ssl.SSLContext.options\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.options</span></code></a> returns <a class=\"reference internal\" href=\"#ssl.Options\" title=\"ssl.Options\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Options</span></code></a> flags:</p>\n<div class=\"doctest highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">options</span>\n<span class=\"go\">&lt;Options.OP_ALL|OP_NO_SSLv3|OP_NO_SSLv2|OP_NO_COMPRESSION: 2197947391&gt;</span>\n</pre></div>\n</div>\n</div>\n<div class=\"deprecated\">\n<p><span class=\"versionmodified deprecated\">Deprecated since version 3.7: </span>All <code class=\"docutils literal notranslate\"><span class=\"pre\">OP_NO_SSL*</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">OP_NO_TLS*</span></code> options have been deprecated since\nPython 3.7. Use <a class=\"reference internal\" href=\"#ssl.SSLContext.minimum_version\" title=\"ssl.SSLContext.minimum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.minimum_version</span></code></a> and\n<a class=\"reference internal\" href=\"#ssl.SSLContext.maximum_version\" title=\"ssl.SSLContext.maximum_version\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.maximum_version</span></code></a> instead.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.post_handshake_auth\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">post_handshake_auth</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.post_handshake_auth\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enable TLS 1.3 post-handshake client authentication. Post-handshake auth\nis disabled by default and a server can only request a TLS client\ncertificate during the initial handshake. When enabled, a server may\nrequest a TLS client certificate at any time after the handshake.</p>\n<p>When enabled on client-side sockets, the client signals the server that\nit supports post-handshake authentication.</p>\n<p>When enabled on server-side sockets, <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_mode</span></code></a> must\nbe set to <a class=\"reference internal\" href=\"#ssl.CERT_OPTIONAL\" title=\"ssl.CERT_OPTIONAL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_OPTIONAL</span></code></a> or <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>, too. The\nactual client cert exchange is delayed until\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.verify_client_post_handshake\" title=\"ssl.SSLSocket.verify_client_post_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.verify_client_post_handshake()</span></code></a> is called and some I/O is\nperformed.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.protocol\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">protocol</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.protocol\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The protocol version chosen when constructing the context.  This attribute\nis read-only.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.hostname_checks_common_name\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">hostname_checks_common_name</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.hostname_checks_common_name\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> falls back to verify the cert’s\nsubject common name in the absence of a subject alternative name\nextension (default: true).</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.10: </span>The flag had no effect with OpenSSL before version 1.1.1l. Python 3.8.9,\n3.9.3, and 3.10 include workarounds for previous versions.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.security_level\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">security_level</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.security_level\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>An integer representing the <a class=\"reference external\" href=\"https://docs.openssl.org/master/man3/SSL_CTX_get_security_level/\">security level</a>\nfor the context. This attribute is read-only.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.10.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.verify_flags\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">verify_flags</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.verify_flags\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The flags for certificate verification operations. You can set flags like\n<a class=\"reference internal\" href=\"#ssl.VERIFY_CRL_CHECK_LEAF\" title=\"ssl.VERIFY_CRL_CHECK_LEAF\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">VERIFY_CRL_CHECK_LEAF</span></code></a> by ORing them together. By default OpenSSL\ndoes neither require nor verify certificate revocation lists (CRLs).</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.4.</span></p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><a class=\"reference internal\" href=\"#ssl.SSLContext.verify_flags\" title=\"ssl.SSLContext.verify_flags\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_flags</span></code></a> returns <a class=\"reference internal\" href=\"#ssl.VerifyFlags\" title=\"ssl.VerifyFlags\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">VerifyFlags</span></code></a> flags:</p>\n<div class=\"doctest highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">verify_flags</span>\n<span class=\"go\">&lt;VerifyFlags.VERIFY_X509_TRUSTED_FIRST: 32768&gt;</span>\n</pre></div>\n</div>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.verify_mode\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">verify_mode</span></span><a class=\"headerlink\" href=\"#ssl.SSLContext.verify_mode\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Whether to try to verify other peers’ certificates and how to behave\nif verification fails.  This attribute must be one of\n<a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a>, <a class=\"reference internal\" href=\"#ssl.CERT_OPTIONAL\" title=\"ssl.CERT_OPTIONAL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_OPTIONAL</span></code></a> or <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.verify_mode</span></code></a> returns <a class=\"reference internal\" href=\"#ssl.VerifyMode\" title=\"ssl.VerifyMode\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">VerifyMode</span></code></a> enum:</p>\n<div class=\"doctest highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">verify_mode</span>\n<span class=\"go\">&lt;VerifyMode.CERT_REQUIRED: 2&gt;</span>\n</pre></div>\n</div>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_psk_client_callback\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_psk_client_callback</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">callback</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_psk_client_callback\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enables TLS-PSK (pre-shared key) authentication on a client-side connection.</p>\n<p>In general, certificate based authentication should be preferred over this method.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">callback</span></code> is a callable object with the signature:\n<code class=\"docutils literal notranslate\"><span class=\"pre\">def</span> <span class=\"pre\">callback(hint:</span> <span class=\"pre\">str</span> <span class=\"pre\">|</span> <span class=\"pre\">None)</span> <span class=\"pre\">-&gt;</span> <span class=\"pre\">tuple[str</span> <span class=\"pre\">|</span> <span class=\"pre\">None,</span> <span class=\"pre\">bytes]</span></code>.\nThe <code class=\"docutils literal notranslate\"><span class=\"pre\">hint</span></code> parameter is an optional identity hint sent by the server.\nThe return value is a tuple in the form (client-identity, psk).\nClient-identity is an optional string which may be used by the server to\nselect a corresponding PSK for the client. The string must be less than or\nequal to <code class=\"docutils literal notranslate\"><span class=\"pre\">256</span></code> octets when UTF-8 encoded. PSK is a\n<a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a> representing the pre-shared key. Return a zero\nlength PSK to reject the connection.</p>\n<p>Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">callback</span></code> to <a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a> removes any existing callback.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>When using TLS 1.3:</p>\n<ul class=\"simple\">\n<li><p>the <code class=\"docutils literal notranslate\"><span class=\"pre\">hint</span></code> parameter is always <a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a>.</p></li>\n<li><p>client-identity must be a non-empty string.</p></li>\n</ul>\n</div>\n<p>Example usage:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_CLIENT</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">check_hostname</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">verify_mode</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">CERT_NONE</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">maximum_version</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">TLSVersion</span><span class=\"o\">.</span><span class=\"n\">TLSv1_2</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_ciphers</span><span class=\"p\">(</span><span class=\"s1\">&#39;PSK&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># A simple lambda:</span>\n<span class=\"n\">psk</span> <span class=\"o\">=</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;c0ffee&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_psk_client_callback</span><span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">hint</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">psk</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># A table using the hint from the server:</span>\n<span class=\"n\">psk_table</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"s1\">&#39;ServerId_1&#39;</span><span class=\"p\">:</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;c0ffee&#39;</span><span class=\"p\">),</span>\n              <span class=\"s1\">&#39;ServerId_2&#39;</span><span class=\"p\">:</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;facade&#39;</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">callback</span><span class=\"p\">(</span><span class=\"n\">hint</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"s1\">&#39;ClientId_1&#39;</span><span class=\"p\">,</span> <span class=\"n\">psk_table</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">hint</span><span class=\"p\">,</span> <span class=\"sa\">b</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_psk_client_callback</span><span class=\"p\">(</span><span class=\"n\">callback</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>This method will raise <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a> if <a class=\"reference internal\" href=\"#ssl.HAS_PSK\" title=\"ssl.HAS_PSK\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HAS_PSK</span></code></a> is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.13.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLContext.set_psk_server_callback\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">SSLContext.</span></span><span class=\"sig-name descname\"><span class=\"pre\">set_psk_server_callback</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">callback</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">identity_hint</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.SSLContext.set_psk_server_callback\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Enables TLS-PSK (pre-shared key) authentication on a server-side connection.</p>\n<p>In general, certificate based authentication should be preferred over this method.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">callback</span></code> is a callable object with the signature:\n<code class=\"docutils literal notranslate\"><span class=\"pre\">def</span> <span class=\"pre\">callback(identity:</span> <span class=\"pre\">str</span> <span class=\"pre\">|</span> <span class=\"pre\">None)</span> <span class=\"pre\">-&gt;</span> <span class=\"pre\">bytes</span></code>.\nThe <code class=\"docutils literal notranslate\"><span class=\"pre\">identity</span></code> parameter is an optional identity sent by the client which can\nbe used to select a corresponding PSK.\nThe return value is a <a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a> representing the pre-shared key.\nReturn a zero length PSK to reject the connection.</p>\n<p>Setting <code class=\"docutils literal notranslate\"><span class=\"pre\">callback</span></code> to <a class=\"reference internal\" href=\"constants.html#None\" title=\"None\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">None</span></code></a> removes any existing callback.</p>\n<p>The parameter <code class=\"docutils literal notranslate\"><span class=\"pre\">identity_hint</span></code> is an optional identity hint string sent to\nthe client. The string must be less than or equal to <code class=\"docutils literal notranslate\"><span class=\"pre\">256</span></code> octets when\nUTF-8 encoded.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>When using TLS 1.3 the <code class=\"docutils literal notranslate\"><span class=\"pre\">identity_hint</span></code> parameter is not sent to the client.</p>\n</div>\n<p>Example usage:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_SERVER</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">maximum_version</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">TLSVersion</span><span class=\"o\">.</span><span class=\"n\">TLSv1_2</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_ciphers</span><span class=\"p\">(</span><span class=\"s1\">&#39;PSK&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># A simple lambda:</span>\n<span class=\"n\">psk</span> <span class=\"o\">=</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;c0ffee&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_psk_server_callback</span><span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">identity</span><span class=\"p\">:</span> <span class=\"n\">psk</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># A table using the identity of the client:</span>\n<span class=\"n\">psk_table</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"s1\">&#39;ClientId_1&#39;</span><span class=\"p\">:</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;c0ffee&#39;</span><span class=\"p\">),</span>\n              <span class=\"s1\">&#39;ClientId_2&#39;</span><span class=\"p\">:</span> <span class=\"nb\">bytes</span><span class=\"o\">.</span><span class=\"n\">fromhex</span><span class=\"p\">(</span><span class=\"s1\">&#39;facade&#39;</span><span class=\"p\">)</span>\n<span class=\"p\">}</span>\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">callback</span><span class=\"p\">(</span><span class=\"n\">identity</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">psk_table</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">identity</span><span class=\"p\">,</span> <span class=\"sa\">b</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">set_psk_server_callback</span><span class=\"p\">(</span><span class=\"n\">callback</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ServerId_1&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>This method will raise <a class=\"reference internal\" href=\"exceptions.html#NotImplementedError\" title=\"NotImplementedError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">NotImplementedError</span></code></a> if <a class=\"reference internal\" href=\"#ssl.HAS_PSK\" title=\"ssl.HAS_PSK\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HAS_PSK</span></code></a> is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.13.</span></p>\n</div>\n</dd></dl>\n\n</section>\n<section id=\"certificates\">\n<span id=\"ssl-certificates\"></span><span id=\"index-17\"></span><span id=\"index-16\"></span><h2>Certificates<a class=\"headerlink\" href=\"#certificates\" title=\"Link to this heading\">¶</a></h2>\n<p>Certificates in general are part of a public-key / private-key system.  In this\nsystem, each <em>principal</em>, (which may be a machine, or a person, or an\norganization) is assigned a unique two-part encryption key.  One part of the key\nis public, and is called the <em>public key</em>; the other part is kept secret, and is\ncalled the <em>private key</em>.  The two parts are related, in that if you encrypt a\nmessage with one of the parts, you can decrypt it with the other part, and\n<strong>only</strong> with the other part.</p>\n<p>A certificate contains information about two principals.  It contains the name\nof a <em>subject</em>, and the subject’s public key.  It also contains a statement by a\nsecond principal, the <em>issuer</em>, that the subject is who they claim to be, and\nthat this is indeed the subject’s public key.  The issuer’s statement is signed\nwith the issuer’s private key, which only the issuer knows.  However, anyone can\nverify the issuer’s statement by finding the issuer’s public key, decrypting the\nstatement with it, and comparing it to the other information in the certificate.\nThe certificate also contains information about the time period over which it is\nvalid.  This is expressed as two fields, called “notBefore” and “notAfter”.</p>\n<p>In the Python use of certificates, a client or server can use a certificate to\nprove who they are.  The other side of a network connection can also be required\nto produce a certificate, and that certificate can be validated to the\nsatisfaction of the client or server that requires such validation.  The\nconnection attempt can be set to raise an exception if the validation fails.\nValidation is done automatically, by the underlying OpenSSL framework; the\napplication need not concern itself with its mechanics.  But the application\ndoes usually need to provide sets of certificates to allow this process to take\nplace.</p>\n<p>Python uses files to contain certificates.  They should be formatted as “PEM”\n(see <span class=\"target\" id=\"index-18\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc1422.html\"><strong>RFC 1422</strong></a>), which is a base-64 encoded form wrapped with a header line\nand a footer line:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">certificate</span> <span class=\"ow\">in</span> <span class=\"n\">base64</span> <span class=\"n\">PEM</span> <span class=\"n\">encoding</span><span class=\"p\">)</span> <span class=\"o\">...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n</pre></div>\n</div>\n<section id=\"certificate-chains\">\n<h3>Certificate chains<a class=\"headerlink\" href=\"#certificate-chains\" title=\"Link to this heading\">¶</a></h3>\n<p>The Python files which contain certificates can contain a sequence of\ncertificates, sometimes called a <em>certificate chain</em>.  This chain should start\nwith the specific certificate for the principal who “is” the client or server,\nand then the certificate for the issuer of that certificate, and then the\ncertificate for the issuer of <em>that</em> certificate, and so on up the chain till\nyou get to a certificate which is <em>self-signed</em>, that is, a certificate which\nhas the same subject and issuer, sometimes called a <em>root certificate</em>.  The\ncertificates should just be concatenated together in the certificate file.  For\nexample, suppose we had a three certificate chain, from our server certificate\nto the certificate of the certification authority that signed our server\ncertificate, to the root certificate of the agency which issued the\ncertification authority’s certificate:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">certificate</span> <span class=\"k\">for</span> <span class=\"n\">your</span> <span class=\"n\">server</span><span class=\"p\">)</span><span class=\"o\">...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">the</span> <span class=\"n\">certificate</span> <span class=\"k\">for</span> <span class=\"n\">the</span> <span class=\"n\">CA</span><span class=\"p\">)</span><span class=\"o\">...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">the</span> <span class=\"n\">root</span> <span class=\"n\">certificate</span> <span class=\"k\">for</span> <span class=\"n\">the</span> <span class=\"n\">CA</span><span class=\"s1\">&#39;s issuer)...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n</pre></div>\n</div>\n</section>\n<section id=\"ca-certificates\">\n<h3>CA certificates<a class=\"headerlink\" href=\"#ca-certificates\" title=\"Link to this heading\">¶</a></h3>\n<p>If you are going to require validation of the other side of the connection’s\ncertificate, you need to provide a “CA certs” file, filled with the certificate\nchains for each issuer you are willing to trust.  Again, this file just contains\nthese chains concatenated together.  For validation, Python will use the first\nchain it finds in the file which matches.  The platform’s certificates file can\nbe used by calling <a class=\"reference internal\" href=\"#ssl.SSLContext.load_default_certs\" title=\"ssl.SSLContext.load_default_certs\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_default_certs()</span></code></a>, this is done\nautomatically with <a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a>.</p>\n</section>\n<section id=\"combined-key-and-certificate\">\n<h3>Combined key and certificate<a class=\"headerlink\" href=\"#combined-key-and-certificate\" title=\"Link to this heading\">¶</a></h3>\n<p>Often the private key is stored in the same file as the certificate; in this\ncase, only the <code class=\"docutils literal notranslate\"><span class=\"pre\">certfile</span></code> parameter to <a class=\"reference internal\" href=\"#ssl.SSLContext.load_cert_chain\" title=\"ssl.SSLContext.load_cert_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_cert_chain()</span></code></a>\nneeds to be passed.  If the private key is stored\nwith the certificate, it should come before the first certificate in\nthe certificate chain:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">RSA</span> <span class=\"n\">PRIVATE</span> <span class=\"n\">KEY</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">private</span> <span class=\"n\">key</span> <span class=\"ow\">in</span> <span class=\"n\">base64</span> <span class=\"n\">encoding</span><span class=\"p\">)</span> <span class=\"o\">...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">RSA</span> <span class=\"n\">PRIVATE</span> <span class=\"n\">KEY</span><span class=\"o\">-----</span>\n<span class=\"o\">-----</span><span class=\"n\">BEGIN</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n<span class=\"o\">...</span> <span class=\"p\">(</span><span class=\"n\">certificate</span> <span class=\"ow\">in</span> <span class=\"n\">base64</span> <span class=\"n\">PEM</span> <span class=\"n\">encoding</span><span class=\"p\">)</span> <span class=\"o\">...</span>\n<span class=\"o\">-----</span><span class=\"n\">END</span> <span class=\"n\">CERTIFICATE</span><span class=\"o\">-----</span>\n</pre></div>\n</div>\n</section>\n<section id=\"self-signed-certificates\">\n<h3>Self-signed certificates<a class=\"headerlink\" href=\"#self-signed-certificates\" title=\"Link to this heading\">¶</a></h3>\n<p>If you are going to create a server that provides SSL-encrypted connection\nservices, you will need to acquire a certificate for that service.  There are\nmany ways of acquiring appropriate certificates, such as buying one from a\ncertification authority.  Another common practice is to generate a self-signed\ncertificate.  The simplest way to do this is with the OpenSSL package, using\nsomething like the following:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">%</span> <span class=\"n\">openssl</span> <span class=\"n\">req</span> <span class=\"o\">-</span><span class=\"n\">new</span> <span class=\"o\">-</span><span class=\"n\">x509</span> <span class=\"o\">-</span><span class=\"n\">days</span> <span class=\"mi\">365</span> <span class=\"o\">-</span><span class=\"n\">nodes</span> <span class=\"o\">-</span><span class=\"n\">out</span> <span class=\"n\">cert</span><span class=\"o\">.</span><span class=\"n\">pem</span> <span class=\"o\">-</span><span class=\"n\">keyout</span> <span class=\"n\">cert</span><span class=\"o\">.</span><span class=\"n\">pem</span>\n<span class=\"n\">Generating</span> <span class=\"n\">a</span> <span class=\"mi\">1024</span> <span class=\"n\">bit</span> <span class=\"n\">RSA</span> <span class=\"n\">private</span> <span class=\"n\">key</span>\n<span class=\"o\">.......++++++</span>\n<span class=\"o\">.............................++++++</span>\n<span class=\"n\">writing</span> <span class=\"n\">new</span> <span class=\"n\">private</span> <span class=\"n\">key</span> <span class=\"n\">to</span> <span class=\"s1\">&#39;cert.pem&#39;</span>\n<span class=\"o\">-----</span>\n<span class=\"n\">You</span> <span class=\"n\">are</span> <span class=\"n\">about</span> <span class=\"n\">to</span> <span class=\"n\">be</span> <span class=\"n\">asked</span> <span class=\"n\">to</span> <span class=\"n\">enter</span> <span class=\"n\">information</span> <span class=\"n\">that</span> <span class=\"n\">will</span> <span class=\"n\">be</span> <span class=\"n\">incorporated</span>\n<span class=\"n\">into</span> <span class=\"n\">your</span> <span class=\"n\">certificate</span> <span class=\"n\">request</span><span class=\"o\">.</span>\n<span class=\"n\">What</span> <span class=\"n\">you</span> <span class=\"n\">are</span> <span class=\"n\">about</span> <span class=\"n\">to</span> <span class=\"n\">enter</span> <span class=\"ow\">is</span> <span class=\"n\">what</span> <span class=\"ow\">is</span> <span class=\"n\">called</span> <span class=\"n\">a</span> <span class=\"n\">Distinguished</span> <span class=\"n\">Name</span> <span class=\"ow\">or</span> <span class=\"n\">a</span> <span class=\"n\">DN</span><span class=\"o\">.</span>\n<span class=\"n\">There</span> <span class=\"n\">are</span> <span class=\"n\">quite</span> <span class=\"n\">a</span> <span class=\"n\">few</span> <span class=\"n\">fields</span> <span class=\"n\">but</span> <span class=\"n\">you</span> <span class=\"n\">can</span> <span class=\"n\">leave</span> <span class=\"n\">some</span> <span class=\"n\">blank</span>\n<span class=\"n\">For</span> <span class=\"n\">some</span> <span class=\"n\">fields</span> <span class=\"n\">there</span> <span class=\"n\">will</span> <span class=\"n\">be</span> <span class=\"n\">a</span> <span class=\"n\">default</span> <span class=\"n\">value</span><span class=\"p\">,</span>\n<span class=\"n\">If</span> <span class=\"n\">you</span> <span class=\"n\">enter</span> <span class=\"s1\">&#39;.&#39;</span><span class=\"p\">,</span> <span class=\"n\">the</span> <span class=\"n\">field</span> <span class=\"n\">will</span> <span class=\"n\">be</span> <span class=\"n\">left</span> <span class=\"n\">blank</span><span class=\"o\">.</span>\n<span class=\"o\">-----</span>\n<span class=\"n\">Country</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"mi\">2</span> <span class=\"n\">letter</span> <span class=\"n\">code</span><span class=\"p\">)</span> <span class=\"p\">[</span><span class=\"n\">AU</span><span class=\"p\">]:</span><span class=\"n\">US</span>\n<span class=\"n\">State</span> <span class=\"ow\">or</span> <span class=\"n\">Province</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"n\">full</span> <span class=\"n\">name</span><span class=\"p\">)</span> <span class=\"p\">[</span><span class=\"n\">Some</span><span class=\"o\">-</span><span class=\"n\">State</span><span class=\"p\">]:</span><span class=\"n\">MyState</span>\n<span class=\"n\">Locality</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"n\">eg</span><span class=\"p\">,</span> <span class=\"n\">city</span><span class=\"p\">)</span> <span class=\"p\">[]:</span><span class=\"n\">Some</span> <span class=\"n\">City</span>\n<span class=\"n\">Organization</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"n\">eg</span><span class=\"p\">,</span> <span class=\"n\">company</span><span class=\"p\">)</span> <span class=\"p\">[</span><span class=\"n\">Internet</span> <span class=\"n\">Widgits</span> <span class=\"n\">Pty</span> <span class=\"n\">Ltd</span><span class=\"p\">]:</span><span class=\"n\">My</span> <span class=\"n\">Organization</span><span class=\"p\">,</span> <span class=\"n\">Inc</span><span class=\"o\">.</span>\n<span class=\"n\">Organizational</span> <span class=\"n\">Unit</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"n\">eg</span><span class=\"p\">,</span> <span class=\"n\">section</span><span class=\"p\">)</span> <span class=\"p\">[]:</span><span class=\"n\">My</span> <span class=\"n\">Group</span>\n<span class=\"n\">Common</span> <span class=\"n\">Name</span> <span class=\"p\">(</span><span class=\"n\">eg</span><span class=\"p\">,</span> <span class=\"n\">YOUR</span> <span class=\"n\">name</span><span class=\"p\">)</span> <span class=\"p\">[]:</span><span class=\"n\">myserver</span><span class=\"o\">.</span><span class=\"n\">mygroup</span><span class=\"o\">.</span><span class=\"n\">myorganization</span><span class=\"o\">.</span><span class=\"n\">com</span>\n<span class=\"n\">Email</span> <span class=\"n\">Address</span> <span class=\"p\">[]:</span><span class=\"n\">ops</span><span class=\"nd\">@myserver</span><span class=\"o\">.</span><span class=\"n\">mygroup</span><span class=\"o\">.</span><span class=\"n\">myorganization</span><span class=\"o\">.</span><span class=\"n\">com</span>\n<span class=\"o\">%</span>\n</pre></div>\n</div>\n<p>The disadvantage of a self-signed certificate is that it is its own root\ncertificate, and no one else will have it in their cache of known (and trusted)\nroot certificates.</p>\n</section>\n</section>\n<section id=\"examples\">\n<h2>Examples<a class=\"headerlink\" href=\"#examples\" title=\"Link to this heading\">¶</a></h2>\n<section id=\"testing-for-ssl-support\">\n<h3>Testing for SSL support<a class=\"headerlink\" href=\"#testing-for-ssl-support\" title=\"Link to this heading\">¶</a></h3>\n<p>To test for the presence of SSL support in a Python installation, user code\nshould use the following idiom:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">try</span><span class=\"p\">:</span>\n    <span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">ssl</span>\n<span class=\"k\">except</span> <span class=\"ne\">ImportError</span><span class=\"p\">:</span>\n    <span class=\"k\">pass</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"o\">...</span>  <span class=\"c1\"># do something that requires SSL support</span>\n</pre></div>\n</div>\n</section>\n<section id=\"client-side-operation\">\n<h3>Client-side operation<a class=\"headerlink\" href=\"#client-side-operation\" title=\"Link to this heading\">¶</a></h3>\n<p>This example creates a SSL context with the recommended security settings\nfor client sockets, including automatic certificate verification:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>If you prefer to tune security settings yourself, you might create\na context from scratch (but beware that you might not get the settings\nright):</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_CLIENT</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">load_verify_locations</span><span class=\"p\">(</span><span class=\"s2\">&quot;/etc/ssl/certs/ca-bundle.crt&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>(this snippet assumes your operating system places a bundle of all CA\ncertificates in <code class=\"docutils literal notranslate\"><span class=\"pre\">/etc/ssl/certs/ca-bundle.crt</span></code>; if not, you’ll get an\nerror and have to adjust the location)</p>\n<p>The <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> protocol configures the context for cert\nvalidation and hostname verification. <a class=\"reference internal\" href=\"#ssl.SSLContext.verify_mode\" title=\"ssl.SSLContext.verify_mode\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">verify_mode</span></code></a> is\nset to <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a> and <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> is set\nto <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>. All other protocols create SSL contexts with insecure defaults.</p>\n<p>When you use the context to connect to a server, <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>\nand <a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">check_hostname</span></code></a> validate the server certificate: it\nensures that the server certificate was signed with one of the CA\ncertificates, checks the signature for correctness, and verifies other\nproperties like validity and identity of the hostname:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">conn</span> <span class=\"o\">=</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">socket</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">AF_INET</span><span class=\"p\">),</span>\n<span class=\"gp\">... </span>                           <span class=\"n\">server_hostname</span><span class=\"o\">=</span><span class=\"s2\">&quot;www.python.org&quot;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">conn</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">((</span><span class=\"s2\">&quot;www.python.org&quot;</span><span class=\"p\">,</span> <span class=\"mi\">443</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<p>You may then fetch the certificate:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">cert</span> <span class=\"o\">=</span> <span class=\"n\">conn</span><span class=\"o\">.</span><span class=\"n\">getpeercert</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Visual inspection shows that the certificate does identify the desired service\n(that is, the HTTPS host <code class=\"docutils literal notranslate\"><span class=\"pre\">www.python.org</span></code>):</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">pprint</span><span class=\"o\">.</span><span class=\"n\">pprint</span><span class=\"p\">(</span><span class=\"n\">cert</span><span class=\"p\">)</span>\n<span class=\"go\">{&#39;OCSP&#39;: (&#39;http://ocsp.digicert.com&#39;,),</span>\n<span class=\"go\"> &#39;caIssuers&#39;: (&#39;http://cacerts.digicert.com/DigiCertSHA2ExtendedValidationServerCA.crt&#39;,),</span>\n<span class=\"go\"> &#39;crlDistributionPoints&#39;: (&#39;http://crl3.digicert.com/sha2-ev-server-g1.crl&#39;,</span>\n<span class=\"go\">                           &#39;http://crl4.digicert.com/sha2-ev-server-g1.crl&#39;),</span>\n<span class=\"go\"> &#39;issuer&#39;: (((&#39;countryName&#39;, &#39;US&#39;),),</span>\n<span class=\"go\">            ((&#39;organizationName&#39;, &#39;DigiCert Inc&#39;),),</span>\n<span class=\"go\">            ((&#39;organizationalUnitName&#39;, &#39;www.digicert.com&#39;),),</span>\n<span class=\"go\">            ((&#39;commonName&#39;, &#39;DigiCert SHA2 Extended Validation Server CA&#39;),)),</span>\n<span class=\"go\"> &#39;notAfter&#39;: &#39;Sep  9 12:00:00 2016 GMT&#39;,</span>\n<span class=\"go\"> &#39;notBefore&#39;: &#39;Sep  5 00:00:00 2014 GMT&#39;,</span>\n<span class=\"go\"> &#39;serialNumber&#39;: &#39;01BB6F00122B177F36CAB49CEA8B6B26&#39;,</span>\n<span class=\"go\"> &#39;subject&#39;: (((&#39;businessCategory&#39;, &#39;Private Organization&#39;),),</span>\n<span class=\"go\">             ((&#39;1.3.6.1.4.1.311.60.2.1.3&#39;, &#39;US&#39;),),</span>\n<span class=\"go\">             ((&#39;1.3.6.1.4.1.311.60.2.1.2&#39;, &#39;Delaware&#39;),),</span>\n<span class=\"go\">             ((&#39;serialNumber&#39;, &#39;3359300&#39;),),</span>\n<span class=\"go\">             ((&#39;streetAddress&#39;, &#39;16 Allen Rd&#39;),),</span>\n<span class=\"go\">             ((&#39;postalCode&#39;, &#39;03894-4801&#39;),),</span>\n<span class=\"go\">             ((&#39;countryName&#39;, &#39;US&#39;),),</span>\n<span class=\"go\">             ((&#39;stateOrProvinceName&#39;, &#39;NH&#39;),),</span>\n<span class=\"go\">             ((&#39;localityName&#39;, &#39;Wolfeboro&#39;),),</span>\n<span class=\"go\">             ((&#39;organizationName&#39;, &#39;Python Software Foundation&#39;),),</span>\n<span class=\"go\">             ((&#39;commonName&#39;, &#39;www.python.org&#39;),)),</span>\n<span class=\"go\"> &#39;subjectAltName&#39;: ((&#39;DNS&#39;, &#39;www.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;pypi.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;docs.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;testpypi.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;bugs.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;wiki.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;hg.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;mail.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;packaging.python.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;pythonhosted.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;www.pythonhosted.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;test.pythonhosted.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;us.pycon.org&#39;),</span>\n<span class=\"go\">                    (&#39;DNS&#39;, &#39;id.python.org&#39;)),</span>\n<span class=\"go\"> &#39;version&#39;: 3}</span>\n</pre></div>\n</div>\n<p>Now the SSL channel is established and the certificate verified, you can\nproceed to talk with the server:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">conn</span><span class=\"o\">.</span><span class=\"n\">sendall</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;HEAD / HTTP/1.0</span><span class=\"se\">\\r\\n</span><span class=\"s2\">Host: linuxfr.org</span><span class=\"se\">\\r\\n\\r\\n</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">pprint</span><span class=\"o\">.</span><span class=\"n\">pprint</span><span class=\"p\">(</span><span class=\"n\">conn</span><span class=\"o\">.</span><span class=\"n\">recv</span><span class=\"p\">(</span><span class=\"mi\">1024</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;</span><span class=\"se\">\\r\\n</span><span class=\"s2\">&quot;</span><span class=\"p\">))</span>\n<span class=\"go\">[b&#39;HTTP/1.1 200 OK&#39;,</span>\n<span class=\"go\"> b&#39;Date: Sat, 18 Oct 2014 18:27:20 GMT&#39;,</span>\n<span class=\"go\"> b&#39;Server: nginx&#39;,</span>\n<span class=\"go\"> b&#39;Content-Type: text/html; charset=utf-8&#39;,</span>\n<span class=\"go\"> b&#39;X-Frame-Options: SAMEORIGIN&#39;,</span>\n<span class=\"go\"> b&#39;Content-Length: 45679&#39;,</span>\n<span class=\"go\"> b&#39;Accept-Ranges: bytes&#39;,</span>\n<span class=\"go\"> b&#39;Via: 1.1 varnish&#39;,</span>\n<span class=\"go\"> b&#39;Age: 2188&#39;,</span>\n<span class=\"go\"> b&#39;X-Served-By: cache-lcy1134-LCY&#39;,</span>\n<span class=\"go\"> b&#39;X-Cache: HIT&#39;,</span>\n<span class=\"go\"> b&#39;X-Cache-Hits: 11&#39;,</span>\n<span class=\"go\"> b&#39;Vary: Cookie&#39;,</span>\n<span class=\"go\"> b&#39;Strict-Transport-Security: max-age=63072000; includeSubDomains&#39;,</span>\n<span class=\"go\"> b&#39;Connection: close&#39;,</span>\n<span class=\"go\"> b&#39;&#39;,</span>\n<span class=\"go\"> b&#39;&#39;]</span>\n</pre></div>\n</div>\n<p>See the discussion of <a class=\"reference internal\" href=\"#ssl-security\"><span class=\"std std-ref\">Security considerations</span></a> below.</p>\n</section>\n<section id=\"server-side-operation\">\n<h3>Server-side operation<a class=\"headerlink\" href=\"#server-side-operation\" title=\"Link to this heading\">¶</a></h3>\n<p>For server operation, typically you’ll need to have a server certificate, and\nprivate key, each in a file.  You’ll first create a context holding the key\nand the certificate, so that clients can check your authenticity.  Then\nyou’ll open a socket, bind it to a port, call <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">listen()</span></code> on it, and start\nwaiting for clients to connect:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">socket</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"nn\">ssl</span>\n\n<span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">Purpose</span><span class=\"o\">.</span><span class=\"n\">CLIENT_AUTH</span><span class=\"p\">)</span>\n<span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">load_cert_chain</span><span class=\"p\">(</span><span class=\"n\">certfile</span><span class=\"o\">=</span><span class=\"s2\">&quot;mycertfile&quot;</span><span class=\"p\">,</span> <span class=\"n\">keyfile</span><span class=\"o\">=</span><span class=\"s2\">&quot;mykeyfile&quot;</span><span class=\"p\">)</span>\n\n<span class=\"n\">bindsocket</span> <span class=\"o\">=</span> <span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">socket</span><span class=\"p\">()</span>\n<span class=\"n\">bindsocket</span><span class=\"o\">.</span><span class=\"n\">bind</span><span class=\"p\">((</span><span class=\"s1\">&#39;myaddr.example.com&#39;</span><span class=\"p\">,</span> <span class=\"mi\">10023</span><span class=\"p\">))</span>\n<span class=\"n\">bindsocket</span><span class=\"o\">.</span><span class=\"n\">listen</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>When a client connects, you’ll call <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">accept()</span></code> on the socket to get the\nnew socket from the other end, and use the context’s <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_socket\" title=\"ssl.SSLContext.wrap_socket\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.wrap_socket()</span></code></a>\nmethod to create a server-side SSL socket for the connection:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">while</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n    <span class=\"n\">newsocket</span><span class=\"p\">,</span> <span class=\"n\">fromaddr</span> <span class=\"o\">=</span> <span class=\"n\">bindsocket</span><span class=\"o\">.</span><span class=\"n\">accept</span><span class=\"p\">()</span>\n    <span class=\"n\">connstream</span> <span class=\"o\">=</span> <span class=\"n\">context</span><span class=\"o\">.</span><span class=\"n\">wrap_socket</span><span class=\"p\">(</span><span class=\"n\">newsocket</span><span class=\"p\">,</span> <span class=\"n\">server_side</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"n\">deal_with_client</span><span class=\"p\">(</span><span class=\"n\">connstream</span><span class=\"p\">)</span>\n    <span class=\"k\">finally</span><span class=\"p\">:</span>\n        <span class=\"n\">connstream</span><span class=\"o\">.</span><span class=\"n\">shutdown</span><span class=\"p\">(</span><span class=\"n\">socket</span><span class=\"o\">.</span><span class=\"n\">SHUT_RDWR</span><span class=\"p\">)</span>\n        <span class=\"n\">connstream</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Then you’ll read data from the <code class=\"docutils literal notranslate\"><span class=\"pre\">connstream</span></code> and do something with it till you\nare finished with the client (or the client is finished with you):</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">deal_with_client</span><span class=\"p\">(</span><span class=\"n\">connstream</span><span class=\"p\">):</span>\n    <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">connstream</span><span class=\"o\">.</span><span class=\"n\">recv</span><span class=\"p\">(</span><span class=\"mi\">1024</span><span class=\"p\">)</span>\n    <span class=\"c1\"># empty data means the client is finished with us</span>\n    <span class=\"k\">while</span> <span class=\"n\">data</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">do_something</span><span class=\"p\">(</span><span class=\"n\">connstream</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">):</span>\n            <span class=\"c1\"># we&#39;ll assume do_something returns False</span>\n            <span class=\"c1\"># when we&#39;re finished with client</span>\n            <span class=\"k\">break</span>\n        <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">connstream</span><span class=\"o\">.</span><span class=\"n\">recv</span><span class=\"p\">(</span><span class=\"mi\">1024</span><span class=\"p\">)</span>\n    <span class=\"c1\"># finished with client</span>\n</pre></div>\n</div>\n<p>And go back to listening for new client connections (of course, a real server\nwould probably handle each client connection in a separate thread, or put\nthe sockets in <a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking mode</span></a> and use an event loop).</p>\n</section>\n</section>\n<section id=\"notes-on-non-blocking-sockets\">\n<span id=\"ssl-nonblocking\"></span><h2>Notes on non-blocking sockets<a class=\"headerlink\" href=\"#notes-on-non-blocking-sockets\" title=\"Link to this heading\">¶</a></h2>\n<p>SSL sockets behave slightly different than regular sockets in\nnon-blocking mode. When working with non-blocking sockets, there are\nthus several things you need to be aware of:</p>\n<ul>\n<li><p>Most <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> methods will raise either\n<a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a> or <a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> instead of\n<a class=\"reference internal\" href=\"exceptions.html#BlockingIOError\" title=\"BlockingIOError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">BlockingIOError</span></code></a> if an I/O operation would\nblock. <a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> will be raised if a read operation on\nthe underlying socket is necessary, and <a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a> for\na write operation on the underlying socket. Note that attempts to\n<em>write</em> to an SSL socket may require <em>reading</em> from the underlying\nsocket first, and attempts to <em>read</em> from the SSL socket may require\na prior <em>write</em> to the underlying socket.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.5: </span>In earlier Python versions, the <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.send()</span></code> method\nreturned zero instead of raising <a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a>.</p>\n</div>\n</li>\n<li><p>Calling <a class=\"reference internal\" href=\"select.html#select.select\" title=\"select.select\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">select()</span></code></a> tells you that the OS-level socket can be\nread from (or written to), but it does not imply that there is sufficient\ndata at the upper SSL layer.  For example, only part of an SSL frame might\nhave arrived.  Therefore, you must be ready to handle <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.recv()</span></code>\nand <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.send()</span></code> failures, and retry after another call to\n<a class=\"reference internal\" href=\"select.html#select.select\" title=\"select.select\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">select()</span></code></a>.</p></li>\n<li><p>Conversely, since the SSL layer has its own framing, a SSL socket may\nstill have data available for reading without <a class=\"reference internal\" href=\"select.html#select.select\" title=\"select.select\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">select()</span></code></a>\nbeing aware of it.  Therefore, you should first call\n<code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.recv()</span></code> to drain any potentially available data, and then\nonly block on a <a class=\"reference internal\" href=\"select.html#select.select\" title=\"select.select\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">select()</span></code></a> call if still necessary.</p>\n<p>(of course, similar provisions apply when using other primitives such as\n<a class=\"reference internal\" href=\"select.html#select.poll\" title=\"select.poll\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">poll()</span></code></a>, or those in the <a class=\"reference internal\" href=\"selectors.html#module-selectors\" title=\"selectors: High-level I/O multiplexing.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">selectors</span></code></a> module)</p>\n</li>\n<li><p>The SSL handshake itself will be non-blocking: the\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.do_handshake()</span></code></a> method has to be retried until it returns\nsuccessfully.  Here is a synopsis using <a class=\"reference internal\" href=\"select.html#select.select\" title=\"select.select\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">select()</span></code></a> to wait for\nthe socket’s readiness:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">while</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n    <span class=\"k\">try</span><span class=\"p\">:</span>\n        <span class=\"n\">sock</span><span class=\"o\">.</span><span class=\"n\">do_handshake</span><span class=\"p\">()</span>\n        <span class=\"k\">break</span>\n    <span class=\"k\">except</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLWantReadError</span><span class=\"p\">:</span>\n        <span class=\"n\">select</span><span class=\"o\">.</span><span class=\"n\">select</span><span class=\"p\">([</span><span class=\"n\">sock</span><span class=\"p\">],</span> <span class=\"p\">[],</span> <span class=\"p\">[])</span>\n    <span class=\"k\">except</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLWantWriteError</span><span class=\"p\">:</span>\n        <span class=\"n\">select</span><span class=\"o\">.</span><span class=\"n\">select</span><span class=\"p\">([],</span> <span class=\"p\">[</span><span class=\"n\">sock</span><span class=\"p\">],</span> <span class=\"p\">[])</span>\n</pre></div>\n</div>\n</li>\n</ul>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<p>The <a class=\"reference internal\" href=\"asyncio.html#module-asyncio\" title=\"asyncio: Asynchronous I/O.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">asyncio</span></code></a> module supports <a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking SSL sockets</span></a> and provides a higher level <a class=\"reference internal\" href=\"asyncio-stream.html#asyncio-streams\"><span class=\"std std-ref\">Streams API</span></a>.\nIt polls for events using the <a class=\"reference internal\" href=\"selectors.html#module-selectors\" title=\"selectors: High-level I/O multiplexing.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">selectors</span></code></a> module and\nhandles <a class=\"reference internal\" href=\"#ssl.SSLWantWriteError\" title=\"ssl.SSLWantWriteError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantWriteError</span></code></a>, <a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> and\n<a class=\"reference internal\" href=\"exceptions.html#BlockingIOError\" title=\"BlockingIOError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">BlockingIOError</span></code></a> exceptions. It runs the SSL handshake asynchronously\nas well.</p>\n</div>\n</section>\n<section id=\"memory-bio-support\">\n<h2>Memory BIO Support<a class=\"headerlink\" href=\"#memory-bio-support\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.5.</span></p>\n</div>\n<p>Ever since the SSL module was introduced in Python 2.6, the <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>\nclass has provided two related but distinct areas of functionality:</p>\n<ul class=\"simple\">\n<li><p>SSL protocol handling</p></li>\n<li><p>Network IO</p></li>\n</ul>\n<p>The network IO API is identical to that provided by <a class=\"reference internal\" href=\"socket.html#socket.socket\" title=\"socket.socket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">socket.socket</span></code></a>,\nfrom which <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> also inherits. This allows an SSL socket to be\nused as a drop-in replacement for a regular socket, making it very easy to add\nSSL support to an existing application.</p>\n<p>Combining SSL protocol handling and network IO usually works well, but there\nare some cases where it doesn’t. An example is async IO frameworks that want to\nuse a different IO multiplexing model than the “select/poll on a file\ndescriptor” (readiness based) model that is assumed by <a class=\"reference internal\" href=\"socket.html#socket.socket\" title=\"socket.socket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">socket.socket</span></code></a>\nand by the internal OpenSSL socket IO routines. This is mostly relevant for\nplatforms like Windows where this model is not efficient. For this purpose, a\nreduced scope variant of <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> called <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a> is\nprovided.</p>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLObject\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLObject</span></span><a class=\"headerlink\" href=\"#ssl.SSLObject\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A reduced-scope variant of <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> representing an SSL protocol\ninstance that does not contain any network IO methods. This class is\ntypically used by framework authors that want to implement asynchronous IO\nfor SSL through memory buffers.</p>\n<p>This class implements an interface on top of a low-level SSL object as\nimplemented by OpenSSL. This object captures the state of an SSL connection\nbut does not provide any network IO itself. IO needs to be performed through\nseparate “BIO” objects which are OpenSSL’s IO abstraction layer.</p>\n<p>This class has no public constructor.  An <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a> instance\nmust be created using the <a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_bio\" title=\"ssl.SSLContext.wrap_bio\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">wrap_bio()</span></code></a> method. This\nmethod will create the <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a> instance and bind it to a\npair of BIOs. The <em>incoming</em> BIO is used to pass data from Python to the\nSSL protocol instance, while the <em>outgoing</em> BIO is used to pass data the\nother way around.</p>\n<p>The following methods are available:</p>\n<ul class=\"simple\">\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.context\" title=\"ssl.SSLSocket.context\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">context</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.server_side\" title=\"ssl.SSLSocket.server_side\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">server_side</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.server_hostname\" title=\"ssl.SSLSocket.server_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">server_hostname</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.session\" title=\"ssl.SSLSocket.session\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">session</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.session_reused\" title=\"ssl.SSLSocket.session_reused\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">session_reused</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.read\" title=\"ssl.SSLSocket.read\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">read()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.write\" title=\"ssl.SSLSocket.write\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">write()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.getpeercert\" title=\"ssl.SSLSocket.getpeercert\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">getpeercert()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.get_verified_chain\" title=\"ssl.SSLSocket.get_verified_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_verified_chain()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.get_unverified_chain\" title=\"ssl.SSLSocket.get_unverified_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_unverified_chain()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.selected_alpn_protocol\" title=\"ssl.SSLSocket.selected_alpn_protocol\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">selected_alpn_protocol()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.selected_npn_protocol\" title=\"ssl.SSLSocket.selected_npn_protocol\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">selected_npn_protocol()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.cipher\" title=\"ssl.SSLSocket.cipher\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">cipher()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.shared_ciphers\" title=\"ssl.SSLSocket.shared_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">shared_ciphers()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.compression\" title=\"ssl.SSLSocket.compression\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">compression()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.pending\" title=\"ssl.SSLSocket.pending\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">pending()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">do_handshake()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.verify_client_post_handshake\" title=\"ssl.SSLSocket.verify_client_post_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">verify_client_post_handshake()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.unwrap\" title=\"ssl.SSLSocket.unwrap\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">unwrap()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.get_channel_binding\" title=\"ssl.SSLSocket.get_channel_binding\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">get_channel_binding()</span></code></a></p></li>\n<li><p><a class=\"reference internal\" href=\"#ssl.SSLSocket.version\" title=\"ssl.SSLSocket.version\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">version()</span></code></a></p></li>\n</ul>\n<p>When compared to <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a>, this object lacks the following\nfeatures:</p>\n<ul class=\"simple\">\n<li><p>Any form of network IO; <code class=\"docutils literal notranslate\"><span class=\"pre\">recv()</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">send()</span></code> read and write only to\nthe underlying <a class=\"reference internal\" href=\"#ssl.MemoryBIO\" title=\"ssl.MemoryBIO\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">MemoryBIO</span></code></a> buffers.</p></li>\n<li><p>There is no <em>do_handshake_on_connect</em> machinery. You must always manually\ncall <a class=\"reference internal\" href=\"#ssl.SSLSocket.do_handshake\" title=\"ssl.SSLSocket.do_handshake\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">do_handshake()</span></code></a> to start the handshake.</p></li>\n<li><p>There is no handling of <em>suppress_ragged_eofs</em>. All end-of-file conditions\nthat are in violation of the protocol are reported via the\n<a class=\"reference internal\" href=\"#ssl.SSLEOFError\" title=\"ssl.SSLEOFError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLEOFError</span></code></a> exception.</p></li>\n<li><p>The method <a class=\"reference internal\" href=\"#ssl.SSLSocket.unwrap\" title=\"ssl.SSLSocket.unwrap\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">unwrap()</span></code></a> call does not return anything,\nunlike for an SSL socket where it returns the underlying socket.</p></li>\n<li><p>The <em>server_name_callback</em> callback passed to\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_servername_callback\" title=\"ssl.SSLContext.set_servername_callback\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_servername_callback()</span></code></a> will get an <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>\ninstance instead of a <a class=\"reference internal\" href=\"#ssl.SSLSocket\" title=\"ssl.SSLSocket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSocket</span></code></a> instance as its first parameter.</p></li>\n</ul>\n<p>Some notes related to the use of <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a>:</p>\n<ul class=\"simple\">\n<li><p>All IO on an <a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a> is <a class=\"reference internal\" href=\"#ssl-nonblocking\"><span class=\"std std-ref\">non-blocking</span></a>.\nThis means that for example <a class=\"reference internal\" href=\"#ssl.SSLSocket.read\" title=\"ssl.SSLSocket.read\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">read()</span></code></a> will raise an\n<a class=\"reference internal\" href=\"#ssl.SSLWantReadError\" title=\"ssl.SSLWantReadError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">SSLWantReadError</span></code></a> if it needs more data than the incoming BIO has\navailable.</p></li>\n</ul>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span><a class=\"reference internal\" href=\"#ssl.SSLObject\" title=\"ssl.SSLObject\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLObject</span></code></a> instances must be created with\n<a class=\"reference internal\" href=\"#ssl.SSLContext.wrap_bio\" title=\"ssl.SSLContext.wrap_bio\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">wrap_bio()</span></code></a>. In earlier versions, it was possible to\ncreate instances directly. This was never documented or officially\nsupported.</p>\n</div>\n</dd></dl>\n\n<p>An SSLObject communicates with the outside world using memory buffers. The\nclass <a class=\"reference internal\" href=\"#ssl.MemoryBIO\" title=\"ssl.MemoryBIO\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">MemoryBIO</span></code></a> provides a memory buffer that can be used for this\npurpose.  It wraps an OpenSSL memory BIO (Basic IO) object:</p>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">MemoryBIO</span></span><a class=\"headerlink\" href=\"#ssl.MemoryBIO\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A memory buffer that can be used to pass data between Python and an SSL\nprotocol instance.</p>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO.pending\">\n<span class=\"sig-name descname\"><span class=\"pre\">pending</span></span><a class=\"headerlink\" href=\"#ssl.MemoryBIO.pending\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the number of bytes currently in the memory buffer.</p>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO.eof\">\n<span class=\"sig-name descname\"><span class=\"pre\">eof</span></span><a class=\"headerlink\" href=\"#ssl.MemoryBIO.eof\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A boolean indicating whether the memory BIO is current at the end-of-file\nposition.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO.read\">\n<span class=\"sig-name descname\"><span class=\"pre\">read</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">n</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">-1</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.MemoryBIO.read\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Read up to <em>n</em> bytes from the memory buffer. If <em>n</em> is not specified or\nnegative, all bytes are returned.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO.write\">\n<span class=\"sig-name descname\"><span class=\"pre\">write</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buf</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.MemoryBIO.write\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write the bytes from <em>buf</em> to the memory BIO. The <em>buf</em> argument must be an\nobject supporting the buffer protocol.</p>\n<p>The return value is the number of bytes written, which is always equal to\nthe length of <em>buf</em>.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"ssl.MemoryBIO.write_eof\">\n<span class=\"sig-name descname\"><span class=\"pre\">write_eof</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#ssl.MemoryBIO.write_eof\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write an EOF marker to the memory BIO. After this method has been called, it\nis illegal to call <a class=\"reference internal\" href=\"#ssl.MemoryBIO.write\" title=\"ssl.MemoryBIO.write\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">write()</span></code></a>. The attribute <a class=\"reference internal\" href=\"#ssl.MemoryBIO.eof\" title=\"ssl.MemoryBIO.eof\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">eof</span></code></a> will\nbecome true after all data currently in the buffer has been read.</p>\n</dd></dl>\n\n</dd></dl>\n\n</section>\n<section id=\"ssl-session\">\n<h2>SSL session<a class=\"headerlink\" href=\"#ssl-session\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.6.</span></p>\n</div>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">ssl.</span></span><span class=\"sig-name descname\"><span class=\"pre\">SSLSession</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Session object used by <a class=\"reference internal\" href=\"#ssl.SSLSocket.session\" title=\"ssl.SSLSocket.session\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">session</span></code></a>.</p>\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession.id\">\n<span class=\"sig-name descname\"><span class=\"pre\">id</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession.id\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession.time\">\n<span class=\"sig-name descname\"><span class=\"pre\">time</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession.time\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession.timeout\">\n<span class=\"sig-name descname\"><span class=\"pre\">timeout</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession.timeout\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession.ticket_lifetime_hint\">\n<span class=\"sig-name descname\"><span class=\"pre\">ticket_lifetime_hint</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession.ticket_lifetime_hint\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"ssl.SSLSession.has_ticket\">\n<span class=\"sig-name descname\"><span class=\"pre\">has_ticket</span></span><a class=\"headerlink\" href=\"#ssl.SSLSession.has_ticket\" title=\"Link to this definition\">¶</a></dt>\n<dd></dd></dl>\n\n</dd></dl>\n\n</section>\n<section id=\"security-considerations\">\n<span id=\"ssl-security\"></span><h2>Security considerations<a class=\"headerlink\" href=\"#security-considerations\" title=\"Link to this heading\">¶</a></h2>\n<section id=\"best-defaults\">\n<h3>Best defaults<a class=\"headerlink\" href=\"#best-defaults\" title=\"Link to this heading\">¶</a></h3>\n<p>For <strong>client use</strong>, if you don’t have any special requirements for your\nsecurity policy, it is highly recommended that you use the\n<a class=\"reference internal\" href=\"#ssl.create_default_context\" title=\"ssl.create_default_context\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">create_default_context()</span></code></a> function to create your SSL context.\nIt will load the system’s trusted CA certificates, enable certificate\nvalidation and hostname checking, and try to choose reasonably secure\nprotocol and cipher settings.</p>\n<p>For example, here is how you would use the <a class=\"reference internal\" href=\"smtplib.html#smtplib.SMTP\" title=\"smtplib.SMTP\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">smtplib.SMTP</span></code></a> class to\ncreate a trusted, secure connection to a SMTP server:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">ssl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"nn\">smtplib</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">smtp</span> <span class=\"o\">=</span> <span class=\"n\">smtplib</span><span class=\"o\">.</span><span class=\"n\">SMTP</span><span class=\"p\">(</span><span class=\"s2\">&quot;mail.python.org&quot;</span><span class=\"p\">,</span> <span class=\"n\">port</span><span class=\"o\">=</span><span class=\"mi\">587</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">create_default_context</span><span class=\"p\">()</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">smtp</span><span class=\"o\">.</span><span class=\"n\">starttls</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"o\">=</span><span class=\"n\">context</span><span class=\"p\">)</span>\n<span class=\"go\">(220, b&#39;2.0.0 Ready to start TLS&#39;)</span>\n</pre></div>\n</div>\n<p>If a client certificate is needed for the connection, it can be added with\n<a class=\"reference internal\" href=\"#ssl.SSLContext.load_cert_chain\" title=\"ssl.SSLContext.load_cert_chain\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.load_cert_chain()</span></code></a>.</p>\n<p>By contrast, if you create the SSL context by calling the <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a>\nconstructor yourself, it will not have certificate validation nor hostname\nchecking enabled by default.  If you do so, please read the paragraphs below\nto achieve a good security level.</p>\n</section>\n<section id=\"manual-settings\">\n<h3>Manual settings<a class=\"headerlink\" href=\"#manual-settings\" title=\"Link to this heading\">¶</a></h3>\n<section id=\"verifying-certificates\">\n<h4>Verifying certificates<a class=\"headerlink\" href=\"#verifying-certificates\" title=\"Link to this heading\">¶</a></h4>\n<p>When calling the <a class=\"reference internal\" href=\"#ssl.SSLContext\" title=\"ssl.SSLContext\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLContext</span></code></a> constructor directly,\n<a class=\"reference internal\" href=\"#ssl.CERT_NONE\" title=\"ssl.CERT_NONE\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_NONE</span></code></a> is the default.  Since it does not authenticate the other\npeer, it can be insecure, especially in client mode where most of the time you\nwould like to ensure the authenticity of the server you’re talking to.\nTherefore, when in client mode, it is highly recommended to use\n<a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a>.  However, it is in itself not sufficient; you also\nhave to check that the server certificate, which can be obtained by calling\n<a class=\"reference internal\" href=\"#ssl.SSLSocket.getpeercert\" title=\"ssl.SSLSocket.getpeercert\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLSocket.getpeercert()</span></code></a>, matches the desired service.  For many\nprotocols and applications, the service can be identified by the hostname.\nThis common check is automatically performed when\n<a class=\"reference internal\" href=\"#ssl.SSLContext.check_hostname\" title=\"ssl.SSLContext.check_hostname\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLContext.check_hostname</span></code></a> is enabled.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.7: </span>Hostname matchings is now performed by OpenSSL. Python no longer uses\n<code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">match_hostname()</span></code>.</p>\n</div>\n<p>In server mode, if you want to authenticate your clients using the SSL layer\n(rather than using a higher-level authentication mechanism), you’ll also have\nto specify <a class=\"reference internal\" href=\"#ssl.CERT_REQUIRED\" title=\"ssl.CERT_REQUIRED\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">CERT_REQUIRED</span></code></a> and similarly check the client certificate.</p>\n</section>\n<section id=\"protocol-versions\">\n<h4>Protocol versions<a class=\"headerlink\" href=\"#protocol-versions\" title=\"Link to this heading\">¶</a></h4>\n<p>SSL versions 2 and 3 are considered insecure and are therefore dangerous to\nuse.  If you want maximum compatibility between clients and servers, it is\nrecommended to use <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a> or\n<a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_SERVER\" title=\"ssl.PROTOCOL_TLS_SERVER\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_SERVER</span></code></a> as the protocol version. SSLv2 and SSLv3 are\ndisabled by default.</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">client_context</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">SSLContext</span><span class=\"p\">(</span><span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">PROTOCOL_TLS_CLIENT</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">client_context</span><span class=\"o\">.</span><span class=\"n\">minimum_version</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">TLSVersion</span><span class=\"o\">.</span><span class=\"n\">TLSv1_3</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">client_context</span><span class=\"o\">.</span><span class=\"n\">maximum_version</span> <span class=\"o\">=</span> <span class=\"n\">ssl</span><span class=\"o\">.</span><span class=\"n\">TLSVersion</span><span class=\"o\">.</span><span class=\"n\">TLSv1_3</span>\n</pre></div>\n</div>\n<p>The SSL context created above will only allow TLSv1.3 and later (if\nsupported by your system) connections to a server. <a class=\"reference internal\" href=\"#ssl.PROTOCOL_TLS_CLIENT\" title=\"ssl.PROTOCOL_TLS_CLIENT\"><code class=\"xref py py-const docutils literal notranslate\"><span class=\"pre\">PROTOCOL_TLS_CLIENT</span></code></a>\nimplies certificate validation and hostname checks by default. You have to\nload certificates into the context.</p>\n</section>\n<section id=\"cipher-selection\">\n<h4>Cipher selection<a class=\"headerlink\" href=\"#cipher-selection\" title=\"Link to this heading\">¶</a></h4>\n<p>If you have advanced security requirements, fine-tuning of the ciphers\nenabled when negotiating a SSL session is possible through the\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_ciphers\" title=\"ssl.SSLContext.set_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_ciphers()</span></code></a> method.  Starting from Python 3.2.3, the\nssl module disables certain weak ciphers by default, but you may want\nto further restrict the cipher choice. Be sure to read OpenSSL’s documentation\nabout the <a class=\"reference external\" href=\"https://docs.openssl.org/1.1.1/man1/ciphers/#cipher-list-format\">cipher list format</a>.\nIf you want to check which ciphers are enabled by a given cipher list, use\n<a class=\"reference internal\" href=\"#ssl.SSLContext.get_ciphers\" title=\"ssl.SSLContext.get_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.get_ciphers()</span></code></a> or the <code class=\"docutils literal notranslate\"><span class=\"pre\">openssl</span> <span class=\"pre\">ciphers</span></code> command on your\nsystem.</p>\n</section>\n</section>\n<section id=\"multi-processing\">\n<h3>Multi-processing<a class=\"headerlink\" href=\"#multi-processing\" title=\"Link to this heading\">¶</a></h3>\n<p>If using this module as part of a multi-processed application (using,\nfor example the <a class=\"reference internal\" href=\"multiprocessing.html#module-multiprocessing\" title=\"multiprocessing: Process-based parallelism.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">multiprocessing</span></code></a> or <a class=\"reference internal\" href=\"concurrent.futures.html#module-concurrent.futures\" title=\"concurrent.futures: Execute computations concurrently using threads or processes.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">concurrent.futures</span></code></a> modules),\nbe aware that OpenSSL’s internal random number generator does not properly\nhandle forked processes.  Applications must change the PRNG state of the\nparent process if they use any SSL feature with <a class=\"reference internal\" href=\"os.html#os.fork\" title=\"os.fork\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">os.fork()</span></code></a>.  Any\nsuccessful call of <a class=\"reference internal\" href=\"#ssl.RAND_add\" title=\"ssl.RAND_add\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">RAND_add()</span></code></a> or <a class=\"reference internal\" href=\"#ssl.RAND_bytes\" title=\"ssl.RAND_bytes\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">RAND_bytes()</span></code></a> is\nsufficient.</p>\n</section>\n</section>\n<section id=\"tls-1-3\">\n<span id=\"ssl-tlsv1-3\"></span><h2>TLS 1.3<a class=\"headerlink\" href=\"#tls-1-3\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.7.</span></p>\n</div>\n<p>The TLS 1.3 protocol behaves slightly differently than previous version\nof TLS/SSL. Some new TLS 1.3 features are not yet available.</p>\n<ul class=\"simple\">\n<li><p>TLS 1.3 uses a disjunct set of cipher suites. All AES-GCM and\nChaCha20 cipher suites are enabled by default.  The method\n<a class=\"reference internal\" href=\"#ssl.SSLContext.set_ciphers\" title=\"ssl.SSLContext.set_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.set_ciphers()</span></code></a> cannot enable or disable any TLS 1.3\nciphers yet, but <a class=\"reference internal\" href=\"#ssl.SSLContext.get_ciphers\" title=\"ssl.SSLContext.get_ciphers\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">SSLContext.get_ciphers()</span></code></a> returns them.</p></li>\n<li><p>Session tickets are no longer sent as part of the initial handshake and\nare handled differently.  <a class=\"reference internal\" href=\"#ssl.SSLSocket.session\" title=\"ssl.SSLSocket.session\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">SSLSocket.session</span></code></a> and <a class=\"reference internal\" href=\"#ssl.SSLSession\" title=\"ssl.SSLSession\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">SSLSession</span></code></a>\nare not compatible with TLS 1.3.</p></li>\n<li><p>Client-side certificates are also no longer verified during the initial\nhandshake.  A server can request a certificate at any time.  Clients\nprocess certificate requests while they send or receive application data\nfrom the server.</p></li>\n<li><p>TLS 1.3 features like early data, deferred TLS client cert request,\nsignature algorithm configuration, and rekeying are not supported yet.</p></li>\n</ul>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<dl class=\"simple\">\n<dt>Class <a class=\"reference internal\" href=\"socket.html#socket.socket\" title=\"socket.socket\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">socket.socket</span></code></a></dt><dd><p>Documentation of underlying <a class=\"reference internal\" href=\"socket.html#module-socket\" title=\"socket: Low-level networking interface.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">socket</span></code></a> class</p>\n</dd>\n<dt><a class=\"reference external\" href=\"https://httpd.apache.org/docs/trunk/en/ssl/ssl_intro.html\">SSL/TLS Strong Encryption: An Introduction</a></dt><dd><p>Intro from the Apache HTTP Server documentation</p>\n</dd>\n<dt><span class=\"target\" id=\"index-19\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc1422.html\"><strong>RFC 1422: Privacy Enhancement for Internet Electronic Mail: Part II: Certificate-Based Key Management</strong></a></dt><dd><p>Steve Kent</p>\n</dd>\n<dt><span class=\"target\" id=\"index-20\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc4086.html\"><strong>RFC 4086: Randomness Requirements for Security</strong></a></dt><dd><p>Donald E., Jeffrey I. Schiller</p>\n</dd>\n<dt><span class=\"target\" id=\"index-21\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5280.html\"><strong>RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</strong></a></dt><dd><p>D. Cooper</p>\n</dd>\n<dt><span class=\"target\" id=\"index-22\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc5246.html\"><strong>RFC 5246: The Transport Layer Security (TLS) Protocol Version 1.2</strong></a></dt><dd><p>T. Dierks et. al.</p>\n</dd>\n<dt><span class=\"target\" id=\"index-23\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc6066.html\"><strong>RFC 6066: Transport Layer Security (TLS) Extensions</strong></a></dt><dd><p>D. Eastlake</p>\n</dd>\n<dt><a class=\"reference external\" href=\"https://www.iana.org/assignments/tls-parameters/tls-parameters.xml\">IANA TLS: Transport Layer Security (TLS) Parameters</a></dt><dd><p>IANA</p>\n</dd>\n<dt><span class=\"target\" id=\"index-24\"></span><a class=\"rfc reference external\" href=\"https://datatracker.ietf.org/doc/html/rfc7525.html\"><strong>RFC 7525: Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</strong></a></dt><dd><p>IETF</p>\n</dd>\n<dt><a class=\"reference external\" href=\"https://wiki.mozilla.org/Security/Server_Side_TLS\">Mozilla’s Server Side TLS recommendations</a></dt><dd><p>Mozilla</p>\n</dd>\n</dl>\n</div>\n</section>\n</section>\n\n\n            <div class=\"clearer\"></div>\n          </div>\n        </div>\n      </div>\n      <div class=\"sphinxsidebar\" role=\"navigation\" aria-label=\"Main\">\n        <div class=\"sphinxsidebarwrapper\">\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code> — TLS/SSL wrapper for socket objects</a><ul>\n<li><a class=\"reference internal\" href=\"#functions-constants-and-exceptions\">Functions, Constants, and Exceptions</a><ul>\n<li><a class=\"reference internal\" href=\"#socket-creation\">Socket creation</a></li>\n<li><a class=\"reference internal\" href=\"#context-creation\">Context creation</a></li>\n<li><a class=\"reference internal\" href=\"#exceptions\">Exceptions</a></li>\n<li><a class=\"reference internal\" href=\"#random-generation\">Random generation</a></li>\n<li><a class=\"reference internal\" href=\"#certificate-handling\">Certificate handling</a></li>\n<li><a class=\"reference internal\" href=\"#constants\">Constants</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#ssl-sockets\">SSL Sockets</a></li>\n<li><a class=\"reference internal\" href=\"#ssl-contexts\">SSL Contexts</a></li>\n<li><a class=\"reference internal\" href=\"#certificates\">Certificates</a><ul>\n<li><a class=\"reference internal\" href=\"#certificate-chains\">Certificate chains</a></li>\n<li><a class=\"reference internal\" href=\"#ca-certificates\">CA certificates</a></li>\n<li><a class=\"reference internal\" href=\"#combined-key-and-certificate\">Combined key and certificate</a></li>\n<li><a class=\"reference internal\" href=\"#self-signed-certificates\">Self-signed certificates</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#examples\">Examples</a><ul>\n<li><a class=\"reference internal\" href=\"#testing-for-ssl-support\">Testing for SSL support</a></li>\n<li><a class=\"reference internal\" href=\"#client-side-operation\">Client-side operation</a></li>\n<li><a class=\"reference internal\" href=\"#server-side-operation\">Server-side operation</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#notes-on-non-blocking-sockets\">Notes on non-blocking sockets</a></li>\n<li><a class=\"reference internal\" href=\"#memory-bio-support\">Memory BIO Support</a></li>\n<li><a class=\"reference internal\" href=\"#ssl-session\">SSL session</a></li>\n<li><a class=\"reference internal\" href=\"#security-considerations\">Security considerations</a><ul>\n<li><a class=\"reference internal\" href=\"#best-defaults\">Best defaults</a></li>\n<li><a class=\"reference internal\" href=\"#manual-settings\">Manual settings</a><ul>\n<li><a class=\"reference internal\" href=\"#verifying-certificates\">Verifying certificates</a></li>\n<li><a class=\"reference internal\" href=\"#protocol-versions\">Protocol versions</a></li>\n<li><a class=\"reference internal\" href=\"#cipher-selection\">Cipher selection</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#multi-processing\">Multi-processing</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#tls-1-3\">TLS 1.3</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"socket.html\"\n                          title=\"previous chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">socket</span></code> — Low-level networking interface</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"select.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">select</span></code> — Waiting for I/O completion</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/ssl.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </div>\n<div id=\"sidebarbutton\" title=\"Collapse sidebar\">\n<span>«</span>\n</div>\n\n      </div>\n      <div class=\"clearer\"></div>\n    </div>  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             >index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"select.html\" title=\"select — Waiting for I/O completion\"\n             >next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"socket.html\" title=\"socket — Low-level networking interface\"\n             >previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"ipc.html\" >Networking and Interprocess Communication</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">ssl</span></code> — TLS/SSL wrapper for socket objects</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>  \n    <div class=\"footer\">\n    &copy; <a href=\"../copyright.html\">Copyright</a> 2001 Python Software Foundation.\n    <br>\n    This page is licensed under the Python Software Foundation License Version 2.\n    <br>\n    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.\n    <br>\n    \n      See <a href=\"/license.html\">History and License</a> for more information.<br>\n    \n    \n    <br>\n\n    The Python Software Foundation is a non-profit corporation.\n<a href=\"https://www.python.org/psf/donations/\">Please donate.</a>\n<br>\n    <br>\n      Last updated on Nov 25, 2025 (18:01 UTC).\n    \n      <a href=\"/bugs.html\">Found a bug</a>?\n    \n    <br>\n\n    Created using <a href=\"https://www.sphinx-doc.org/\">Sphinx</a> 8.2.3.\n    </div>\n\n    <script type=\"text/javascript\" src=\"../_static/switchers.js\"></script>\n  </body>\n</html>",
  "metadata": {
    "title": "ssl — TLS/SSL wrapper for socket objects — Python 3.14.0 documentation",
    "meta_description": "Source code: Lib/ssl.py This module provides access to Transport Layer Security (often known as “Secure Sockets Layer”) encryption and peer authentication facilities for network sockets, both clien...",
    "h1": "— TLS/SSL wrapper for socket objects"
  },
  "request_headers": {
    "Referer": "https://docs.python.org/3/library/",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en",
    "User-Agent": "DumbCrawler/1.0",
    "Accept-Encoding": "gzip, deflate"
  },
  "response_headers": {
    "Content-Length": "49966",
    "Server": "nginx",
    "Content-Type": "text/html",
    "Last-Modified": "Tue, 25 Nov 2025 18:03:26 GMT",
    "Etag": "\"6925ef6e-54870\"",
    "X-Clacks-Overhead": "GNU Terry Pratchett",
    "Strict-Transport-Security": "max-age=315360000; includeSubDomains; preload",
    "Via": "1.1 varnish, 1.1 varnish",
    "Accept-Ranges": "bytes",
    "Age": "3986",
    "Date": "Wed, 26 Nov 2025 05:32:32 GMT",
    "X-Served-By": "cache-lga21957-LGA, cache-yul1970022-YUL",
    "X-Cache": "HIT, HIT",
    "X-Cache-Hits": "123, 0",
    "X-Timer": "S1764135153.944732,VS0,VE1",
    "Vary": "Accept-Encoding"
  },
  "crawled_at": "2025-11-26T05:32:33.616798+00:00",
  "crawler": {
    "name": "DumbCrawler",
    "version": "1.0",
    "mode": "crawl",
    "js_mode": "off",
    "scope": "subfolder"
  }
}