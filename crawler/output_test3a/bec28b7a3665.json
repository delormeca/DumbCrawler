{
  "url": "https://docs.python.org/3/library/pickle.html",
  "status_code": 200,
  "depth": 1,
  "referrer": "https://docs.python.org/3/library/",
  "raw_html": "<!DOCTYPE html>\n\n<html lang=\"en\" data-content_root=\"../\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<meta property=\"og:title\" content=\"pickle — Python object serialization\" />\n<meta property=\"og:type\" content=\"website\" />\n<meta property=\"og:url\" content=\"https://docs.python.org/3/library/pickle.html\" />\n<meta property=\"og:site_name\" content=\"Python documentation\" />\n<meta property=\"og:description\" content=\"Source code: Lib/pickle.py The pickle module implements binary protocols for serializing and de-serializing a Python object structure. “Pickling” is the process whereby a Python object hierarchy is...\" />\n<meta property=\"og:image:width\" content=\"1146\" />\n<meta property=\"og:image:height\" content=\"600\" />\n<meta property=\"og:image\" content=\"https://docs.python.org/3.14/_images/social_previews/summary_library_pickle_60b2042b.png\" />\n<meta property=\"og:image:alt\" content=\"Source code: Lib/pickle.py The pickle module implements binary protocols for serializing and de-serializing a Python object structure. “Pickling” is the process whereby a Python object hierarchy is...\" />\n<meta name=\"description\" content=\"Source code: Lib/pickle.py The pickle module implements binary protocols for serializing and de-serializing a Python object structure. “Pickling” is the process whereby a Python object hierarchy is...\" />\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"theme-color\" content=\"#3776ab\">\n\n    <title>pickle — Python object serialization &#8212; Python 3.14.0 documentation</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    \n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments.css?v=b86133f3\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/classic.css?v=234b1a7c\" />\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pydoctheme.css?v=8cd84f99\" />\n    <link id=\"pygments_dark_css\" media=\"(prefers-color-scheme: dark)\" rel=\"stylesheet\" type=\"text/css\" href=\"../_static/pygments_dark.css?v=5349f25f\" />\n    \n    <script src=\"../_static/documentation_options.js?v=e4f4b189\"></script>\n    <script src=\"../_static/doctools.js?v=9bcbadda\"></script>\n    <script src=\"../_static/sphinx_highlight.js?v=dc90522c\"></script>\n    \n    <script src=\"../_static/sidebar.js\"></script>\n    \n    <link rel=\"search\" type=\"application/opensearchdescription+xml\"\n          title=\"Search within Python 3.14.0 documentation\"\n          href=\"../_static/opensearch.xml\"/>\n    <link rel=\"author\" title=\"About these documents\" href=\"../about.html\" />\n    <link rel=\"index\" title=\"Index\" href=\"../genindex.html\" />\n    <link rel=\"search\" title=\"Search\" href=\"../search.html\" />\n    <link rel=\"copyright\" title=\"Copyright\" href=\"../copyright.html\" />\n    <link rel=\"next\" title=\"copyreg — Register pickle support functions\" href=\"copyreg.html\" />\n    <link rel=\"prev\" title=\"Data Persistence\" href=\"persistence.html\" />\n    \n      \n      <script defer file-types=\"bz2,epub,zip\" data-domain=\"docs.python.org\" src=\"https://analytics.python.org/js/script.file-downloads.outbound-links.js\"></script>\n      \n      <link rel=\"canonical\" href=\"https://docs.python.org/3/library/pickle.html\">\n      \n    \n\n    \n    <style>\n      @media only screen {\n        table.full-width-table {\n            width: 100%;\n        }\n      }\n    </style>\n<link rel=\"stylesheet\" href=\"../_static/pydoctheme_dark.css\" media=\"(prefers-color-scheme: dark)\" id=\"pydoctheme_dark_css\">\n    <link rel=\"shortcut icon\" type=\"image/png\" href=\"../_static/py.svg\">\n            <script type=\"text/javascript\" src=\"../_static/copybutton.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/menu.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/search-focus.js\"></script>\n            <script type=\"text/javascript\" src=\"../_static/themetoggle.js\"></script> \n            <script type=\"text/javascript\" src=\"../_static/rtd_switcher.js\"></script>\n            <meta name=\"readthedocs-addons-api-version\" content=\"1\">\n\n  </head>\n<body>\n<div class=\"mobile-nav\">\n    <input type=\"checkbox\" id=\"menuToggler\" class=\"toggler__input\" aria-controls=\"navigation\"\n           aria-pressed=\"false\" aria-expanded=\"false\" role=\"button\" aria-label=\"Menu\">\n    <nav class=\"nav-content\" role=\"navigation\">\n        <label for=\"menuToggler\" class=\"toggler__label\">\n            <span></span>\n        </label>\n        <span class=\"nav-items-wrapper\">\n            <a href=\"https://www.python.org/\" class=\"nav-logo\">\n                <img src=\"../_static/py.svg\" alt=\"Python logo\">\n            </a>\n            <span class=\"version_switcher_placeholder\"></span>\n            <form role=\"search\" class=\"search\" action=\"../search.html\" method=\"get\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" class=\"search-icon\">\n                    <path fill-rule=\"nonzero\" fill=\"currentColor\" d=\"M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path>\n                </svg>\n                <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\">\n                <input type=\"submit\" value=\"Go\">\n            </form>\n        </span>\n    </nav>\n    <div class=\"menu-wrapper\">\n        <nav class=\"menu\" role=\"navigation\" aria-label=\"main navigation\">\n            <div class=\"language_switcher_placeholder\"></div>\n            \n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label>\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> — Python object serialization</a><ul>\n<li><a class=\"reference internal\" href=\"#relationship-to-other-python-modules\">Relationship to other Python modules</a><ul>\n<li><a class=\"reference internal\" href=\"#comparison-with-marshal\">Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#comparison-with-json\">Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">json</span></code></a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#data-stream-format\">Data stream format</a></li>\n<li><a class=\"reference internal\" href=\"#module-interface\">Module Interface</a></li>\n<li><a class=\"reference internal\" href=\"#what-can-be-pickled-and-unpickled\">What can be pickled and unpickled?</a></li>\n<li><a class=\"reference internal\" href=\"#pickling-class-instances\">Pickling Class Instances</a><ul>\n<li><a class=\"reference internal\" href=\"#persistence-of-external-objects\">Persistence of External Objects</a></li>\n<li><a class=\"reference internal\" href=\"#dispatch-tables\">Dispatch Tables</a></li>\n<li><a class=\"reference internal\" href=\"#handling-stateful-objects\">Handling Stateful Objects</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#custom-reduction-for-types-functions-and-other-objects\">Custom Reduction for Types, Functions, and Other Objects</a></li>\n<li><a class=\"reference internal\" href=\"#out-of-band-buffers\">Out-of-band Buffers</a><ul>\n<li><a class=\"reference internal\" href=\"#provider-api\">Provider API</a></li>\n<li><a class=\"reference internal\" href=\"#consumer-api\">Consumer API</a></li>\n<li><a class=\"reference internal\" href=\"#example\">Example</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#restricting-globals\">Restricting Globals</a></li>\n<li><a class=\"reference internal\" href=\"#performance\">Performance</a></li>\n<li><a class=\"reference internal\" href=\"#examples\">Examples</a></li>\n<li><a class=\"reference internal\" href=\"#command-line-interface\">Command-line interface</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"persistence.html\"\n                          title=\"previous chapter\">Data Persistence</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"copyreg.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code> — Register <code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> support functions</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/pickle.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </nav>\n    </div>\n</div>\n\n  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             accesskey=\"I\">index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"copyreg.html\" title=\"copyreg — Register pickle support functions\"\n             accesskey=\"N\">next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"persistence.html\" title=\"Data Persistence\"\n             accesskey=\"P\">previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"persistence.html\" accesskey=\"U\">Data Persistence</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> — Python object serialization</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>    \n\n    <div class=\"document\">\n      <div class=\"documentwrapper\">\n        <div class=\"bodywrapper\">\n          <div class=\"body\" role=\"main\">\n            \n  <section id=\"module-pickle\">\n<span id=\"pickle-python-object-serialization\"></span><h1><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> — Python object serialization<a class=\"headerlink\" href=\"#module-pickle\" title=\"Link to this heading\">¶</a></h1>\n<p><strong>Source code:</strong> <a class=\"extlink-source reference external\" href=\"https://github.com/python/cpython/tree/3.14/Lib/pickle.py\">Lib/pickle.py</a></p>\n<hr class=\"docutils\" id=\"index-0\" />\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module implements binary protocols for serializing and\nde-serializing a Python object structure.  <em>“Pickling”</em> is the process\nwhereby a Python object hierarchy is converted into a byte stream, and\n<em>“unpickling”</em> is the inverse operation, whereby a byte stream\n(from a <a class=\"reference internal\" href=\"../glossary.html#term-binary-file\"><span class=\"xref std std-term\">binary file</span></a> or <a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a>) is converted\nback into an object hierarchy.  Pickling (and unpickling) is alternatively\nknown as “serialization”, “marshalling,” <a class=\"footnote-reference brackets\" href=\"#id7\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> or “flattening”; however, to\navoid confusion, the terms used here are “pickling” and “unpickling”.</p>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">pickle</span></code> module <strong>is not secure</strong>. Only unpickle data you trust.</p>\n<p>It is possible to construct malicious pickle data which will <strong>execute\narbitrary code during unpickling</strong>. Never unpickle data that could have come\nfrom an untrusted source, or that could have been tampered with.</p>\n<p>Consider signing data with <a class=\"reference internal\" href=\"hmac.html#module-hmac\" title=\"hmac: Keyed-Hashing for Message Authentication (HMAC) implementation\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">hmac</span></code></a> if you need to ensure that it has not\nbeen tampered with.</p>\n<p>Safer serialization formats such as <a class=\"reference internal\" href=\"json.html#module-json\" title=\"json: Encode and decode the JSON format.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">json</span></code></a> may be more appropriate if\nyou are processing untrusted data. See <a class=\"reference internal\" href=\"#comparison-with-json\"><span class=\"std std-ref\">Comparison with json</span></a>.</p>\n</div>\n<section id=\"relationship-to-other-python-modules\">\n<h2>Relationship to other Python modules<a class=\"headerlink\" href=\"#relationship-to-other-python-modules\" title=\"Link to this heading\">¶</a></h2>\n<section id=\"comparison-with-marshal\">\n<h3>Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">marshal</span></code><a class=\"headerlink\" href=\"#comparison-with-marshal\" title=\"Link to this heading\">¶</a></h3>\n<p>Python has a more primitive serialization module called <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a>, but in\ngeneral <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> should always be the preferred way to serialize Python\nobjects.  <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> exists primarily to support Python’s <code class=\"file docutils literal notranslate\"><span class=\"pre\">.pyc</span></code>\nfiles.</p>\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module differs from <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> in several significant ways:</p>\n<ul>\n<li><p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module keeps track of the objects it has already serialized,\nso that later references to the same object won’t be serialized again.\n<a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> doesn’t do this.</p>\n<p>This has implications both for recursive objects and object sharing.  Recursive\nobjects are objects that contain references to themselves.  These are not\nhandled by marshal, and in fact, attempting to marshal recursive objects will\ncrash your Python interpreter.  Object sharing happens when there are multiple\nreferences to the same object in different places in the object hierarchy being\nserialized.  <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> stores such objects only once, and ensures that all\nother references point to the master copy.  Shared objects remain shared, which\ncan be very important for mutable objects.</p>\n</li>\n<li><p><a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> cannot be used to serialize user-defined classes and their\ninstances.  <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> can save and restore class instances transparently,\nhowever the class definition must be importable and live in the same module as\nwhen the object was stored.</p></li>\n<li><p>The <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> serialization format is not guaranteed to be portable\nacross Python versions.  Because its primary job in life is to support\n<code class=\"file docutils literal notranslate\"><span class=\"pre\">.pyc</span></code> files, the Python implementers reserve the right to change the\nserialization format in non-backwards compatible ways should the need arise.\nThe <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> serialization format is guaranteed to be backwards compatible\nacross Python releases provided a compatible pickle protocol is chosen and\npickling and unpickling code deals with Python 2 to Python 3 type differences\nif your data is crossing that unique breaking change language boundary.</p></li>\n</ul>\n</section>\n<section id=\"comparison-with-json\">\n<span id=\"id2\"></span><h3>Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">json</span></code><a class=\"headerlink\" href=\"#comparison-with-json\" title=\"Link to this heading\">¶</a></h3>\n<p>There are fundamental differences between the pickle protocols and\n<a class=\"reference external\" href=\"https://json.org\">JSON (JavaScript Object Notation)</a>:</p>\n<ul class=\"simple\">\n<li><p>JSON is a text serialization format (it outputs unicode text, although\nmost of the time it is then encoded to <code class=\"docutils literal notranslate\"><span class=\"pre\">utf-8</span></code>), while pickle is\na binary serialization format;</p></li>\n<li><p>JSON is human-readable, while pickle is not;</p></li>\n<li><p>JSON is interoperable and widely used outside of the Python ecosystem,\nwhile pickle is Python-specific;</p></li>\n<li><p>JSON, by default, can only represent a subset of the Python built-in\ntypes, and no custom classes; pickle can represent an extremely large\nnumber of Python types (many of them automatically, by clever usage\nof Python’s introspection facilities; complex cases can be tackled by\nimplementing <a class=\"reference internal\" href=\"#pickle-inst\"><span class=\"std std-ref\">specific object APIs</span></a>);</p></li>\n<li><p>Unlike pickle, deserializing untrusted JSON does not in itself create an\narbitrary code execution vulnerability.</p></li>\n</ul>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<p>The <a class=\"reference internal\" href=\"json.html#module-json\" title=\"json: Encode and decode the JSON format.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">json</span></code></a> module: a standard library module allowing JSON\nserialization and deserialization.</p>\n</div>\n</section>\n</section>\n<section id=\"data-stream-format\">\n<span id=\"pickle-protocols\"></span><h2>Data stream format<a class=\"headerlink\" href=\"#data-stream-format\" title=\"Link to this heading\">¶</a></h2>\n<p id=\"index-1\">The data format used by <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> is Python-specific.  This has the\nadvantage that there are no restrictions imposed by external standards such as\nJSON (which can’t represent pointer sharing); however it means that\nnon-Python programs may not be able to reconstruct pickled Python objects.</p>\n<p>By default, the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> data format uses a relatively compact binary\nrepresentation.  If you need optimal size characteristics, you can efficiently\n<a class=\"reference internal\" href=\"archiving.html\"><span class=\"doc\">compress</span></a> pickled data.</p>\n<p>The module <a class=\"reference internal\" href=\"pickletools.html#module-pickletools\" title=\"pickletools: Contains extensive comments about the pickle protocols and pickle-machine opcodes, as well as some useful functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickletools</span></code></a> contains tools for analyzing data streams\ngenerated by <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a>.  <a class=\"reference internal\" href=\"pickletools.html#module-pickletools\" title=\"pickletools: Contains extensive comments about the pickle protocols and pickle-machine opcodes, as well as some useful functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickletools</span></code></a> source code has extensive\ncomments about opcodes used by pickle protocols.</p>\n<p>There are currently 6 different protocols which can be used for pickling.\nThe higher the protocol used, the more recent the version of Python needed\nto read the pickle produced.</p>\n<ul class=\"simple\">\n<li><p>Protocol version 0 is the original “human-readable” protocol and is\nbackwards compatible with earlier versions of Python.</p></li>\n<li><p>Protocol version 1 is an old binary format which is also compatible with\nearlier versions of Python.</p></li>\n<li><p>Protocol version 2 was introduced in Python 2.3.  It provides much more\nefficient pickling of <a class=\"reference internal\" href=\"../glossary.html#term-new-style-class\"><span class=\"xref std std-term\">new-style classes</span></a>.  Refer to <span class=\"target\" id=\"index-2\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-0307/\"><strong>PEP 307</strong></a> for\ninformation about improvements brought by protocol 2.</p></li>\n<li><p>Protocol version 3 was added in Python 3.0.  It has explicit support for\n<a class=\"reference internal\" href=\"stdtypes.html#bytes\" title=\"bytes\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytes</span></code></a> objects and cannot be unpickled by Python 2.x.  This was\nthe default protocol in Python 3.0–3.7.</p></li>\n<li><p>Protocol version 4 was added in Python 3.4.  It adds support for very large\nobjects, pickling more kinds of objects, and some data format\noptimizations.  This was the default protocol in Python 3.8–3.13.\nRefer to <span class=\"target\" id=\"index-3\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-3154/\"><strong>PEP 3154</strong></a> for information about improvements brought by\nprotocol 4.</p></li>\n<li><p>Protocol version 5 was added in Python 3.8.  It adds support for out-of-band\ndata and speedup for in-band data.  It is the default protocol starting with\nPython 3.14.  Refer to <span class=\"target\" id=\"index-4\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-0574/\"><strong>PEP 574</strong></a> for information about improvements brought\nby protocol 5.</p></li>\n</ul>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Serialization is a more primitive notion than persistence; although\n<a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> reads and writes file objects, it does not handle the issue of\nnaming persistent objects, nor the (even more complicated) issue of concurrent\naccess to persistent objects.  The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module can transform a complex\nobject into a byte stream and it can transform the byte stream into an object\nwith the same internal structure.  Perhaps the most obvious thing to do with\nthese byte streams is to write them onto a file, but it is also conceivable to\nsend them across a network or store them in a database.  The <a class=\"reference internal\" href=\"shelve.html#module-shelve\" title=\"shelve: Python object persistence.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">shelve</span></code></a>\nmodule provides a simple interface to pickle and unpickle objects on\nDBM-style database files.</p>\n</div>\n</section>\n<section id=\"module-interface\">\n<h2>Module Interface<a class=\"headerlink\" href=\"#module-interface\" title=\"Link to this heading\">¶</a></h2>\n<p>To serialize an object hierarchy, you simply call the <a class=\"reference internal\" href=\"#pickle.dumps\" title=\"pickle.dumps\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dumps()</span></code></a> function.\nSimilarly, to de-serialize a data stream, you call the <a class=\"reference internal\" href=\"#pickle.loads\" title=\"pickle.loads\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">loads()</span></code></a> function.\nHowever, if you want more control over serialization and de-serialization,\nyou can create a <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> or an <a class=\"reference internal\" href=\"#pickle.Unpickler\" title=\"pickle.Unpickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code></a> object, respectively.</p>\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module provides the following constants:</p>\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"pickle.HIGHEST_PROTOCOL\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">HIGHEST_PROTOCOL</span></span><a class=\"headerlink\" href=\"#pickle.HIGHEST_PROTOCOL\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>An integer, the highest <a class=\"reference internal\" href=\"#pickle-protocols\"><span class=\"std std-ref\">protocol version</span></a>\navailable.  This value can be passed as a <em>protocol</em> value to functions\n<a class=\"reference internal\" href=\"#pickle.dump\" title=\"pickle.dump\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dump()</span></code></a> and <a class=\"reference internal\" href=\"#pickle.dumps\" title=\"pickle.dumps\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dumps()</span></code></a> as well as the <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a>\nconstructor.</p>\n</dd></dl>\n\n<dl class=\"py data\">\n<dt class=\"sig sig-object py\" id=\"pickle.DEFAULT_PROTOCOL\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">DEFAULT_PROTOCOL</span></span><a class=\"headerlink\" href=\"#pickle.DEFAULT_PROTOCOL\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>An integer, the default <a class=\"reference internal\" href=\"#pickle-protocols\"><span class=\"std std-ref\">protocol version</span></a> used\nfor pickling.  May be less than <a class=\"reference internal\" href=\"#pickle.HIGHEST_PROTOCOL\" title=\"pickle.HIGHEST_PROTOCOL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HIGHEST_PROTOCOL</span></code></a>.  Currently the\ndefault protocol is 5, introduced in Python 3.8 and incompatible\nwith previous versions. This version introduces support for out-of-band\nbuffers, where <span class=\"target\" id=\"index-5\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-3118/\"><strong>PEP 3118</strong></a>-compatible data can be transmitted separately\nfrom the main pickle stream.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.0: </span>The default protocol is 3.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The default protocol is 4.</p>\n</div>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.14: </span>The default protocol is 5.</p>\n</div>\n</dd></dl>\n\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module provides the following functions to make the pickling\nprocess more convenient:</p>\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"pickle.dump\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">dump</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">obj</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">file</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">protocol</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffer_callback</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.dump\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write the pickled representation of the object <em>obj</em> to the open\n<a class=\"reference internal\" href=\"../glossary.html#term-file-object\"><span class=\"xref std std-term\">file object</span></a> <em>file</em>.  This is equivalent to\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Pickler(file,</span> <span class=\"pre\">protocol).dump(obj)</span></code>.</p>\n<p>Arguments <em>file</em>, <em>protocol</em>, <em>fix_imports</em> and <em>buffer_callback</em> have\nthe same meaning as in the <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> constructor.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffer_callback</em> argument was added.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"pickle.dumps\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">dumps</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">obj</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">protocol</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffer_callback</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.dumps\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the pickled representation of the object <em>obj</em> as a <a class=\"reference internal\" href=\"stdtypes.html#bytes\" title=\"bytes\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytes</span></code></a> object,\ninstead of writing it to a file.</p>\n<p>Arguments <em>protocol</em>, <em>fix_imports</em> and <em>buffer_callback</em> have the same\nmeaning as in the <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> constructor.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffer_callback</em> argument was added.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"pickle.load\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">load</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">file</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">encoding</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'ASCII'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">errors</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'strict'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffers</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.load\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Read the pickled representation of an object from the open <a class=\"reference internal\" href=\"../glossary.html#term-file-object\"><span class=\"xref std std-term\">file object</span></a>\n<em>file</em> and return the reconstituted object hierarchy specified therein.\nThis is equivalent to <code class=\"docutils literal notranslate\"><span class=\"pre\">Unpickler(file).load()</span></code>.</p>\n<p>The protocol version of the pickle is detected automatically, so no\nprotocol argument is needed.  Bytes past the pickled representation\nof the object are ignored.</p>\n<p>Arguments <em>file</em>, <em>fix_imports</em>, <em>encoding</em>, <em>errors</em>, <em>strict</em> and <em>buffers</em>\nhave the same meaning as in the <a class=\"reference internal\" href=\"#pickle.Unpickler\" title=\"pickle.Unpickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code></a> constructor.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffers</em> argument was added.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py function\">\n<dt class=\"sig sig-object py\" id=\"pickle.loads\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">loads</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">data</span></span></em>, <em class=\"sig-param\"><span class=\"positional-only-separator o\"><abbr title=\"Positional-only parameter separator (PEP 570)\"><span class=\"pre\">/</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">encoding</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'ASCII'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">errors</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'strict'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffers</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.loads\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return the reconstituted object hierarchy of the pickled representation\n<em>data</em> of an object. <em>data</em> must be a <a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a>.</p>\n<p>The protocol version of the pickle is detected automatically, so no\nprotocol argument is needed.  Bytes past the pickled representation\nof the object are ignored.</p>\n<p>Arguments <em>fix_imports</em>, <em>encoding</em>, <em>errors</em>, <em>strict</em> and <em>buffers</em>\nhave the same meaning as in the <a class=\"reference internal\" href=\"#pickle.Unpickler\" title=\"pickle.Unpickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code></a> constructor.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffers</em> argument was added.</p>\n</div>\n</dd></dl>\n\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module defines three exceptions:</p>\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"pickle.PickleError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PickleError</span></span><a class=\"headerlink\" href=\"#pickle.PickleError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Common base class for the other pickling exceptions.  It inherits from\n<a class=\"reference internal\" href=\"exceptions.html#Exception\" title=\"Exception\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">Exception</span></code></a>.</p>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"pickle.PicklingError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PicklingError</span></span><a class=\"headerlink\" href=\"#pickle.PicklingError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Error raised when an unpicklable object is encountered by <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a>.\nIt inherits from <a class=\"reference internal\" href=\"#pickle.PickleError\" title=\"pickle.PickleError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">PickleError</span></code></a>.</p>\n<p>Refer to <a class=\"reference internal\" href=\"#pickle-picklable\"><span class=\"std std-ref\">What can be pickled and unpickled?</span></a> to learn what kinds of objects can be\npickled.</p>\n</dd></dl>\n\n<dl class=\"py exception\">\n<dt class=\"sig sig-object py\" id=\"pickle.UnpicklingError\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">exception</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">UnpicklingError</span></span><a class=\"headerlink\" href=\"#pickle.UnpicklingError\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Error raised when there is a problem unpickling an object, such as a data\ncorruption or a security violation.  It inherits from <a class=\"reference internal\" href=\"#pickle.PickleError\" title=\"pickle.PickleError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">PickleError</span></code></a>.</p>\n<p>Note that other exceptions may also be raised during unpickling, including\n(but not necessarily limited to) AttributeError, EOFError, ImportError, and\nIndexError.</p>\n</dd></dl>\n\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module exports three classes, <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a>,\n<a class=\"reference internal\" href=\"#pickle.Unpickler\" title=\"pickle.Unpickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code></a> and <a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a>:</p>\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">Pickler</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">file</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">protocol</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffer_callback</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Pickler\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>This takes a binary file for writing a pickle data stream.</p>\n<p>The optional <em>protocol</em> argument, an integer, tells the pickler to use\nthe given protocol; supported protocols are 0 to <a class=\"reference internal\" href=\"#pickle.HIGHEST_PROTOCOL\" title=\"pickle.HIGHEST_PROTOCOL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HIGHEST_PROTOCOL</span></code></a>.\nIf not specified, the default is <a class=\"reference internal\" href=\"#pickle.DEFAULT_PROTOCOL\" title=\"pickle.DEFAULT_PROTOCOL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">DEFAULT_PROTOCOL</span></code></a>.  If a negative\nnumber is specified, <a class=\"reference internal\" href=\"#pickle.HIGHEST_PROTOCOL\" title=\"pickle.HIGHEST_PROTOCOL\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">HIGHEST_PROTOCOL</span></code></a> is selected.</p>\n<p>The <em>file</em> argument must have a write() method that accepts a single bytes\nargument.  It can thus be an on-disk file opened for binary writing, an\n<a class=\"reference internal\" href=\"io.html#io.BytesIO\" title=\"io.BytesIO\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">io.BytesIO</span></code></a> instance, or any other custom object that meets this\ninterface.</p>\n<p>If <em>fix_imports</em> is true and <em>protocol</em> is less than 3, pickle will try to\nmap the new Python 3 names to the old module names used in Python 2, so\nthat the pickle data stream is readable with Python 2.</p>\n<p>If <em>buffer_callback</em> is <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> (the default), buffer views are\nserialized into <em>file</em> as part of the pickle stream.</p>\n<p>If <em>buffer_callback</em> is not <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, then it can be called any number\nof times with a buffer view.  If the callback returns a false value\n(such as <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>), the given buffer is <a class=\"reference internal\" href=\"#pickle-oob\"><span class=\"std std-ref\">out-of-band</span></a>;\notherwise the buffer is serialized in-band, i.e. inside the pickle stream.</p>\n<p>It is an error if <em>buffer_callback</em> is not <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> and <em>protocol</em> is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> or smaller than 5.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffer_callback</em> argument was added.</p>\n</div>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.dump\">\n<span class=\"sig-name descname\"><span class=\"pre\">dump</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">obj</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Pickler.dump\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Write the pickled representation of <em>obj</em> to the open file object given in\nthe constructor.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.persistent_id\">\n<span class=\"sig-name descname\"><span class=\"pre\">persistent_id</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">obj</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Pickler.persistent_id\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Do nothing by default.  This exists so a subclass can override it.</p>\n<p>If <a class=\"reference internal\" href=\"#pickle.Pickler.persistent_id\" title=\"pickle.Pickler.persistent_id\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_id()</span></code></a> returns <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, <em>obj</em> is pickled as usual.  Any\nother value causes <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> to emit the returned value as a\npersistent ID for <em>obj</em>.  The meaning of this persistent ID should be\ndefined by <a class=\"reference internal\" href=\"#pickle.Unpickler.persistent_load\" title=\"pickle.Unpickler.persistent_load\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Unpickler.persistent_load()</span></code></a>.  Note that the value\nreturned by <a class=\"reference internal\" href=\"#pickle.Pickler.persistent_id\" title=\"pickle.Pickler.persistent_id\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_id()</span></code></a> cannot itself have a persistent ID.</p>\n<p>See <a class=\"reference internal\" href=\"#pickle-persistent\"><span class=\"std std-ref\">Persistence of External Objects</span></a> for details and examples of uses.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.13: </span>Add the default implementation of this method in the C implementation\nof <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.dispatch_table\">\n<span class=\"sig-name descname\"><span class=\"pre\">dispatch_table</span></span><a class=\"headerlink\" href=\"#pickle.Pickler.dispatch_table\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A pickler object’s dispatch table is a registry of <em>reduction\nfunctions</em> of the kind which can be declared using\n<a class=\"reference internal\" href=\"copyreg.html#copyreg.pickle\" title=\"copyreg.pickle\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">copyreg.pickle()</span></code></a>.  It is a mapping whose keys are classes\nand whose values are reduction functions.  A reduction function\ntakes a single argument of the associated class and should\nconform to the same interface as a <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a>\nmethod.</p>\n<p>By default, a pickler object will not have a\n<a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a> attribute, and it will instead use the\nglobal dispatch table managed by the <a class=\"reference internal\" href=\"copyreg.html#module-copyreg\" title=\"copyreg: Register pickle support functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code></a> module.\nHowever, to customize the pickling for a specific pickler object\none can set the <a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a> attribute to a dict-like\nobject.  Alternatively, if a subclass of <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> has a\n<a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a> attribute then this will be used as the\ndefault dispatch table for instances of that class.</p>\n<p>See <a class=\"reference internal\" href=\"#pickle-dispatch\"><span class=\"std std-ref\">Dispatch Tables</span></a> for usage examples.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.3.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.reducer_override\">\n<span class=\"sig-name descname\"><span class=\"pre\">reducer_override</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">obj</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Pickler.reducer_override\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Special reducer that can be defined in <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> subclasses. This\nmethod has priority over any reducer in the <a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a>.  It\nshould conform to the same interface as a <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> method, and\ncan optionally return <a class=\"reference internal\" href=\"constants.html#NotImplemented\" title=\"NotImplemented\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">NotImplemented</span></code></a> to fallback on\n<a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a>-registered reducers to pickle <code class=\"docutils literal notranslate\"><span class=\"pre\">obj</span></code>.</p>\n<p>For a detailed example, see <a class=\"reference internal\" href=\"#reducer-override\"><span class=\"std std-ref\">Custom Reduction for Types, Functions, and Other Objects</span></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n</dd></dl>\n\n<dl class=\"py attribute\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.fast\">\n<span class=\"sig-name descname\"><span class=\"pre\">fast</span></span><a class=\"headerlink\" href=\"#pickle.Pickler.fast\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Deprecated. Enable fast mode if set to a true value.  The fast mode\ndisables the usage of memo, therefore speeding the pickling process by not\ngenerating superfluous PUT opcodes.  It should not be used with\nself-referential objects, doing otherwise will cause <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> to\nrecurse infinitely.</p>\n<p>Use <a class=\"reference internal\" href=\"pickletools.html#pickletools.optimize\" title=\"pickletools.optimize\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">pickletools.optimize()</span></code></a> if you need more compact pickles.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Pickler.clear_memo\">\n<span class=\"sig-name descname\"><span class=\"pre\">clear_memo</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Pickler.clear_memo\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Clears the pickler’s “memo”.</p>\n<p>The memo is the data structure that remembers which objects the\npickler has already seen, so that shared or recursive objects\nare pickled by reference and not by value.  This method is\nuseful when re-using picklers.</p>\n</dd></dl>\n\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"pickle.Unpickler\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">Unpickler</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">file</span></span></em>, <em class=\"sig-param\"><span class=\"keyword-only-separator o\"><abbr title=\"Keyword-only parameters separator (PEP 3102)\"><span class=\"pre\">*</span></abbr></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">fix_imports</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">True</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">encoding</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'ASCII'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">errors</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">'strict'</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffers</span></span><span class=\"o\"><span class=\"pre\">=</span></span><span class=\"default_value\"><span class=\"pre\">None</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Unpickler\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>This takes a binary file for reading a pickle data stream.</p>\n<p>The protocol version of the pickle is detected automatically, so no\nprotocol argument is needed.</p>\n<p>The argument <em>file</em> must have three methods, a read() method that takes an\ninteger argument, a readinto() method that takes a buffer argument\nand a readline() method that requires no arguments, as in the\n<a class=\"reference internal\" href=\"io.html#io.BufferedIOBase\" title=\"io.BufferedIOBase\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">io.BufferedIOBase</span></code></a> interface.  Thus <em>file</em> can be an on-disk file\nopened for binary reading, an <a class=\"reference internal\" href=\"io.html#io.BytesIO\" title=\"io.BytesIO\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">io.BytesIO</span></code></a> object, or any other\ncustom object that meets this interface.</p>\n<p>The optional arguments <em>fix_imports</em>, <em>encoding</em> and <em>errors</em> are used\nto control compatibility support for pickle stream generated by Python 2.\nIf <em>fix_imports</em> is true, pickle will try to map the old Python 2 names\nto the new names used in Python 3.  The <em>encoding</em> and <em>errors</em> tell\npickle how to decode 8-bit string instances pickled by Python 2;\nthese default to ‘ASCII’ and ‘strict’, respectively.  The <em>encoding</em> can\nbe ‘bytes’ to read these 8-bit string instances as bytes objects.\nUsing <code class=\"docutils literal notranslate\"><span class=\"pre\">encoding='latin1'</span></code> is required for unpickling NumPy arrays and\ninstances of <a class=\"reference internal\" href=\"datetime.html#datetime.datetime\" title=\"datetime.datetime\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">datetime</span></code></a>, <a class=\"reference internal\" href=\"datetime.html#datetime.date\" title=\"datetime.date\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">date</span></code></a> and\n<a class=\"reference internal\" href=\"datetime.html#datetime.time\" title=\"datetime.time\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">time</span></code></a> pickled by Python 2.</p>\n<p>If <em>buffers</em> is <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> (the default), then all data necessary for\ndeserialization must be contained in the pickle stream.  This means\nthat the <em>buffer_callback</em> argument was <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> when a <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a>\nwas instantiated (or when <a class=\"reference internal\" href=\"#pickle.dump\" title=\"pickle.dump\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dump()</span></code></a> or <a class=\"reference internal\" href=\"#pickle.dumps\" title=\"pickle.dumps\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dumps()</span></code></a> was called).</p>\n<p>If <em>buffers</em> is not <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, it should be an iterable of buffer-enabled\nobjects that is consumed each time the pickle stream references\nan <a class=\"reference internal\" href=\"#pickle-oob\"><span class=\"std std-ref\">out-of-band</span></a> buffer view.  Such buffers have been\ngiven in order to the <em>buffer_callback</em> of a Pickler object.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.8: </span>The <em>buffers</em> argument was added.</p>\n</div>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Unpickler.load\">\n<span class=\"sig-name descname\"><span class=\"pre\">load</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Unpickler.load\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Read the pickled representation of an object from the open file object\ngiven in the constructor, and return the reconstituted object hierarchy\nspecified therein.  Bytes past the pickled representation of the object\nare ignored.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Unpickler.persistent_load\">\n<span class=\"sig-name descname\"><span class=\"pre\">persistent_load</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">pid</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Unpickler.persistent_load\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Raise an <a class=\"reference internal\" href=\"#pickle.UnpicklingError\" title=\"pickle.UnpicklingError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">UnpicklingError</span></code></a> by default.</p>\n<p>If defined, <a class=\"reference internal\" href=\"#pickle.Unpickler.persistent_load\" title=\"pickle.Unpickler.persistent_load\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_load()</span></code></a> should return the object specified by\nthe persistent ID <em>pid</em>.  If an invalid persistent ID is encountered, an\n<a class=\"reference internal\" href=\"#pickle.UnpicklingError\" title=\"pickle.UnpicklingError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">UnpicklingError</span></code></a> should be raised.</p>\n<p>See <a class=\"reference internal\" href=\"#pickle-persistent\"><span class=\"std std-ref\">Persistence of External Objects</span></a> for details and examples of uses.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.13: </span>Add the default implementation of this method in the C implementation\nof <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code>.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.Unpickler.find_class\">\n<span class=\"sig-name descname\"><span class=\"pre\">find_class</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">module</span></span></em>, <em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">name</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.Unpickler.find_class\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Import <em>module</em> if necessary and return the object called <em>name</em> from it,\nwhere the <em>module</em> and <em>name</em> arguments are <a class=\"reference internal\" href=\"stdtypes.html#str\" title=\"str\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">str</span></code></a> objects.  Note,\nunlike its name suggests, <a class=\"reference internal\" href=\"#pickle.Unpickler.find_class\" title=\"pickle.Unpickler.find_class\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">find_class()</span></code></a> is also used for finding\nfunctions.</p>\n<p>Subclasses may override this to gain control over what type of objects and\nhow they can be loaded, potentially reducing security risks. Refer to\n<a class=\"reference internal\" href=\"#pickle-restrict\"><span class=\"std std-ref\">Restricting Globals</span></a> for details.</p>\n<p class=\"audit-hook\">Raises an <a class=\"reference internal\" href=\"sys.html#auditing\"><span class=\"std std-ref\">auditing event</span></a> <code class=\"docutils literal notranslate\"><span class=\"pre\">pickle.find_class</span></code> with arguments <code class=\"docutils literal notranslate\"><span class=\"pre\">module</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">name</span></code>.</p>\n</dd></dl>\n\n</dd></dl>\n\n<dl class=\"py class\">\n<dt class=\"sig sig-object py\" id=\"pickle.PickleBuffer\">\n<em class=\"property\"><span class=\"k\"><span class=\"pre\">class</span></span><span class=\"w\"> </span></em><span class=\"sig-prename descclassname\"><span class=\"pre\">pickle.</span></span><span class=\"sig-name descname\"><span class=\"pre\">PickleBuffer</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">buffer</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.PickleBuffer\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A wrapper for a buffer representing picklable data.  <em>buffer</em> must be a\n<a class=\"reference internal\" href=\"../c-api/buffer.html#bufferobjects\"><span class=\"std std-ref\">buffer-providing</span></a> object, such as a\n<a class=\"reference internal\" href=\"../glossary.html#term-bytes-like-object\"><span class=\"xref std std-term\">bytes-like object</span></a> or a N-dimensional array.</p>\n<p><a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> is itself a buffer provider, therefore it is\npossible to pass it to other APIs expecting a buffer-providing object,\nsuch as <a class=\"reference internal\" href=\"stdtypes.html#memoryview\" title=\"memoryview\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">memoryview</span></code></a>.</p>\n<p><a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> objects can only be serialized using pickle\nprotocol 5 or higher.  They are eligible for\n<a class=\"reference internal\" href=\"#pickle-oob\"><span class=\"std std-ref\">out-of-band serialization</span></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.PickleBuffer.raw\">\n<span class=\"sig-name descname\"><span class=\"pre\">raw</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.PickleBuffer.raw\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Return a <a class=\"reference internal\" href=\"stdtypes.html#memoryview\" title=\"memoryview\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">memoryview</span></code></a> of the memory area underlying this buffer.\nThe returned object is a one-dimensional, C-contiguous memoryview\nwith format <code class=\"docutils literal notranslate\"><span class=\"pre\">B</span></code> (unsigned bytes).  <a class=\"reference internal\" href=\"exceptions.html#BufferError\" title=\"BufferError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">BufferError</span></code></a> is raised if\nthe buffer is neither C- nor Fortran-contiguous.</p>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"pickle.PickleBuffer.release\">\n<span class=\"sig-name descname\"><span class=\"pre\">release</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#pickle.PickleBuffer.release\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Release the underlying buffer exposed by the PickleBuffer object.</p>\n</dd></dl>\n\n</dd></dl>\n\n</section>\n<section id=\"what-can-be-pickled-and-unpickled\">\n<span id=\"pickle-picklable\"></span><h2>What can be pickled and unpickled?<a class=\"headerlink\" href=\"#what-can-be-pickled-and-unpickled\" title=\"Link to this heading\">¶</a></h2>\n<p>The following types can be pickled:</p>\n<ul class=\"simple\">\n<li><p>built-in constants (<code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">Ellipsis</span></code>, and\n<a class=\"reference internal\" href=\"constants.html#NotImplemented\" title=\"NotImplemented\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">NotImplemented</span></code></a>);</p></li>\n<li><p>integers, floating-point numbers, complex numbers;</p></li>\n<li><p>strings, bytes, bytearrays;</p></li>\n<li><p>tuples, lists, sets, and dictionaries containing only picklable objects;</p></li>\n<li><p>functions (built-in and user-defined) accessible from the top level of a\nmodule (using <a class=\"reference internal\" href=\"../reference/compound_stmts.html#def\"><code class=\"xref std std-keyword docutils literal notranslate\"><span class=\"pre\">def</span></code></a>, not <a class=\"reference internal\" href=\"../reference/expressions.html#lambda\"><code class=\"xref std std-keyword docutils literal notranslate\"><span class=\"pre\">lambda</span></code></a>);</p></li>\n<li><p>classes accessible from the top level of a module;</p></li>\n<li><p>instances of such classes whose the result of calling <a class=\"reference internal\" href=\"#object.__getstate__\" title=\"object.__getstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code></a>\nis picklable  (see section <a class=\"reference internal\" href=\"#pickle-inst\"><span class=\"std std-ref\">Pickling Class Instances</span></a> for details).</p></li>\n</ul>\n<p>Attempts to pickle unpicklable objects will raise the <a class=\"reference internal\" href=\"#pickle.PicklingError\" title=\"pickle.PicklingError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">PicklingError</span></code></a>\nexception; when this happens, an unspecified number of bytes may have already\nbeen written to the underlying file.  Trying to pickle a highly recursive data\nstructure may exceed the maximum recursion depth, a <a class=\"reference internal\" href=\"exceptions.html#RecursionError\" title=\"RecursionError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">RecursionError</span></code></a> will be\nraised in this case.  You can carefully raise this limit with\n<a class=\"reference internal\" href=\"sys.html#sys.setrecursionlimit\" title=\"sys.setrecursionlimit\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">sys.setrecursionlimit()</span></code></a>.</p>\n<p>Note that functions (built-in and user-defined) are pickled by fully\n<a class=\"reference internal\" href=\"../glossary.html#term-qualified-name\"><span class=\"xref std std-term\">qualified name</span></a>, not by value. <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id3\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a>  This means that only the function name is\npickled, along with the name of the containing module and classes.  Neither\nthe function’s code, nor any of its function attributes are pickled.  Thus the\ndefining module must be importable in the unpickling environment, and the module\nmust contain the named object, otherwise an exception will be raised. <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id4\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a></p>\n<p>Similarly, classes are pickled by fully qualified name, so the same restrictions in\nthe unpickling environment apply.  Note that none of the class’s code or data is\npickled, so in the following example the class attribute <code class=\"docutils literal notranslate\"><span class=\"pre\">attr</span></code> is not\nrestored in the unpickling environment:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">Foo</span><span class=\"p\">:</span>\n    <span class=\"n\">attr</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;A class attribute&#39;</span>\n\n<span class=\"n\">picklestring</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">Foo</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>These restrictions are why picklable functions and classes must be defined at\nthe top level of a module.</p>\n<p>Similarly, when class instances are pickled, their class’s code and data are not\npickled along with them.  Only the instance data are pickled.  This is done on\npurpose, so you can fix bugs in a class or add methods to the class and still\nload objects that were created with an earlier version of the class.  If you\nplan to have long-lived objects that will see many versions of a class, it may\nbe worthwhile to put a version number in the objects so that suitable\nconversions can be made by the class’s <a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a> method.</p>\n</section>\n<section id=\"pickling-class-instances\">\n<span id=\"pickle-inst\"></span><h2>Pickling Class Instances<a class=\"headerlink\" href=\"#pickling-class-instances\" title=\"Link to this heading\">¶</a></h2>\n<p>In this section, we describe the general mechanisms available to you to define,\ncustomize, and control how class instances are pickled and unpickled.</p>\n<p>In most cases, no additional code is needed to make instances picklable.  By\ndefault, pickle will retrieve the class and the attributes of an instance via\nintrospection. When a class instance is unpickled, its <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__init__\" title=\"object.__init__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__init__()</span></code></a> method\nis usually <em>not</em> invoked.  The default behaviour first creates an uninitialized\ninstance and then restores the saved attributes.  The following code shows an\nimplementation of this behaviour:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">save</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"vm\">__class__</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"vm\">__dict__</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">restore</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">attributes</span><span class=\"p\">):</span>\n    <span class=\"n\">obj</span> <span class=\"o\">=</span> <span class=\"bp\">cls</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">)</span>\n    <span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"vm\">__dict__</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">attributes</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">obj</span>\n</pre></div>\n</div>\n<p>Classes can alter the default behaviour by providing one or several special\nmethods:</p>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__getnewargs_ex__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__getnewargs_ex__</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__getnewargs_ex__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>In protocols 2 and newer, classes that implements the\n<a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a> method can dictate the values passed to the\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__new__\" title=\"object.__new__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__new__()</span></code></a> method upon unpickling.  The method must return a pair\n<code class=\"docutils literal notranslate\"><span class=\"pre\">(args,</span> <span class=\"pre\">kwargs)</span></code> where <em>args</em> is a tuple of positional arguments\nand <em>kwargs</em> a dictionary of named arguments for constructing the\nobject.  Those will be passed to the <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__new__\" title=\"object.__new__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__new__()</span></code></a> method upon\nunpickling.</p>\n<p>You should implement this method if the <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__new__\" title=\"object.__new__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__new__()</span></code></a> method of your\nclass requires keyword-only arguments.  Otherwise, it is recommended for\ncompatibility to implement <a class=\"reference internal\" href=\"#object.__getnewargs__\" title=\"object.__getnewargs__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs__()</span></code></a>.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span><a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a> is now used in protocols 2 and 3.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__getnewargs__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__getnewargs__</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__getnewargs__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>This method serves a similar purpose as <a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a>, but\nsupports only positional arguments.  It must return a tuple of arguments\n<code class=\"docutils literal notranslate\"><span class=\"pre\">args</span></code> which will be passed to the <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__new__\" title=\"object.__new__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__new__()</span></code></a> method upon unpickling.</p>\n<p><a class=\"reference internal\" href=\"#object.__getnewargs__\" title=\"object.__getnewargs__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs__()</span></code></a> will not be called if <a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a> is\ndefined.</p>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.6: </span>Before Python 3.6, <a class=\"reference internal\" href=\"#object.__getnewargs__\" title=\"object.__getnewargs__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs__()</span></code></a> was called instead of\n<a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a> in protocols 2 and 3.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__getstate__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__getstate__</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__getstate__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Classes can further influence how their instances are pickled by overriding\nthe method <a class=\"reference internal\" href=\"#object.__getstate__\" title=\"object.__getstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code></a>.  It is called and the returned object\nis pickled as the contents for the instance, instead of a default state.\nThere are several cases:</p>\n<ul class=\"simple\">\n<li><p>For a class that has no instance <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__dict__\" title=\"object.__dict__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__dict__</span></code></a> and no\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__slots__\" title=\"object.__slots__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__slots__</span></code></a>, the default state is <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>.</p></li>\n<li><p>For a class that has an instance <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__dict__\" title=\"object.__dict__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__dict__</span></code></a> and no\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__slots__\" title=\"object.__slots__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__slots__</span></code></a>, the default state is <code class=\"docutils literal notranslate\"><span class=\"pre\">self.__dict__</span></code>.</p></li>\n<li><p>For a class that has an instance <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__dict__\" title=\"object.__dict__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__dict__</span></code></a> and\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__slots__\" title=\"object.__slots__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__slots__</span></code></a>, the default state is a tuple consisting of two\ndictionaries:  <code class=\"docutils literal notranslate\"><span class=\"pre\">self.__dict__</span></code>, and a dictionary mapping slot\nnames to slot values.  Only slots that have a value are\nincluded in the latter.</p></li>\n<li><p>For a class that has <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__slots__\" title=\"object.__slots__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__slots__</span></code></a> and no instance\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__dict__\" title=\"object.__dict__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__dict__</span></code></a>, the default state is a tuple whose first item\nis <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> and whose second item is a dictionary mapping slot names\nto slot values described in the previous bullet.</p></li>\n</ul>\n<div class=\"versionchanged\">\n<p><span class=\"versionmodified changed\">Changed in version 3.11: </span>Added the default implementation of the <code class=\"docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code> method in the\n<a class=\"reference internal\" href=\"functions.html#object\" title=\"object\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">object</span></code></a> class.</p>\n</div>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__setstate__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__setstate__</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">state</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__setstate__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Upon unpickling, if the class defines <a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a>, it is called with\nthe unpickled state.  In that case, there is no requirement for the state\nobject to be a dictionary.  Otherwise, the pickled state must be a dictionary\nand its items are assigned to the new instance’s dictionary.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>If <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> returns a state with value <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> at pickling,\nthe <a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a> method will not be called upon unpickling.</p>\n</div>\n</dd></dl>\n\n<p>Refer to the section <a class=\"reference internal\" href=\"#pickle-state\"><span class=\"std std-ref\">Handling Stateful Objects</span></a> for more information about how to use\nthe methods <a class=\"reference internal\" href=\"#object.__getstate__\" title=\"object.__getstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code></a> and <a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a>.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>At unpickling time, some methods like <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__getattr__\" title=\"object.__getattr__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getattr__()</span></code></a>,\n<a class=\"reference internal\" href=\"../reference/datamodel.html#object.__getattribute__\" title=\"object.__getattribute__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getattribute__()</span></code></a>, or <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__setattr__\" title=\"object.__setattr__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setattr__()</span></code></a> may be called upon the\ninstance.  In case those methods rely on some internal invariant being\ntrue, the type should implement <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__new__\" title=\"object.__new__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__new__()</span></code></a> to establish such an\ninvariant, as <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__init__\" title=\"object.__init__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__init__()</span></code></a> is not called when unpickling an\ninstance.</p>\n</div>\n<p id=\"index-6\">As we shall see, pickle does not use directly the methods described above.  In\nfact, these methods are part of the copy protocol which implements the\n<a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> special method.  The copy protocol provides a unified\ninterface for retrieving the data necessary for pickling and copying\nobjects. <a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id5\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>4<span class=\"fn-bracket\">]</span></a></p>\n<p>Although powerful, implementing <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> directly in your classes is\nerror prone.  For this reason, class designers should use the high-level\ninterface (i.e., <a class=\"reference internal\" href=\"#object.__getnewargs_ex__\" title=\"object.__getnewargs_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getnewargs_ex__()</span></code></a>, <a class=\"reference internal\" href=\"#object.__getstate__\" title=\"object.__getstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code></a> and\n<a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a>) whenever possible.  We will show, however, cases where\nusing <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code> is the only option or leads to more efficient pickling\nor both.</p>\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__reduce__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__reduce__</span></span><span class=\"sig-paren\">(</span><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__reduce__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>The interface is currently defined as follows.  The <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> method\ntakes no argument and shall return either a string or preferably a tuple (the\nreturned object is often referred to as the “reduce value”).</p>\n<p>If a string is returned, the string should be interpreted as the name of a\nglobal variable.  It should be the object’s local name relative to its\nmodule; the pickle module searches the module namespace to determine the\nobject’s module.  This behaviour is typically useful for singletons.</p>\n<p>When a tuple is returned, it must be between two and six items long.\nOptional items can either be omitted, or <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> can be provided as their\nvalue.  The semantics of each item are in order:</p>\n<ul>\n<li><p>A callable object that will be called to create the initial version of the\nobject.</p></li>\n<li><p>A tuple of arguments for the callable object.  An empty tuple must be given\nif the callable does not accept any argument.</p></li>\n<li><p>Optionally, the object’s state, which will be passed to the object’s\n<a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a> method as previously described.  If the object has no\nsuch method then, the value must be a dictionary and it will be added to\nthe object’s <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__dict__\" title=\"object.__dict__\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">__dict__</span></code></a> attribute.</p></li>\n<li><p>Optionally, an iterator (and not a sequence) yielding successive items.\nThese items will be appended to the object either using\n<code class=\"docutils literal notranslate\"><span class=\"pre\">obj.append(item)</span></code> or, in batch, using <code class=\"docutils literal notranslate\"><span class=\"pre\">obj.extend(list_of_items)</span></code>.\nThis is primarily used for list subclasses, but may be used by other\nclasses as long as they have <a class=\"reference internal\" href=\"stdtypes.html#sequence.append\" title=\"sequence.append\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">append()</span></code></a>\nand <a class=\"reference internal\" href=\"stdtypes.html#sequence.extend\" title=\"sequence.extend\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">extend()</span></code></a> methods with\nthe appropriate signature.  (Whether <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">append()</span></code> or <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">extend()</span></code> is\nused depends on which pickle protocol version is used as well as the number\nof items to append, so both must be supported.)</p></li>\n<li><p>Optionally, an iterator (not a sequence) yielding successive key-value\npairs.  These items will be stored to the object using <code class=\"docutils literal notranslate\"><span class=\"pre\">obj[key]</span> <span class=\"pre\">=</span>\n<span class=\"pre\">value</span></code>.  This is primarily used for dictionary subclasses, but may be used\nby other classes as long as they implement <a class=\"reference internal\" href=\"../reference/datamodel.html#object.__setitem__\" title=\"object.__setitem__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setitem__()</span></code></a>.</p></li>\n<li><p>Optionally, a callable with a <code class=\"docutils literal notranslate\"><span class=\"pre\">(obj,</span> <span class=\"pre\">state)</span></code> signature. This\ncallable allows the user to programmatically control the state-updating\nbehavior of a specific object, instead of using <code class=\"docutils literal notranslate\"><span class=\"pre\">obj</span></code>’s static\n<a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a> method. If not <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, this callable will have\npriority over <code class=\"docutils literal notranslate\"><span class=\"pre\">obj</span></code>’s <a class=\"reference internal\" href=\"#object.__setstate__\" title=\"object.__setstate__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code></a>.</p>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8: </span>The optional sixth tuple item, <code class=\"docutils literal notranslate\"><span class=\"pre\">(obj,</span> <span class=\"pre\">state)</span></code>, was added.</p>\n</div>\n</li>\n</ul>\n</dd></dl>\n\n<dl class=\"py method\">\n<dt class=\"sig sig-object py\" id=\"object.__reduce_ex__\">\n<span class=\"sig-prename descclassname\"><span class=\"pre\">object.</span></span><span class=\"sig-name descname\"><span class=\"pre\">__reduce_ex__</span></span><span class=\"sig-paren\">(</span><em class=\"sig-param\"><span class=\"n\"><span class=\"pre\">protocol</span></span></em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#object.__reduce_ex__\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>Alternatively, a <a class=\"reference internal\" href=\"#object.__reduce_ex__\" title=\"object.__reduce_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce_ex__()</span></code></a> method may be defined.  The only\ndifference is this method should take a single integer argument, the protocol\nversion.  When defined, pickle will prefer it over the <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a>\nmethod.  In addition, <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a> automatically becomes a synonym for\nthe extended version.  The main use for this method is to provide\nbackwards-compatible reduce values for older Python releases.</p>\n</dd></dl>\n\n<section id=\"persistence-of-external-objects\">\n<span id=\"pickle-persistent\"></span><h3>Persistence of External Objects<a class=\"headerlink\" href=\"#persistence-of-external-objects\" title=\"Link to this heading\">¶</a></h3>\n<p id=\"index-7\">For the benefit of object persistence, the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module supports the\nnotion of a reference to an object outside the pickled data stream.  Such\nobjects are referenced by a persistent ID, which should be either a string of\nalphanumeric characters (for protocol 0) <a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id6\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>5<span class=\"fn-bracket\">]</span></a> or just an arbitrary object (for\nany newer protocol).</p>\n<p>The resolution of such persistent IDs is not defined by the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a>\nmodule; it will delegate this resolution to the user-defined methods on the\npickler and unpickler, <a class=\"reference internal\" href=\"#pickle.Pickler.persistent_id\" title=\"pickle.Pickler.persistent_id\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_id()</span></code></a> and\n<a class=\"reference internal\" href=\"#pickle.Unpickler.persistent_load\" title=\"pickle.Unpickler.persistent_load\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_load()</span></code></a> respectively.</p>\n<p>To pickle objects that have an external persistent ID, the pickler must have a\ncustom <a class=\"reference internal\" href=\"#pickle.Pickler.persistent_id\" title=\"pickle.Pickler.persistent_id\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_id()</span></code></a> method that takes an object as an\nargument and returns either <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> or the persistent ID for that object.\nWhen <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code> is returned, the pickler simply pickles the object as normal.\nWhen a persistent ID string is returned, the pickler will pickle that object,\nalong with a marker so that the unpickler will recognize it as a persistent ID.</p>\n<p>To unpickle external objects, the unpickler must have a custom\n<a class=\"reference internal\" href=\"#pickle.Unpickler.persistent_load\" title=\"pickle.Unpickler.persistent_load\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">persistent_load()</span></code></a> method that takes a persistent ID object and\nreturns the referenced object.</p>\n<p>Here is a comprehensive example presenting how persistent ID can be used to\npickle external objects by reference.</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># Simple example presenting how persistent ID can be used to pickle</span>\n<span class=\"c1\"># external objects by reference.</span>\n\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">sqlite3</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">collections</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">namedtuple</span>\n\n<span class=\"c1\"># Simple class representing a record in our database.</span>\n<span class=\"n\">MemoRecord</span> <span class=\"o\">=</span> <span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;MemoRecord&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;key, task&quot;</span><span class=\"p\">)</span>\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">DBPickler</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Pickler</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">persistent_id</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Instead of pickling MemoRecord as a regular class instance, we emit a</span>\n        <span class=\"c1\"># persistent ID.</span>\n        <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"n\">MemoRecord</span><span class=\"p\">):</span>\n            <span class=\"c1\"># Here, our persistent ID is simply a tuple, containing a tag and a</span>\n            <span class=\"c1\"># key, which refers to a specific record in the database.</span>\n            <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"s2\">&quot;MemoRecord&quot;</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># If obj does not have a persistent ID, return None. This means obj</span>\n            <span class=\"c1\"># needs to be pickled as usual.</span>\n            <span class=\"k\">return</span> <span class=\"kc\">None</span>\n\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">DBUnpickler</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Unpickler</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">file</span><span class=\"p\">,</span> <span class=\"n\">connection</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">connection</span> <span class=\"o\">=</span> <span class=\"n\">connection</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">persistent_load</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">pid</span><span class=\"p\">):</span>\n        <span class=\"c1\"># This method is invoked whenever a persistent ID is encountered.</span>\n        <span class=\"c1\"># Here, pid is the tuple returned by DBPickler.</span>\n        <span class=\"n\">cursor</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">connection</span><span class=\"o\">.</span><span class=\"n\">cursor</span><span class=\"p\">()</span>\n        <span class=\"n\">type_tag</span><span class=\"p\">,</span> <span class=\"n\">key_id</span> <span class=\"o\">=</span> <span class=\"n\">pid</span>\n        <span class=\"k\">if</span> <span class=\"n\">type_tag</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;MemoRecord&quot;</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Fetch the referenced record from the database and return it.</span>\n            <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"s2\">&quot;SELECT * FROM memos WHERE key=?&quot;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">key_id</span><span class=\"p\">),))</span>\n            <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">task</span> <span class=\"o\">=</span> <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">fetchone</span><span class=\"p\">()</span>\n            <span class=\"k\">return</span> <span class=\"n\">MemoRecord</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">task</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Always raises an error if you cannot return the correct object.</span>\n            <span class=\"c1\"># Otherwise, the unpickler will think None is the object referenced</span>\n            <span class=\"c1\"># by the persistent ID.</span>\n            <span class=\"k\">raise</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">UnpicklingError</span><span class=\"p\">(</span><span class=\"s2\">&quot;unsupported persistent object&quot;</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">io</span>\n    <span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pprint</span>\n\n    <span class=\"c1\"># Initialize and populate our database.</span>\n    <span class=\"n\">conn</span> <span class=\"o\">=</span> <span class=\"n\">sqlite3</span><span class=\"o\">.</span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"s2\">&quot;:memory:&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">cursor</span> <span class=\"o\">=</span> <span class=\"n\">conn</span><span class=\"o\">.</span><span class=\"n\">cursor</span><span class=\"p\">()</span>\n    <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"s2\">&quot;CREATE TABLE memos(key INTEGER PRIMARY KEY, task TEXT)&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">tasks</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n        <span class=\"s1\">&#39;give food to fish&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;prepare group meeting&#39;</span><span class=\"p\">,</span>\n        <span class=\"s1\">&#39;fight with a zebra&#39;</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n    <span class=\"k\">for</span> <span class=\"n\">task</span> <span class=\"ow\">in</span> <span class=\"n\">tasks</span><span class=\"p\">:</span>\n        <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"s2\">&quot;INSERT INTO memos VALUES(NULL, ?)&quot;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">task</span><span class=\"p\">,))</span>\n\n    <span class=\"c1\"># Fetch the records to be pickled.</span>\n    <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"s2\">&quot;SELECT * FROM memos&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">memos</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">MemoRecord</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">task</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">task</span> <span class=\"ow\">in</span> <span class=\"n\">cursor</span><span class=\"p\">]</span>\n    <span class=\"c1\"># Save the records using our custom DBPickler.</span>\n    <span class=\"n\">file</span> <span class=\"o\">=</span> <span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">()</span>\n    <span class=\"n\">DBPickler</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"p\">(</span><span class=\"n\">memos</span><span class=\"p\">)</span>\n\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Pickled records:&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">pprint</span><span class=\"o\">.</span><span class=\"n\">pprint</span><span class=\"p\">(</span><span class=\"n\">memos</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Update a record, just for good measure.</span>\n    <span class=\"n\">cursor</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"s2\">&quot;UPDATE memos SET task=&#39;learn italian&#39; WHERE key=1&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># Load the records from the pickle data stream.</span>\n    <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">seek</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"n\">memos</span> <span class=\"o\">=</span> <span class=\"n\">DBUnpickler</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">,</span> <span class=\"n\">conn</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">()</span>\n\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Unpickled records:&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">pprint</span><span class=\"o\">.</span><span class=\"n\">pprint</span><span class=\"p\">(</span><span class=\"n\">memos</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"n\">main</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n</section>\n<section id=\"dispatch-tables\">\n<span id=\"pickle-dispatch\"></span><h3>Dispatch Tables<a class=\"headerlink\" href=\"#dispatch-tables\" title=\"Link to this heading\">¶</a></h3>\n<p>If one wants to customize pickling of some classes without disturbing\nany other code which depends on pickling, then one can create a\npickler with a private dispatch table.</p>\n<p>The global dispatch table managed by the <a class=\"reference internal\" href=\"copyreg.html#module-copyreg\" title=\"copyreg: Register pickle support functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code></a> module is\navailable as <code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">copyreg.dispatch_table</span></code>.  Therefore, one may\nchoose to use a modified copy of <code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">copyreg.dispatch_table</span></code> as a\nprivate dispatch table.</p>\n<p>For example</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">()</span>\n<span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Pickler</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n<span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">dispatch_table</span> <span class=\"o\">=</span> <span class=\"n\">copyreg</span><span class=\"o\">.</span><span class=\"n\">dispatch_table</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n<span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">dispatch_table</span><span class=\"p\">[</span><span class=\"n\">SomeClass</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">reduce_SomeClass</span>\n</pre></div>\n</div>\n<p>creates an instance of <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">pickle.Pickler</span></code></a> with a private dispatch\ntable which handles the <code class=\"docutils literal notranslate\"><span class=\"pre\">SomeClass</span></code> class specially.  Alternatively,\nthe code</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">MyPickler</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Pickler</span><span class=\"p\">):</span>\n    <span class=\"n\">dispatch_table</span> <span class=\"o\">=</span> <span class=\"n\">copyreg</span><span class=\"o\">.</span><span class=\"n\">dispatch_table</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n    <span class=\"n\">dispatch_table</span><span class=\"p\">[</span><span class=\"n\">SomeClass</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">reduce_SomeClass</span>\n<span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">()</span>\n<span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">MyPickler</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>does the same but all instances of <code class=\"docutils literal notranslate\"><span class=\"pre\">MyPickler</span></code> will by default\nshare the private dispatch table.  On the other hand, the code</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">copyreg</span><span class=\"o\">.</span><span class=\"n\">pickle</span><span class=\"p\">(</span><span class=\"n\">SomeClass</span><span class=\"p\">,</span> <span class=\"n\">reduce_SomeClass</span><span class=\"p\">)</span>\n<span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">()</span>\n<span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Pickler</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>modifies the global dispatch table shared by all users of the <a class=\"reference internal\" href=\"copyreg.html#module-copyreg\" title=\"copyreg: Register pickle support functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code></a> module.</p>\n</section>\n<section id=\"handling-stateful-objects\">\n<span id=\"pickle-state\"></span><h3>Handling Stateful Objects<a class=\"headerlink\" href=\"#handling-stateful-objects\" title=\"Link to this heading\">¶</a></h3>\n<p id=\"index-8\">Here’s an example that shows how to modify pickling behavior for a class.\nThe <code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">TextReader</span></code> class below opens a text file, and returns the line number and\nline contents each time its <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">readline()</span></code> method is called. If a\n<code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">TextReader</span></code> instance is pickled, all attributes <em>except</em> the file object\nmember are saved. When the instance is unpickled, the file is reopened, and\nreading resumes from the last location. The <code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__setstate__()</span></code> and\n<code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__getstate__()</span></code> methods are used to implement this behavior.</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">TextReader</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Print and number lines in a text file.&quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">filename</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">filename</span> <span class=\"o\">=</span> <span class=\"n\">filename</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">file</span> <span class=\"o\">=</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lineno</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">readline</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lineno</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n        <span class=\"n\">line</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">line</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"kc\">None</span>\n        <span class=\"k\">if</span> <span class=\"n\">line</span><span class=\"o\">.</span><span class=\"n\">endswith</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"se\">\\n</span><span class=\"s1\">&#39;</span><span class=\"p\">):</span>\n            <span class=\"n\">line</span> <span class=\"o\">=</span> <span class=\"n\">line</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"s2\">&quot;</span><span class=\"si\">%i</span><span class=\"s2\">: </span><span class=\"si\">%s</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lineno</span><span class=\"p\">,</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">__getstate__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Copy the object&#39;s state from self.__dict__ which contains</span>\n        <span class=\"c1\"># all our instance attributes. Always use the dict.copy()</span>\n        <span class=\"c1\"># method to avoid modifying the original state.</span>\n        <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"vm\">__dict__</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n        <span class=\"c1\"># Remove the unpicklable entries.</span>\n        <span class=\"k\">del</span> <span class=\"n\">state</span><span class=\"p\">[</span><span class=\"s1\">&#39;file&#39;</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"n\">state</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">__setstate__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">state</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Restore instance attributes (i.e., filename and lineno).</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"vm\">__dict__</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span><span class=\"n\">state</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Restore the previously opened file&#39;s state. To do so, we need to</span>\n        <span class=\"c1\"># reopen it and read from it until the line count is restored.</span>\n        <span class=\"n\">file</span> <span class=\"o\">=</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">filename</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">_</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">lineno</span><span class=\"p\">):</span>\n            <span class=\"n\">file</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n        <span class=\"c1\"># Finally, save the file.</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">file</span> <span class=\"o\">=</span> <span class=\"n\">file</span>\n</pre></div>\n</div>\n<p>A sample usage might be something like this:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">reader</span> <span class=\"o\">=</span> <span class=\"n\">TextReader</span><span class=\"p\">(</span><span class=\"s2\">&quot;hello.txt&quot;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">reader</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n<span class=\"go\">&#39;1: Hello world!&#39;</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">reader</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n<span class=\"go\">&#39;2: I am line number two.&#39;</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">new_reader</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">reader</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">new_reader</span><span class=\"o\">.</span><span class=\"n\">readline</span><span class=\"p\">()</span>\n<span class=\"go\">&#39;3: Goodbye!&#39;</span>\n</pre></div>\n</div>\n</section>\n</section>\n<section id=\"custom-reduction-for-types-functions-and-other-objects\">\n<span id=\"reducer-override\"></span><h2>Custom Reduction for Types, Functions, and Other Objects<a class=\"headerlink\" href=\"#custom-reduction-for-types-functions-and-other-objects\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n<p>Sometimes, <a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a> may not be flexible enough.\nIn particular we may want to customize pickling based on another criterion\nthan the object’s type, or we may want to customize the pickling of\nfunctions and classes.</p>\n<p>For those cases, it is possible to subclass from the <a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> class and\nimplement a <a class=\"reference internal\" href=\"#pickle.Pickler.reducer_override\" title=\"pickle.Pickler.reducer_override\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">reducer_override()</span></code></a> method. This method can return an\narbitrary reduction tuple (see <a class=\"reference internal\" href=\"#object.__reduce__\" title=\"object.__reduce__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce__()</span></code></a>). It can alternatively return\n<a class=\"reference internal\" href=\"constants.html#NotImplemented\" title=\"NotImplemented\"><code class=\"xref py py-data docutils literal notranslate\"><span class=\"pre\">NotImplemented</span></code></a> to fallback to the traditional behavior.</p>\n<p>If both the <a class=\"reference internal\" href=\"#pickle.Pickler.dispatch_table\" title=\"pickle.Pickler.dispatch_table\"><code class=\"xref py py-attr docutils literal notranslate\"><span class=\"pre\">dispatch_table</span></code></a> and\n<a class=\"reference internal\" href=\"#pickle.Pickler.reducer_override\" title=\"pickle.Pickler.reducer_override\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">reducer_override()</span></code></a> are defined, then\n<a class=\"reference internal\" href=\"#pickle.Pickler.reducer_override\" title=\"pickle.Pickler.reducer_override\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">reducer_override()</span></code></a> method takes priority.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>For performance reasons, <a class=\"reference internal\" href=\"#pickle.Pickler.reducer_override\" title=\"pickle.Pickler.reducer_override\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">reducer_override()</span></code></a> may not be\ncalled for the following objects: <code class=\"docutils literal notranslate\"><span class=\"pre\">None</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>, and\nexact instances of <a class=\"reference internal\" href=\"functions.html#int\" title=\"int\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">int</span></code></a>, <a class=\"reference internal\" href=\"functions.html#float\" title=\"float\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">float</span></code></a>, <a class=\"reference internal\" href=\"stdtypes.html#bytes\" title=\"bytes\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytes</span></code></a>,\n<a class=\"reference internal\" href=\"stdtypes.html#str\" title=\"str\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">str</span></code></a>, <a class=\"reference internal\" href=\"stdtypes.html#dict\" title=\"dict\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">dict</span></code></a>, <a class=\"reference internal\" href=\"stdtypes.html#set\" title=\"set\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">set</span></code></a>, <a class=\"reference internal\" href=\"stdtypes.html#frozenset\" title=\"frozenset\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">frozenset</span></code></a>, <a class=\"reference internal\" href=\"stdtypes.html#list\" title=\"list\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">list</span></code></a>\nand <a class=\"reference internal\" href=\"stdtypes.html#tuple\" title=\"tuple\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">tuple</span></code></a>.</p>\n</div>\n<p>Here is a simple example where we allow pickling and reconstructing\na given class:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">io</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">MyClass</span><span class=\"p\">:</span>\n    <span class=\"n\">my_attribute</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">MyPickler</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Pickler</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">reducer_override</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"p\">):</span>\n<span class=\"w\">        </span><span class=\"sd\">&quot;&quot;&quot;Custom reducer for MyClass.&quot;&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"s2\">&quot;__name__&quot;</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;MyClass&quot;</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"nb\">type</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"vm\">__bases__</span><span class=\"p\">,</span>\n                          <span class=\"p\">{</span><span class=\"s1\">&#39;my_attribute&#39;</span><span class=\"p\">:</span> <span class=\"n\">obj</span><span class=\"o\">.</span><span class=\"n\">my_attribute</span><span class=\"p\">})</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># For any other object, fallback to usual reduction</span>\n            <span class=\"k\">return</span> <span class=\"bp\">NotImplemented</span>\n\n<span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">()</span>\n<span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"n\">MyPickler</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n<span class=\"n\">p</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"p\">(</span><span class=\"n\">MyClass</span><span class=\"p\">)</span>\n\n<span class=\"k\">del</span> <span class=\"n\">MyClass</span>\n\n<span class=\"n\">unpickled_class</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">getvalue</span><span class=\"p\">())</span>\n\n<span class=\"k\">assert</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">unpickled_class</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"p\">)</span>\n<span class=\"k\">assert</span> <span class=\"n\">unpickled_class</span><span class=\"o\">.</span><span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;MyClass&quot;</span>\n<span class=\"k\">assert</span> <span class=\"n\">unpickled_class</span><span class=\"o\">.</span><span class=\"n\">my_attribute</span> <span class=\"o\">==</span> <span class=\"mi\">1</span>\n</pre></div>\n</div>\n</section>\n<section id=\"out-of-band-buffers\">\n<span id=\"pickle-oob\"></span><h2>Out-of-band Buffers<a class=\"headerlink\" href=\"#out-of-band-buffers\" title=\"Link to this heading\">¶</a></h2>\n<div class=\"versionadded\">\n<p><span class=\"versionmodified added\">Added in version 3.8.</span></p>\n</div>\n<p>In some contexts, the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module is used to transfer massive amounts\nof data.  Therefore, it can be important to minimize the number of memory\ncopies, to preserve performance and resource consumption.  However, normal\noperation of the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module, as it transforms a graph-like structure\nof objects into a sequential stream of bytes, intrinsically involves copying\ndata to and from the pickle stream.</p>\n<p>This constraint can be eschewed if both the <em>provider</em> (the implementation\nof the object types to be transferred) and the <em>consumer</em> (the implementation\nof the communications system) support the out-of-band transfer facilities\nprovided by pickle protocol 5 and higher.</p>\n<section id=\"provider-api\">\n<h3>Provider API<a class=\"headerlink\" href=\"#provider-api\" title=\"Link to this heading\">¶</a></h3>\n<p>The large data objects to be pickled must implement a <a class=\"reference internal\" href=\"#object.__reduce_ex__\" title=\"object.__reduce_ex__\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">__reduce_ex__()</span></code></a>\nmethod specialized for protocol 5 and higher, which returns a\n<a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> instance (instead of e.g. a <a class=\"reference internal\" href=\"stdtypes.html#bytes\" title=\"bytes\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytes</span></code></a> object)\nfor any large data.</p>\n<p>A <a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> object <em>signals</em> that the underlying buffer is\neligible for out-of-band data transfer.  Those objects remain compatible\nwith normal usage of the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module.  However, consumers can also\nopt-in to tell <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> that they will handle those buffers by\nthemselves.</p>\n</section>\n<section id=\"consumer-api\">\n<h3>Consumer API<a class=\"headerlink\" href=\"#consumer-api\" title=\"Link to this heading\">¶</a></h3>\n<p>A communications system can enable custom handling of the <a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a>\nobjects generated when serializing an object graph.</p>\n<p>On the sending side, it needs to pass a <em>buffer_callback</em> argument to\n<a class=\"reference internal\" href=\"#pickle.Pickler\" title=\"pickle.Pickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Pickler</span></code></a> (or to the <a class=\"reference internal\" href=\"#pickle.dump\" title=\"pickle.dump\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dump()</span></code></a> or <a class=\"reference internal\" href=\"#pickle.dumps\" title=\"pickle.dumps\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dumps()</span></code></a> function), which\nwill be called with each <a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> generated while pickling\nthe object graph.  Buffers accumulated by the <em>buffer_callback</em> will not\nsee their data copied into the pickle stream, only a cheap marker will be\ninserted.</p>\n<p>On the receiving side, it needs to pass a <em>buffers</em> argument to\n<a class=\"reference internal\" href=\"#pickle.Unpickler\" title=\"pickle.Unpickler\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">Unpickler</span></code></a> (or to the <a class=\"reference internal\" href=\"#pickle.load\" title=\"pickle.load\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">load()</span></code></a> or <a class=\"reference internal\" href=\"#pickle.loads\" title=\"pickle.loads\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">loads()</span></code></a> function),\nwhich is an iterable of the buffers which were passed to <em>buffer_callback</em>.\nThat iterable should produce buffers in the same order as they were passed\nto <em>buffer_callback</em>.  Those buffers will provide the data expected by the\nreconstructors of the objects whose pickling produced the original\n<a class=\"reference internal\" href=\"#pickle.PickleBuffer\" title=\"pickle.PickleBuffer\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">PickleBuffer</span></code></a> objects.</p>\n<p>Between the sending side and the receiving side, the communications system\nis free to implement its own transfer mechanism for out-of-band buffers.\nPotential optimizations include the use of shared memory or datatype-dependent\ncompression.</p>\n</section>\n<section id=\"example\">\n<h3>Example<a class=\"headerlink\" href=\"#example\" title=\"Link to this heading\">¶</a></h3>\n<p>Here is a trivial example where we implement a <a class=\"reference internal\" href=\"stdtypes.html#bytearray\" title=\"bytearray\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytearray</span></code></a> subclass\nable to participate in out-of-band buffer pickling:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">ZeroCopyByteArray</span><span class=\"p\">(</span><span class=\"nb\">bytearray</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">__reduce_ex__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">protocol</span> <span class=\"o\">&gt;=</span> <span class=\"mi\">5</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">_reconstruct</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">PickleBuffer</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">),),</span> <span class=\"kc\">None</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"c1\"># PickleBuffer is forbidden with pickle protocols &lt;= 4.</span>\n            <span class=\"k\">return</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">_reconstruct</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"nb\">bytearray</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">),)</span>\n\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">_reconstruct</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">obj</span><span class=\"p\">):</span>\n        <span class=\"k\">with</span> <span class=\"nb\">memoryview</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">m</span><span class=\"p\">:</span>\n            <span class=\"c1\"># Get a handle over the original buffer object</span>\n            <span class=\"n\">obj</span> <span class=\"o\">=</span> <span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">obj</span>\n            <span class=\"k\">if</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">)</span> <span class=\"ow\">is</span> <span class=\"bp\">cls</span><span class=\"p\">:</span>\n                <span class=\"c1\"># Original buffer object is a ZeroCopyByteArray, return it</span>\n                <span class=\"c1\"># as-is.</span>\n                <span class=\"k\">return</span> <span class=\"n\">obj</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"k\">return</span> <span class=\"bp\">cls</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The reconstructor (the <code class=\"docutils literal notranslate\"><span class=\"pre\">_reconstruct</span></code> class method) returns the buffer’s\nproviding object if it has the right type.  This is an easy way to simulate\nzero-copy behaviour on this toy example.</p>\n<p>On the consumer side, we can pickle those objects the usual way, which\nwhen unserialized will give us a copy of the original object:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"n\">ZeroCopyByteArray</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;abc&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n<span class=\"n\">new_b</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"o\">==</span> <span class=\"n\">new_b</span><span class=\"p\">)</span>  <span class=\"c1\"># True</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"ow\">is</span> <span class=\"n\">new_b</span><span class=\"p\">)</span>  <span class=\"c1\"># False: a copy was made</span>\n</pre></div>\n</div>\n<p>But if we pass a <em>buffer_callback</em> and then give back the accumulated\nbuffers when unserializing, we are able to get back the original object:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"n\">ZeroCopyByteArray</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;abc&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">buffers</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">protocol</span><span class=\"o\">=</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">buffer_callback</span><span class=\"o\">=</span><span class=\"n\">buffers</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">)</span>\n<span class=\"n\">new_b</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">buffers</span><span class=\"o\">=</span><span class=\"n\">buffers</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"o\">==</span> <span class=\"n\">new_b</span><span class=\"p\">)</span>  <span class=\"c1\"># True</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"ow\">is</span> <span class=\"n\">new_b</span><span class=\"p\">)</span>  <span class=\"c1\"># True: no copy was made</span>\n</pre></div>\n</div>\n<p>This example is limited by the fact that <a class=\"reference internal\" href=\"stdtypes.html#bytearray\" title=\"bytearray\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytearray</span></code></a> allocates its\nown memory: you cannot create a <a class=\"reference internal\" href=\"stdtypes.html#bytearray\" title=\"bytearray\"><code class=\"xref py py-class docutils literal notranslate\"><span class=\"pre\">bytearray</span></code></a> instance that is backed\nby another object’s memory.  However, third-party datatypes such as NumPy\narrays do not have this limitation, and allow use of zero-copy pickling\n(or making as few copies as possible) when transferring between distinct\nprocesses or systems.</p>\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<p><span class=\"target\" id=\"index-9\"></span><a class=\"pep reference external\" href=\"https://peps.python.org/pep-0574/\"><strong>PEP 574</strong></a> – Pickle protocol 5 with out-of-band data</p>\n</div>\n</section>\n</section>\n<section id=\"restricting-globals\">\n<span id=\"pickle-restrict\"></span><h2>Restricting Globals<a class=\"headerlink\" href=\"#restricting-globals\" title=\"Link to this heading\">¶</a></h2>\n<p id=\"index-10\">By default, unpickling will import any class or function that it finds in the\npickle data.  For many applications, this behaviour is unacceptable as it\npermits the unpickler to import and invoke arbitrary code.  Just consider what\nthis hand-crafted pickle data stream does when loaded:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;cos</span><span class=\"se\">\\n</span><span class=\"s2\">system</span><span class=\"se\">\\n</span><span class=\"s2\">(S&#39;echo hello world&#39;</span><span class=\"se\">\\n</span><span class=\"s2\">tR.&quot;</span><span class=\"p\">)</span>\n<span class=\"go\">hello world</span>\n<span class=\"go\">0</span>\n</pre></div>\n</div>\n<p>In this example, the unpickler imports the <a class=\"reference internal\" href=\"os.html#os.system\" title=\"os.system\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">os.system()</span></code></a> function and then\napply the string argument “echo hello world”.  Although this example is\ninoffensive, it is not difficult to imagine one that could damage your system.</p>\n<p>For this reason, you may want to control what gets unpickled by customizing\n<a class=\"reference internal\" href=\"#pickle.Unpickler.find_class\" title=\"pickle.Unpickler.find_class\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Unpickler.find_class()</span></code></a>.  Unlike its name suggests,\n<a class=\"reference internal\" href=\"#pickle.Unpickler.find_class\" title=\"pickle.Unpickler.find_class\"><code class=\"xref py py-meth docutils literal notranslate\"><span class=\"pre\">Unpickler.find_class()</span></code></a> is called whenever a global (i.e., a class or\na function) is requested.  Thus it is possible to either completely forbid\nglobals or restrict them to a safe subset.</p>\n<p>Here is an example of an unpickler allowing only few safe classes from the\n<a class=\"reference internal\" href=\"builtins.html#module-builtins\" title=\"builtins: The module that provides the built-in namespace.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">builtins</span></code></a> module to be loaded:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">builtins</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">io</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n\n<span class=\"n\">safe_builtins</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;range&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;complex&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;set&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;frozenset&#39;</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;slice&#39;</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">RestrictedUnpickler</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">Unpickler</span><span class=\"p\">):</span>\n\n    <span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">find_class</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">module</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Only allow safe classes from builtins.</span>\n        <span class=\"k\">if</span> <span class=\"n\">module</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;builtins&quot;</span> <span class=\"ow\">and</span> <span class=\"n\">name</span> <span class=\"ow\">in</span> <span class=\"n\">safe_builtins</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"n\">builtins</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Forbid everything else.</span>\n        <span class=\"k\">raise</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">UnpicklingError</span><span class=\"p\">(</span><span class=\"s2\">&quot;global &#39;</span><span class=\"si\">%s</span><span class=\"s2\">.</span><span class=\"si\">%s</span><span class=\"s2\">&#39; is forbidden&quot;</span> <span class=\"o\">%</span>\n                                     <span class=\"p\">(</span><span class=\"n\">module</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">))</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">restricted_loads</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"sd\">&quot;&quot;&quot;Helper function analogous to pickle.loads().&quot;&quot;&quot;</span>\n    <span class=\"k\">return</span> <span class=\"n\">RestrictedUnpickler</span><span class=\"p\">(</span><span class=\"n\">io</span><span class=\"o\">.</span><span class=\"n\">BytesIO</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>A sample usage of our unpickler working as intended:</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">restricted_loads</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">)]))</span>\n<span class=\"go\">[1, 2, range(0, 15)]</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">restricted_loads</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s2\">&quot;cos</span><span class=\"se\">\\n</span><span class=\"s2\">system</span><span class=\"se\">\\n</span><span class=\"s2\">(S&#39;echo hello world&#39;</span><span class=\"se\">\\n</span><span class=\"s2\">tR.&quot;</span><span class=\"p\">)</span>\n<span class=\"gt\">Traceback (most recent call last):</span>\n<span class=\"w\">  </span><span class=\"c\">...</span>\n<span class=\"gr\">pickle.UnpicklingError</span>: <span class=\"n\">global &#39;os.system&#39; is forbidden</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">restricted_loads</span><span class=\"p\">(</span><span class=\"sa\">b</span><span class=\"s1\">&#39;cbuiltins</span><span class=\"se\">\\n</span><span class=\"s1\">eval</span><span class=\"se\">\\n</span><span class=\"s1\">&#39;</span>\n<span class=\"gp\">... </span>                 <span class=\"sa\">b</span><span class=\"s1\">&#39;(S</span><span class=\"se\">\\&#39;</span><span class=\"s1\">getattr(__import__(&quot;os&quot;), &quot;system&quot;)&#39;</span>\n<span class=\"gp\">... </span>                 <span class=\"sa\">b</span><span class=\"s1\">&#39;(&quot;echo hello world&quot;)</span><span class=\"se\">\\&#39;\\n</span><span class=\"s1\">tR.&#39;</span><span class=\"p\">)</span>\n<span class=\"gt\">Traceback (most recent call last):</span>\n<span class=\"w\">  </span><span class=\"c\">...</span>\n<span class=\"gr\">pickle.UnpicklingError</span>: <span class=\"n\">global &#39;builtins.eval&#39; is forbidden</span>\n</pre></div>\n</div>\n<p>As our examples shows, you have to be careful with what you allow to be\nunpickled.  Therefore if security is a concern, you may want to consider\nalternatives such as the marshalling API in <a class=\"reference internal\" href=\"xmlrpc.client.html#module-xmlrpc.client\" title=\"xmlrpc.client: XML-RPC client access.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">xmlrpc.client</span></code></a> or\nthird-party solutions.</p>\n</section>\n<section id=\"performance\">\n<h2>Performance<a class=\"headerlink\" href=\"#performance\" title=\"Link to this heading\">¶</a></h2>\n<p>Recent versions of the pickle protocol (from protocol 2 and upwards) feature\nefficient binary encodings for several common features and built-in types.\nAlso, the <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module has a transparent optimizer written in C.</p>\n</section>\n<section id=\"examples\">\n<span id=\"pickle-example\"></span><h2>Examples<a class=\"headerlink\" href=\"#examples\" title=\"Link to this heading\">¶</a></h2>\n<p>For the simplest code, use the <a class=\"reference internal\" href=\"#pickle.dump\" title=\"pickle.dump\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">dump()</span></code></a> and <a class=\"reference internal\" href=\"#pickle.load\" title=\"pickle.load\"><code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">load()</span></code></a> functions.</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n\n<span class=\"c1\"># An arbitrary collection of objects supported by pickle.</span>\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;a&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mf\">2.0</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"o\">+</span><span class=\"mi\">4</span><span class=\"n\">j</span><span class=\"p\">],</span>\n    <span class=\"s1\">&#39;b&#39;</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"s2\">&quot;character string&quot;</span><span class=\"p\">,</span> <span class=\"sa\">b</span><span class=\"s2\">&quot;byte string&quot;</span><span class=\"p\">),</span>\n    <span class=\"s1\">&#39;c&#39;</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">&#39;data.pickle&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;wb&#39;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"c1\"># Pickle the &#39;data&#39; dictionary using the highest protocol available.</span>\n    <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">HIGHEST_PROTOCOL</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The following example reads the resulting pickled data.</p>\n<div class=\"highlight-python3 notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">&#39;data.pickle&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;rb&#39;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"c1\"># The protocol version used is detected automatically, so we do not</span>\n    <span class=\"c1\"># have to specify it.</span>\n    <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"command-line-interface\">\n<span id=\"pickle-cli\"></span><h2>Command-line interface<a class=\"headerlink\" href=\"#command-line-interface\" title=\"Link to this heading\">¶</a></h2>\n<p>The <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a> module can be invoked as a script from the command line,\nit will display contents of the pickle files. However, when the pickle file\nthat you want to examine comes from an untrusted source, <code class=\"docutils literal notranslate\"><span class=\"pre\">-m</span> <span class=\"pre\">pickletools</span></code>\nis a safer option because it does not execute pickle bytecode, see\n<a class=\"reference internal\" href=\"pickletools.html#pickletools-cli\"><span class=\"std std-ref\">pickletools CLI usage</span></a>.</p>\n<div class=\"highlight-bash notranslate\"><div class=\"highlight\"><pre><span></span>python<span class=\"w\"> </span>-m<span class=\"w\"> </span>pickle<span class=\"w\"> </span>pickle_file<span class=\"w\"> </span><span class=\"o\">[</span>pickle_file<span class=\"w\"> </span>...<span class=\"o\">]</span>\n</pre></div>\n</div>\n<p>The following option is accepted:</p>\n<dl class=\"std option\">\n<dt class=\"sig sig-object std\" id=\"cmdoption-pickle-arg-pickle_file\">\n<span class=\"sig-name descname\"><span class=\"pre\">pickle_file</span></span><span class=\"sig-prename descclassname\"></span><a class=\"headerlink\" href=\"#cmdoption-pickle-arg-pickle_file\" title=\"Link to this definition\">¶</a></dt>\n<dd><p>A pickle file to read, or <code class=\"docutils literal notranslate\"><span class=\"pre\">-</span></code> to indicate reading from standard input.</p>\n</dd></dl>\n\n<div class=\"admonition seealso\">\n<p class=\"admonition-title\">See also</p>\n<dl class=\"simple\">\n<dt>Module <a class=\"reference internal\" href=\"copyreg.html#module-copyreg\" title=\"copyreg: Register pickle support functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code></a></dt><dd><p>Pickle interface constructor registration for extension types.</p>\n</dd>\n<dt>Module <a class=\"reference internal\" href=\"pickletools.html#module-pickletools\" title=\"pickletools: Contains extensive comments about the pickle protocols and pickle-machine opcodes, as well as some useful functions.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickletools</span></code></a></dt><dd><p>Tools for working with and analyzing pickled data.</p>\n</dd>\n<dt>Module <a class=\"reference internal\" href=\"shelve.html#module-shelve\" title=\"shelve: Python object persistence.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">shelve</span></code></a></dt><dd><p>Indexed databases of objects; uses <a class=\"reference internal\" href=\"#module-pickle\" title=\"pickle: Convert Python objects to streams of bytes and back.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code></a>.</p>\n</dd>\n<dt>Module <a class=\"reference internal\" href=\"copy.html#module-copy\" title=\"copy: Shallow and deep copy operations.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copy</span></code></a></dt><dd><p>Shallow and deep object copying.</p>\n</dd>\n<dt>Module <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a></dt><dd><p>High-performance serialization of built-in types.</p>\n</dd>\n</dl>\n</div>\n<p class=\"rubric\">Footnotes</p>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id7\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id1\">1</a><span class=\"fn-bracket\">]</span></span>\n<p>Don’t confuse this with the <a class=\"reference internal\" href=\"marshal.html#module-marshal\" title=\"marshal: Convert Python objects to streams of bytes and back (with different constraints).\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a> module</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id8\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id3\">2</a><span class=\"fn-bracket\">]</span></span>\n<p>This is why <a class=\"reference internal\" href=\"../reference/expressions.html#lambda\"><code class=\"xref std std-keyword docutils literal notranslate\"><span class=\"pre\">lambda</span></code></a> functions cannot be pickled:  all\n<code class=\"xref std std-keyword docutils literal notranslate\"><span class=\"pre\">lambda</span></code> functions share the same name:  <code class=\"docutils literal notranslate\"><span class=\"pre\">&lt;lambda&gt;</span></code>.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id9\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id4\">3</a><span class=\"fn-bracket\">]</span></span>\n<p>The exception raised will likely be an <a class=\"reference internal\" href=\"exceptions.html#ImportError\" title=\"ImportError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">ImportError</span></code></a> or an\n<a class=\"reference internal\" href=\"exceptions.html#AttributeError\" title=\"AttributeError\"><code class=\"xref py py-exc docutils literal notranslate\"><span class=\"pre\">AttributeError</span></code></a> but it could be something else.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id10\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id5\">4</a><span class=\"fn-bracket\">]</span></span>\n<p>The <a class=\"reference internal\" href=\"copy.html#module-copy\" title=\"copy: Shallow and deep copy operations.\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copy</span></code></a> module uses this protocol for shallow and deep copying\noperations.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id11\" role=\"doc-footnote\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id6\">5</a><span class=\"fn-bracket\">]</span></span>\n<p>The limitation on alphanumeric characters is due to the fact\nthat persistent IDs in protocol 0 are delimited by the newline\ncharacter.  Therefore if any kind of newline characters occurs in\npersistent IDs, the resulting pickled data will become unreadable.</p>\n</aside>\n</aside>\n</section>\n</section>\n\n\n            <div class=\"clearer\"></div>\n          </div>\n        </div>\n      </div>\n      <div class=\"sphinxsidebar\" role=\"navigation\" aria-label=\"Main\">\n        <div class=\"sphinxsidebarwrapper\">\n  <div>\n    <h3><a href=\"../contents.html\">Table of Contents</a></h3>\n    <ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> — Python object serialization</a><ul>\n<li><a class=\"reference internal\" href=\"#relationship-to-other-python-modules\">Relationship to other Python modules</a><ul>\n<li><a class=\"reference internal\" href=\"#comparison-with-marshal\">Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">marshal</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#comparison-with-json\">Comparison with <code class=\"docutils literal notranslate\"><span class=\"pre\">json</span></code></a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#data-stream-format\">Data stream format</a></li>\n<li><a class=\"reference internal\" href=\"#module-interface\">Module Interface</a></li>\n<li><a class=\"reference internal\" href=\"#what-can-be-pickled-and-unpickled\">What can be pickled and unpickled?</a></li>\n<li><a class=\"reference internal\" href=\"#pickling-class-instances\">Pickling Class Instances</a><ul>\n<li><a class=\"reference internal\" href=\"#persistence-of-external-objects\">Persistence of External Objects</a></li>\n<li><a class=\"reference internal\" href=\"#dispatch-tables\">Dispatch Tables</a></li>\n<li><a class=\"reference internal\" href=\"#handling-stateful-objects\">Handling Stateful Objects</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#custom-reduction-for-types-functions-and-other-objects\">Custom Reduction for Types, Functions, and Other Objects</a></li>\n<li><a class=\"reference internal\" href=\"#out-of-band-buffers\">Out-of-band Buffers</a><ul>\n<li><a class=\"reference internal\" href=\"#provider-api\">Provider API</a></li>\n<li><a class=\"reference internal\" href=\"#consumer-api\">Consumer API</a></li>\n<li><a class=\"reference internal\" href=\"#example\">Example</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#restricting-globals\">Restricting Globals</a></li>\n<li><a class=\"reference internal\" href=\"#performance\">Performance</a></li>\n<li><a class=\"reference internal\" href=\"#examples\">Examples</a></li>\n<li><a class=\"reference internal\" href=\"#command-line-interface\">Command-line interface</a></li>\n</ul>\n</li>\n</ul>\n\n  </div>\n  <div>\n    <h4>Previous topic</h4>\n    <p class=\"topless\"><a href=\"persistence.html\"\n                          title=\"previous chapter\">Data Persistence</a></p>\n  </div>\n  <div>\n    <h4>Next topic</h4>\n    <p class=\"topless\"><a href=\"copyreg.html\"\n                          title=\"next chapter\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">copyreg</span></code> — Register <code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> support functions</a></p>\n  </div>\n  <div role=\"note\" aria-label=\"source link\">\n    <h3>This page</h3>\n    <ul class=\"this-page-menu\">\n      <li><a href=\"../bugs.html\">Report a bug</a></li>\n      <li>\n        <a href=\"https://github.com/python/cpython/blob/main/Doc/library/pickle.rst?plain=1\"\n            rel=\"nofollow\">Show source\n        </a>\n      </li>\n    </ul>\n  </div>\n        </div>\n<div id=\"sidebarbutton\" title=\"Collapse sidebar\">\n<span>«</span>\n</div>\n\n      </div>\n      <div class=\"clearer\"></div>\n    </div>  \n    <div class=\"related\" role=\"navigation\" aria-label=\"Related\">\n      <h3>Navigation</h3>\n      <ul>\n        <li class=\"right\" style=\"margin-right: 10px\">\n          <a href=\"../genindex.html\" title=\"General Index\"\n             >index</a></li>\n        <li class=\"right\" >\n          <a href=\"../py-modindex.html\" title=\"Python Module Index\"\n             >modules</a> |</li>\n        <li class=\"right\" >\n          <a href=\"copyreg.html\" title=\"copyreg — Register pickle support functions\"\n             >next</a> |</li>\n        <li class=\"right\" >\n          <a href=\"persistence.html\" title=\"Data Persistence\"\n             >previous</a> |</li>\n\n          <li><img src=\"../_static/py.svg\" alt=\"Python logo\" style=\"vertical-align: middle; margin-top: -1px\"></li>\n          <li><a href=\"https://www.python.org/\">Python</a> &#187;</li>\n          <li class=\"switchers\">\n            <div class=\"language_switcher_placeholder\"></div>\n            <div class=\"version_switcher_placeholder\"></div>\n          </li>\n          <li>\n              \n          </li>\n    <li id=\"cpython-language-and-version\">\n      <a href=\"../index.html\">3.14.0 Documentation</a> &#187;\n    </li>\n\n          <li class=\"nav-item nav-item-1\"><a href=\"index.html\" >The Python Standard Library</a> &#187;</li>\n          <li class=\"nav-item nav-item-2\"><a href=\"persistence.html\" >Data Persistence</a> &#187;</li>\n        <li class=\"nav-item nav-item-this\"><a href=\"\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pickle</span></code> — Python object serialization</a></li>\n                <li class=\"right\">\n                    \n\n    <div class=\"inline-search\" role=\"search\">\n        <form class=\"inline-search\" action=\"../search.html\" method=\"get\">\n          <input placeholder=\"Quick search\" aria-label=\"Quick search\" type=\"search\" name=\"q\" id=\"search-box\">\n          <input type=\"submit\" value=\"Go\">\n        </form>\n    </div>\n                     |\n                </li>\n            <li class=\"right\">\n<label class=\"theme-selector-label\">\n    Theme\n    <select class=\"theme-selector\" oninput=\"activateTheme(this.value)\">\n        <option value=\"auto\" selected>Auto</option>\n        <option value=\"light\">Light</option>\n        <option value=\"dark\">Dark</option>\n    </select>\n</label> |</li>\n            \n      </ul>\n    </div>  \n    <div class=\"footer\">\n    &copy; <a href=\"../copyright.html\">Copyright</a> 2001 Python Software Foundation.\n    <br>\n    This page is licensed under the Python Software Foundation License Version 2.\n    <br>\n    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.\n    <br>\n    \n      See <a href=\"/license.html\">History and License</a> for more information.<br>\n    \n    \n    <br>\n\n    The Python Software Foundation is a non-profit corporation.\n<a href=\"https://www.python.org/psf/donations/\">Please donate.</a>\n<br>\n    <br>\n      Last updated on Nov 25, 2025 (18:01 UTC).\n    \n      <a href=\"/bugs.html\">Found a bug</a>?\n    \n    <br>\n\n    Created using <a href=\"https://www.sphinx-doc.org/\">Sphinx</a> 8.2.3.\n    </div>\n\n    <script type=\"text/javascript\" src=\"../_static/switchers.js\"></script>\n  </body>\n</html>",
  "metadata": {
    "title": "pickle — Python object serialization — Python 3.14.0 documentation",
    "meta_description": "Source code: Lib/pickle.py The pickle module implements binary protocols for serializing and de-serializing a Python object structure. “Pickling” is the process whereby a Python object hierarchy is...",
    "h1": "— Python object serialization"
  },
  "request_headers": {
    "Referer": "https://docs.python.org/3/library/",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en",
    "User-Agent": "DumbCrawler/1.0",
    "Accept-Encoding": "gzip, deflate"
  },
  "response_headers": {
    "Content-Length": "27593",
    "Server": "nginx",
    "Content-Type": "text/html",
    "Last-Modified": "Tue, 25 Nov 2025 18:03:26 GMT",
    "Etag": "\"6925ef6e-2a3ee\"",
    "X-Clacks-Overhead": "GNU Terry Pratchett",
    "Strict-Transport-Security": "max-age=315360000; includeSubDomains; preload",
    "Via": "1.1 varnish, 1.1 varnish",
    "Accept-Ranges": "bytes",
    "Age": "4635",
    "Date": "Wed, 26 Nov 2025 05:32:26 GMT",
    "X-Served-By": "cache-lga21934-LGA, cache-yul1970070-YUL",
    "X-Cache": "HIT, HIT",
    "X-Cache-Hits": "228, 0",
    "X-Timer": "S1764135146.010359,VS0,VE1",
    "Vary": "Accept-Encoding"
  },
  "crawled_at": "2025-11-26T05:32:26.814567+00:00",
  "crawler": {
    "name": "DumbCrawler",
    "version": "1.0",
    "mode": "crawl",
    "js_mode": "off",
    "scope": "subfolder"
  }
}